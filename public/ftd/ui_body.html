<header>
  <h1>FTD - Functional Tool Designer</h1>
  <div id="status" class="status-idle">Status: Idle</div>
</header>
<main id="main">
  <section class="controls-section">
    <fieldset>
      <legend>Settings &amp; Storage</legend>
      <div class="grid-controls">
        <div class="input-group api-key-group">
          <label for="api_key">Gemini API Key:</label>
          <input type="password" id="api_key" placeholder="Enter key..." />
          <button id="save_key_btn" title="Save key for this session">Save</button>
          <span id="key_saved_indicator" class="key-saved-indicator hidden" aria-live="polite">âœ“ Saved</span>
        </div>
        <div class="input-group model-group">
          <label for="model_select">Model Alias:</label>
          <select id="model_select">
            <option value="gemini-2.5-flash">gemini-2.5-flash (stable)</option>
            <option value="gemini-2.5-flash-preview-09-2025">gemini-2.5-flash-preview-09-2025</option>
            <option value="gemini-flash-latest">gemini-flash-latest (rolling)</option>
            <option value="gemini-2.5-pro-exp-03-25">gemini-2.5-pro-exp-03-25 (legacy)</option>
          </select>
        </div>
        <button id="export_btn">Export State</button>
        <button id="import_btn">Import State</button>
        <input type="file" id="import_file" accept=".json" class="hidden" />
        <button id="log_btn">DL Logs</button>
        <button id="clear_btn" class="danger-btn">Clear All</button>
      </div>
      <div class="storage-info">Storage: <span id="storage">?KB (?%)</span></div>
    </fieldset>
  </section>

  <section class="generation-section">
    <fieldset>
      <legend>Generation Control</legend>
      <div class="input-group">
         <label for="tool_req">Describe the Design Tool & Web Component:</label>
         <textarea id="tool_req" rows="3" placeholder="e.g., 'Create a hex color input component that shows a color preview square'"></textarea>
      </div>
      <div class="generation-modes">
         <div class="mode-select">
         <label><input type="radio" name="gen_mode" value="manual" checked> Manual Approval (<span id="manual_versions_count">?</span> Versions)</label>
         <label><input type="radio" name="gen_mode" value="continuous"> Continuous</label>
       </div>
       <div class="continuous-opts hidden">
          <label for="cont_limit">Iterations:</label>
          <input type="number" id="cont_limit" value="5" min="1" max="50">
       </div>
       <button id="generate_btn">Generate</button>
       <button id="abort_btn" class="hidden danger-btn">Abort</button>
     </div>
      <div id="progress_info" class="progress-info stat-grid hidden">
        <div class="stat-mini">
          <div class="stat-mini-label">Iteration</div>
          <div class="stat-mini-value" id="progress_iteration">0 / 0</div>
        </div>
        <div class="stat-mini">
          <div class="stat-mini-label">Version</div>
          <div class="stat-mini-value" id="progress_version">0 / 0</div>
        </div>
        <div class="stat-mini">
          <div class="stat-mini-label">Generated</div>
          <div class="stat-mini-value" id="progress_total">0</div>
        </div>
      </div>
    </fieldset>
  </section>

  <section id="pending_section" class="hidden">
     <h2>Pending Review</h2>
     <div id="pending_list" class="tool-list"></div>
     <div id="pending_actions" class="hidden">
        <button id="approve_btn" class="success-btn" disabled>Approve Selected</button>
        <button id="version_btn" disabled>Generate New Version</button>
        <button id="reject_btn" class="danger-btn">Reject All</button>
     </div>
  </section>

  <section id="preview_section" class="hidden">
     <h2>Web Component Preview</h2>
     <div id="preview_area"></div>
     <button id="close_preview_btn">Close Preview</button>
  </section>

  <section class="library-section">
    <h2>Tool Library</h2>
    <div class="library-controls">
      <input type="search" id="search_box" placeholder="Filter tools..." />
      <select id="sort_box">
        <option value="name">Sort: Name</option>
        <option value="date">Sort: Date</option>
      </select>
    </div>
    <div id="library" class="tool-list">
      <p>No tools generated yet.</p>
    </div>
  </section>
</main>
<footer>
  <p>DTF v<span id="version"></span></p>
</footer>
