
--- CATS_START_FILE: boot.js ---
aW1wb3J0IFV0aWxzIGZyb20gIi4vdXRpbHMuanMiOwppbXBvcnQgU3RvcmFnZU1vZHVsZSBmcm9tICIuL3N0b3JhZ2UuanMiOwoKY29uc3QgYm9vdHN0cmFwID0gYXN5bmMgKCkgPT4gewogIGNvbnN0IGxvYWRpbmdDb250YWluZXIgPSBVdGlscy4kaWQoImxvYWRpbmctY29udGFpbmVyIik7CiAgY29uc3QgYm9vdExvZyA9IFV0aWxzLiRpZCgiYm9vdC1sb2ciKTsKICBjb25zdCBhcHBSb290ID0gVXRpbHMuJGlkKCJhcHAtcm9vdCIpOwoKICBjb25zdCBsb2dUb0Jvb3RTY3JlZW4gPSAobGV2ZWwsIG1lc3NhZ2UsIC4uLmRldGFpbHMpID0+IHsKICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTsKICAgIGNvbnN0IGxpbmUgPSBgWyR7dGltZXN0YW1wfV0gWyR7bGV2ZWwudG9VcHBlckNhc2UoKX1dICR7bWVzc2FnZX0gJHtkZXRhaWxzCiAgICAgIC5tYXAoKGQpID0+IEpTT04uc3RyaW5naWZ5KGQpKQogICAgICAuam9pbigiICIpfVxuYDsKICAgIGlmIChib290TG9nKSB7CiAgICAgIGJvb3RMb2cudGV4dENvbnRlbnQgKz0gbGluZTsKICAgICAgYm9vdExvZy5zY3JvbGxUb3AgPSBib290TG9nLnNjcm9sbEhlaWdodDsKICAgIH0KCiAgICBjb25zdCBjb25zb2xlTWV0aG9kID0KICAgICAgbGV2ZWwgPT09ICJlcnJvciIKICAgICAgICA/IGNvbnNvbGUuZXJyb3IKICAgICAgICA6IGxldmVsID09PSAid2FybiIKICAgICAgICA/IGNvbnNvbGUud2FybgogICAgICAgIDogY29uc29sZS5sb2c7CiAgICBjb25zb2xlTWV0aG9kKGxpbmUudHJpbSgpKTsKICB9OwoKICBsZXQgY29uZmlnID0gbnVsbDsKICBsZXQgc3RvcmFnZSA9IG51bGw7CiAgbGV0IGxvZ2dlciA9IG51bGw7CgogIHRyeSB7CiAgICBsb2dUb0Jvb3RTY3JlZW4oImluZm8iLCAiQm9vdCBzZXF1ZW5jZSBzdGFydGVkLi4uIik7CgogICAgbG9nVG9Cb290U2NyZWVuKCJpbmZvIiwgIkZldGNoaW5nIGNvbmZpZ3VyYXRpb24uLi4iKTsKICAgIGNvbnN0IGNvbmZpZ1Jlc3BvbnNlID0gYXdhaXQgZmV0Y2goImNvbmZpZy5qc29uIik7CiAgICBpZiAoIWNvbmZpZ1Jlc3BvbnNlLm9rKQogICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBmZXRjaCBjb25maWcuanNvbjogJHtjb25maWdSZXNwb25zZS5zdGF0dXN9YCk7CiAgICBjb25maWcgPSBhd2FpdCBjb25maWdSZXNwb25zZS5qc29uKCk7CiAgICBsb2dUb0Jvb3RTY3JlZW4oImluZm8iLCBgQ29uZmlndXJhdGlvbiBsb2FkZWQgKHYke2NvbmZpZy52ZXJzaW9ufSlgKTsKCiAgICBVdGlscy5sb2dnZXIuaW5pdChjb25maWcpOwogICAgbG9nZ2VyID0gVXRpbHMubG9nZ2VyOwogICAgbG9nZ2VyLmxvZ0V2ZW50KCJpbmZvIiwgIlV0aWxpdGllcyBhbmQgTG9nZ2VyIGluaXRpYWxpemVkLiIpOwoKICAgIHN0b3JhZ2UgPSBTdG9yYWdlTW9kdWxlKGNvbmZpZywgbG9nZ2VyKTsKICAgIGlmICghc3RvcmFnZSkgdGhyb3cgbmV3IEVycm9yKCJTdG9yYWdlIG1vZHVsZSBpbml0aWFsaXphdGlvbiBmYWlsZWQuIik7CiAgICBsb2dnZXIubG9nRXZlbnQoImluZm8iLCAiU3RvcmFnZSBtb2R1bGUgaW5pdGlhbGl6ZWQuIik7CiAgICBjb25zdCB1c2FnZSA9IHN0b3JhZ2UuZ2V0U3RvcmFnZVVzYWdlKCk7CiAgICBsb2dnZXIubG9nRXZlbnQoCiAgICAgICJpbmZvIiwKICAgICAgYEluaXRpYWwgc3RvcmFnZSB1c2FnZTogJHsodXNhZ2UudXNlZCAvIDEwMjQpLnRvRml4ZWQoCiAgICAgICAgMQogICAgICApfUtCICgke3VzYWdlLnBlcmNlbnQudG9GaXhlZCgxKX0lKWAKICAgICk7CgogICAgbGV0IHN0YXRlID0gc3RvcmFnZS5nZXRTdGF0ZSgpOwogICAgaWYgKHN0YXRlKSB7CiAgICAgIGlmIChzdGF0ZS52ZXJzaW9uICE9PSBjb25maWcudmVyc2lvbikgewogICAgICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgICAgICJ3YXJuIiwKICAgICAgICAgIGBTdGF0ZSB2ZXJzaW9uIG1pc21hdGNoIChTdGF0ZTogJHtzdGF0ZS52ZXJzaW9ufSwgQ29uZmlnOiAke2NvbmZpZy52ZXJzaW9ufSkuIFJlLWluaXRpYWxpemluZyBzdGF0ZS5gCiAgICAgICAgKTsKICAgICAgICBzdGF0ZSA9IG51bGw7CiAgICAgICAgc3RvcmFnZS5yZW1vdmVTdGF0ZSgpOwogICAgICB9IGVsc2UgewogICAgICAgIGxvZ2dlci5sb2dFdmVudCgiaW5mbyIsIGBFeGlzdGluZyBzdGF0ZSBmb3VuZCAodiR7c3RhdGUudmVyc2lvbn0pLmApOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBsb2dnZXIubG9nRXZlbnQoCiAgICAgICAgImluZm8iLAogICAgICAgICJObyBleGlzdGluZyBzdGF0ZSBmb3VuZC4gSW5pdGlhbGl6aW5nIG5ldyBzdGF0ZS4iCiAgICAgICk7CiAgICB9CgogICAgbG9nZ2VyLmxvZ0V2ZW50KCJpbmZvIiwgIkxvYWRpbmcgY29yZSBhcHBsaWNhdGlvbiBtb2R1bGVzLi4uIik7CgogICAgY29uc3QgU3RhdGVNYW5hZ2VyID0gKGF3YWl0IGltcG9ydCgiLi9zdGF0ZS1tYW5hZ2VyLmpzIikpLmRlZmF1bHQoCiAgICAgIGNvbmZpZywKICAgICAgbG9nZ2VyLAogICAgICBzdG9yYWdlCiAgICApOwogICAgY29uc3QgQXBpQ2xpZW50ID0gKGF3YWl0IGltcG9ydCgiLi9hcGktY2xpZW50LmpzIikpLmRlZmF1bHQoY29uZmlnLCBsb2dnZXIpOwogICAgY29uc3QgTUNQQ29udmVydGVyID0gKGF3YWl0IGltcG9ydCgiLi9tY3AtY29udmVydGVyLmpzIikpLmRlZmF1bHQoCiAgICAgIGNvbmZpZywKICAgICAgbG9nZ2VyCiAgICApOwoKICAgIGNvbnN0IFRvb2xSdW5uZXIgPSAoYXdhaXQgaW1wb3J0KCIuL3Rvb2wtcnVubmVyLmpzIikpLmRlZmF1bHQoCiAgICAgIGNvbmZpZywKICAgICAgbG9nZ2VyCiAgICApOwogICAgY29uc3QgQ3ljbGVMb2dpYyA9IChhd2FpdCBpbXBvcnQoIi4vY3ljbGUtbG9naWMuanMiKSkuZGVmYXVsdCgKICAgICAgY29uZmlnLAogICAgICBsb2dnZXIsCiAgICAgIFV0aWxzLAogICAgICBzdG9yYWdlLAogICAgICBTdGF0ZU1hbmFnZXIsCiAgICAgIEFwaUNsaWVudCwKICAgICAgTUNQQ29udmVydGVyLAogICAgICBUb29sUnVubmVyCiAgICApOwogICAgY29uc3QgVUlNYW5hZ2VyID0gKGF3YWl0IGltcG9ydCgiLi91aS1tYW5hZ2VyLmpzIikpLmRlZmF1bHQoCiAgICAgIGNvbmZpZywKICAgICAgbG9nZ2VyLAogICAgICBVdGlscywKICAgICAgc3RvcmFnZSwKICAgICAgU3RhdGVNYW5hZ2VyLAogICAgICBDeWNsZUxvZ2ljCiAgICApOwoKICAgIGxvZ2dlci5sb2dFdmVudCgiaW5mbyIsICJDb3JlIG1vZHVsZXMgbG9hZGVkLiIpOwoKICAgIFN0YXRlTWFuYWdlci5pbml0KHN0YXRlKTsKICAgIGxvZ2dlci5sb2dFdmVudCgiaW5mbyIsICJTdGF0ZU1hbmFnZXIgaW5pdGlhbGl6ZWQuIik7CgogICAgQ3ljbGVMb2dpYy5pbml0KCk7CiAgICBsb2dnZXIubG9nRXZlbnQoImluZm8iLCAiQ3ljbGVMb2dpYyBpbml0aWFsaXplZC4iKTsKCiAgICBhd2FpdCBVSU1hbmFnZXIuaW5pdCgpOwogICAgbG9nZ2VyLmxvZ0V2ZW50KCJpbmZvIiwgIlVJTWFuYWdlciBpbml0aWFsaXplZC4iKTsKCiAgICBsb2dnZXIubG9nRXZlbnQoImluZm8iLCAiQm9vdHN0cmFwIGNvbXBsZXRlLiBMYXVuY2hpbmcgYXBwbGljYXRpb24uIik7CiAgICBpZiAobG9hZGluZ0NvbnRhaW5lcikgbG9hZGluZ0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCJoaWRkZW4iKTsKICAgIGlmIChhcHBSb290KSBhcHBSb290LmNsYXNzTGlzdC5yZW1vdmUoImhpZGRlbiIpOwogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICBjb25zdCBlcnJvck1zZyA9IGBGQVRBTCBCT09UU1RSQVAgRVJST1I6ICR7ZXJyb3IubWVzc2FnZX1gOwogICAgbG9nVG9Cb290U2NyZWVuKCJlcnJvciIsIGVycm9yTXNnLCBlcnJvci5zdGFjayk7CgogICAgaWYgKGJvb3RMb2cpIHsKICAgICAgYm9vdExvZy5zdHlsZS5jb2xvciA9ICJ2YXIoLS1lcnJvci1jb2xvcikiOwogICAgICBib290TG9nLnN0eWxlLmJvcmRlckNvbG9yID0gInZhcigtLWVycm9yLWNvbG9yKSI7CiAgICB9CiAgICBpZiAoYXBwUm9vdCkgYXBwUm9vdC5jbGFzc0xpc3QuYWRkKCJoaWRkZW4iKTsKCiAgICBpZiAoIWJvb3RMb2cgJiYgbG9hZGluZ0NvbnRhaW5lcikgewogICAgICBsb2FkaW5nQ29udGFpbmVyLmlubmVySFRNTCA9IGA8aDEgc3R5bGU9ImNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7Ij5Jbml0aWFsaXphdGlvbiBGYWlsZWQ8L2gxPjxwcmUgc3R5bGU9ImNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7IHRleHQtYWxpZ246IGxlZnQ7IHdoaXRlLXNwYWNlOiBwcmUtd3JhcDsiPiR7ZXJyb3JNc2d9XG4kewogICAgICAgIGVycm9yLnN0YWNrIHx8ICIiCiAgICAgIH08L3ByZT5gOwogICAgfQogIH0KfTsKCmJvb3RzdHJhcCgpOwo=
--- CATS_END_FILE ---

--- CATS_START_FILE: index.html ---
PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KICA8aGVhZD4KICAgIDxtZXRhIGNoYXJzZXQ9IlVURi04IiAvPgogICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiIC8+CiAgICA8dGl0bGU+RHJlYW1lciAoVG9vbCBGYWN0b3J5KTwvdGl0bGU+CiAgICA8bGluawogICAgICByZWw9Imljb24iCiAgICAgIGhyZWY9ImRhdGE6aW1hZ2Uvc3ZnK3htbCwlM0NzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2aWV3Qm94PScwIDAgMTAwIDEwMCclM0UlM0NyZWN0IHdpZHRoPScxMDAnIGhlaWdodD0nMTAwJyByeD0nMTUnIGZpbGw9JyUyM2NjYycvJTNFJTNDcGF0aCBkPSdNMzAgNzAgTDUwIDMwIEw3MCA3MCBaJyBmaWxsPSclMjMzMzMnLyUzRSUzQ3BhdGggZD0nTTQwIDYwIEw2MCA2MCBMNTAgNDUgWicgZmlsbD0nJTIzZmZmJy8lM0UlM0Mvc3ZnJTNFIgogICAgLz4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0idWktc3R5bGUuY3NzIiAvPgogIDwvaGVhZD4KICA8Ym9keT4KICAgIDxkaXYgaWQ9ImxvYWRpbmctY29udGFpbmVyIj4KICAgICAgPGgxPkxvYWRpbmcgRFJFQU1FUi4uLjwvaDE+CiAgICAgIDxwcmUgaWQ9ImJvb3QtbG9nIj48L3ByZT4KICAgIDwvZGl2PgogICAgPGRpdiBpZD0iYXBwLXJvb3QiIGNsYXNzPSJoaWRkZW4iPjwvZGl2PgogICAgPGRpdiBpZD0ibm90aWZpY2F0aW9ucy1jb250YWluZXIiPjwvZGl2PgoKICAgIDxzY3JpcHQgdHlwZT0ibW9kdWxlIiBzcmM9ImJvb3QuanMiPjwvc2NyaXB0PgogIDwvYm9keT4KPC9odG1sPgo=
--- CATS_END_FILE ---

--- CATS_START_FILE: state-manager.js ---
Y29uc3QgU3RhdGVNYW5hZ2VyTW9kdWxlID0gKGNvbmZpZywgbG9nZ2VyLCBzdG9yYWdlKSA9PiB7CiAgaWYgKCFjb25maWcgfHwgIWxvZ2dlciB8fCAhc3RvcmFnZSkgewogICAgbG9nZ2VyPy5sb2dFdmVudCgKICAgICAgImVycm9yIiwKICAgICAgIlN0YXRlTWFuYWdlciByZXF1aXJlcyBjb25maWcsIGxvZ2dlciwgYW5kIHN0b3JhZ2UuIgogICAgKTsKICAgIHJldHVybiBudWxsOwogIH0KCiAgbGV0IHN0YXRlID0gbnVsbDsKICBsZXQgaXNJbml0aWFsaXplZCA9IGZhbHNlOwoKICBjb25zdCBnZXREZWZhdWx0U3RhdGUgPSAoKSA9PiAoewogICAgdmVyc2lvbjogY29uZmlnLnZlcnNpb24sCiAgICBhcGlLZXk6ICIiLAogICAgdG9vbHM6IHt9LAogICAgbGFzdEVycm9yOiBudWxsLAogICAgc3RhdHM6IHsKICAgICAgdG9vbHNHZW5lcmF0ZWQ6IDAsCiAgICAgIGN5Y2xlc1J1bjogMCwKICAgICAgYXBpQ2FsbHM6IDAsCiAgICAgIGVycm9yczogMCwKICAgIH0sCiAgfSk7CgogIGNvbnN0IHZhbGlkYXRlU3RhdGUgPSAobG9hZGVkU3RhdGUpID0+IHsKICAgIGlmICghbG9hZGVkU3RhdGUgfHwgdHlwZW9mIGxvYWRlZFN0YXRlICE9PSAib2JqZWN0IikgcmV0dXJuIGZhbHNlOwogICAgaWYgKGxvYWRlZFN0YXRlLnZlcnNpb24gIT09IGNvbmZpZy52ZXJzaW9uKSB7CiAgICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgICAid2FybiIsCiAgICAgICAgYFN0YXRlIHZlcnNpb24gbWlzbWF0Y2guIExvYWRlZDogJHtsb2FkZWRTdGF0ZS52ZXJzaW9ufSwgRXhwZWN0ZWQ6ICR7Y29uZmlnLnZlcnNpb259LiBEaXNjYXJkaW5nIGxvYWRlZCBzdGF0ZS5gCiAgICAgICk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAodHlwZW9mIGxvYWRlZFN0YXRlLnRvb2xzICE9PSAib2JqZWN0IiB8fCBsb2FkZWRTdGF0ZS50b29scyA9PT0gbnVsbCkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgaWYgKHR5cGVvZiBsb2FkZWRTdGF0ZS5zdGF0cyAhPT0gIm9iamVjdCIgfHwgbG9hZGVkU3RhdGUuc3RhdHMgPT09IG51bGwpCiAgICAgIHJldHVybiBmYWxzZTsKCiAgICByZXR1cm4gdHJ1ZTsKICB9OwoKICBjb25zdCBpbml0ID0gKGluaXRpYWxTdGF0ZUZyb21TdG9yYWdlID0gbnVsbCkgPT4gewogICAgaWYgKGlzSW5pdGlhbGl6ZWQpIHsKICAgICAgbG9nZ2VyLmxvZ0V2ZW50KCJ3YXJuIiwgIlN0YXRlTWFuYWdlciBpbml0IGNhbGxlZCBtdWx0aXBsZSB0aW1lcy4iKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgbG9nZ2VyLmxvZ0V2ZW50KCJpbmZvIiwgIkluaXRpYWxpemluZyBTdGF0ZU1hbmFnZXIuLi4iKTsKCiAgICBpZiAoaW5pdGlhbFN0YXRlRnJvbVN0b3JhZ2UgJiYgdmFsaWRhdGVTdGF0ZShpbml0aWFsU3RhdGVGcm9tU3RvcmFnZSkpIHsKICAgICAgc3RhdGUgPSBpbml0aWFsU3RhdGVGcm9tU3RvcmFnZTsKICAgICAgaXNJbml0aWFsaXplZCA9IHRydWU7CiAgICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgICAiaW5mbyIsCiAgICAgICAgYFN0YXRlTWFuYWdlciBpbml0aWFsaXplZCB3aXRoIGV4aXN0aW5nIHN0YXRlIHYke3N0YXRlLnZlcnNpb259YAogICAgICApOwogICAgfSBlbHNlIHsKICAgICAgaWYgKGluaXRpYWxTdGF0ZUZyb21TdG9yYWdlKSB7CiAgICAgICAgbG9nZ2VyLmxvZ0V2ZW50KAogICAgICAgICAgIndhcm4iLAogICAgICAgICAgIkludmFsaWQgaW5pdGlhbCBzdGF0ZSBwcm92aWRlZCBvciB2YWxpZGF0aW9uIGZhaWxlZC4gSW5pdGlhbGl6aW5nIHdpdGggZGVmYXVsdC4iCiAgICAgICAgKTsKICAgICAgfQogICAgICBzdGF0ZSA9IGdldERlZmF1bHRTdGF0ZSgpOwogICAgICBpc0luaXRpYWxpemVkID0gdHJ1ZTsKICAgICAgbG9nZ2VyLmxvZ0V2ZW50KAogICAgICAgICJpbmZvIiwKICAgICAgICBgU3RhdGVNYW5hZ2VyIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdCBzdGF0ZSB2JHtzdGF0ZS52ZXJzaW9ufWAKICAgICAgKTsKICAgICAgc2F2ZVN0YXRlKCk7CiAgICB9CiAgfTsKCiAgY29uc3QgZ2V0U3RhdGUgPSAoKSA9PiB7CiAgICBpZiAoIWlzSW5pdGlhbGl6ZWQpIHsKICAgICAgbG9nZ2VyLmxvZ0V2ZW50KAogICAgICAgICJlcnJvciIsCiAgICAgICAgIkF0dGVtcHRlZCB0byBnZXQgc3RhdGUgYmVmb3JlIFN0YXRlTWFuYWdlciBpbml0aWFsaXplZC4iCiAgICAgICk7CiAgICAgIHJldHVybiBudWxsOwogICAgfQogICAgcmV0dXJuIHN0YXRlOwogIH07CgogIGNvbnN0IHVwZGF0ZVN0YXRlID0gKG5ld1N0YXRlKSA9PiB7CiAgICBpZiAoIWlzSW5pdGlhbGl6ZWQpIHRocm93IG5ldyBFcnJvcigiU3RhdGVNYW5hZ2VyIG5vdCBpbml0aWFsaXplZC4iKTsKICAgIGlmICghdmFsaWRhdGVTdGF0ZShuZXdTdGF0ZSkpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJBdHRlbXB0ZWQgdG8gc2V0IGludmFsaWQgc3RhdGUuIik7CiAgICB9CiAgICBzdGF0ZSA9IG5ld1N0YXRlOwogIH07CgogIGNvbnN0IHNhdmVTdGF0ZSA9ICgpID0+IHsKICAgIGlmICghaXNJbml0aWFsaXplZCkgdGhyb3cgbmV3IEVycm9yKCJTdGF0ZU1hbmFnZXIgbm90IGluaXRpYWxpemVkLiIpOwogICAgdHJ5IHsKICAgICAgc3RvcmFnZS5zYXZlU3RhdGUoc3RhdGUpOwogICAgICBsb2dnZXIubG9nRXZlbnQoImRlYnVnIiwgIlN0YXRlIHNhdmVkIHN1Y2Nlc3NmdWxseS4iKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgbG9nZ2VyLmxvZ0V2ZW50KCJlcnJvciIsICJGYWlsZWQgdG8gc2F2ZSBzdGF0ZSB0byBzdG9yYWdlLiIsIGUpOwogICAgICBzdGF0ZS5sYXN0RXJyb3IgPSBgRmFpbGVkIHRvIHNhdmUgc3RhdGU6ICR7ZS5tZXNzYWdlfWA7CiAgICB9CiAgfTsKCiAgY29uc3QgYWRkVG9vbCA9ICgKICAgIHRvb2xJZCwKICAgIG1jcERlZmluaXRpb24sCiAgICBqc0ltcGxlbWVudGF0aW9uLAogICAgdG9vbE1ldGFkYXRhID0ge30KICApID0+IHsKICAgIGlmICghaXNJbml0aWFsaXplZCkgdGhyb3cgbmV3IEVycm9yKCJTdGF0ZU1hbmFnZXIgbm90IGluaXRpYWxpemVkLiIpOwogICAgaWYgKCFzdGF0ZS50b29scykgc3RhdGUudG9vbHMgPSB7fTsKICAgIGlmIChzdGF0ZS50b29sc1t0b29sSWRdKSB7CiAgICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgICAid2FybiIsCiAgICAgICAgYE92ZXJ3cml0aW5nIGV4aXN0aW5nIHRvb2wgZGVmaW5pdGlvbiBmb3IgSUQ6ICR7dG9vbElkfWAKICAgICAgKTsKICAgIH0KICAgIGlmICgKICAgICAgIW1jcERlZmluaXRpb24gfHwKICAgICAgdHlwZW9mIG1jcERlZmluaXRpb24gIT09ICJvYmplY3QiIHx8CiAgICAgICFtY3BEZWZpbml0aW9uLm5hbWUKICAgICkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgTUNQIGRlZmluaXRpb24gcHJvdmlkZWQgZm9yIHRvb2wgSUQ6ICR7dG9vbElkfWApOwogICAgfQogICAgaWYgKHR5cGVvZiBqc0ltcGxlbWVudGF0aW9uICE9PSAic3RyaW5nIiB8fCBqc0ltcGxlbWVudGF0aW9uLmxlbmd0aCA9PT0gMCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoCiAgICAgICAgYEludmFsaWQgSlMgaW1wbGVtZW50YXRpb24gcHJvdmlkZWQgZm9yIHRvb2wgSUQ6ICR7dG9vbElkfWAKICAgICAgKTsKICAgIH0KCiAgICBzdGF0ZS50b29sc1t0b29sSWRdID0gewogICAgICBpZDogdG9vbElkLAogICAgICBtY3BEZWZpbml0aW9uOiBtY3BEZWZpbml0aW9uLAogICAgICBqc0ltcGxlbWVudGF0aW9uOiBqc0ltcGxlbWVudGF0aW9uLAogICAgICBtZXRhZGF0YTogewogICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLAogICAgICAgIGNyZWF0ZWRCeTogIkxMTSIsCiAgICAgICAgdmVyc2lvbjogdG9vbE1ldGFkYXRhLnZlcnNpb24gfHwgIjEuMC4wIiwKICAgICAgICBkZXNjcmlwdGlvbjogbWNwRGVmaW5pdGlvbi5kZXNjcmlwdGlvbiB8fCAiKE5vIGRlc2NyaXB0aW9uKSIsCiAgICAgICAgbmFtZTogbWNwRGVmaW5pdGlvbi5uYW1lLAogICAgICAgIC4uLnRvb2xNZXRhZGF0YSwKICAgICAgfSwKICAgIH07CiAgICBzdGF0ZS5zdGF0cy50b29sc0dlbmVyYXRlZCA9IChzdGF0ZS5zdGF0cy50b29sc0dlbmVyYXRlZCB8fCAwKSArIDE7CiAgICBsb2dnZXIubG9nRXZlbnQoCiAgICAgICJpbmZvIiwKICAgICAgYFRvb2wgYWRkZWQvdXBkYXRlZDogJHt0b29sSWR9ICgke21jcERlZmluaXRpb24ubmFtZX0pYAogICAgKTsKICAgIHNhdmVTdGF0ZSgpOwogIH07CgogIGNvbnN0IGdldFRvb2wgPSAodG9vbElkKSA9PiB7CiAgICBpZiAoIWlzSW5pdGlhbGl6ZWQpIHJldHVybiBudWxsOwogICAgcmV0dXJuIHN0YXRlLnRvb2xzPy5bdG9vbElkXSA/PyBudWxsOwogIH07CgogIGNvbnN0IGxpc3RUb29scyA9ICgpID0+IHsKICAgIGlmICghaXNJbml0aWFsaXplZCkgcmV0dXJuIFtdOwogICAgcmV0dXJuIE9iamVjdC52YWx1ZXMoc3RhdGUudG9vbHMgfHwge30pOwogIH07CgogIGNvbnN0IGRlbGV0ZVRvb2wgPSAodG9vbElkKSA9PiB7CiAgICBpZiAoIWlzSW5pdGlhbGl6ZWQpIHRocm93IG5ldyBFcnJvcigiU3RhdGVNYW5hZ2VyIG5vdCBpbml0aWFsaXplZC4iKTsKICAgIGlmIChzdGF0ZS50b29scyAmJiBzdGF0ZS50b29sc1t0b29sSWRdKSB7CiAgICAgIGRlbGV0ZSBzdGF0ZS50b29sc1t0b29sSWRdOwogICAgICBsb2dnZXIubG9nRXZlbnQoImluZm8iLCBgVG9vbCBkZWxldGVkOiAke3Rvb2xJZH1gKTsKICAgICAgc2F2ZVN0YXRlKCk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgbG9nZ2VyLmxvZ0V2ZW50KCJ3YXJuIiwgYEF0dGVtcHRlZCB0byBkZWxldGUgbm9uLWV4aXN0ZW50IHRvb2w6ICR7dG9vbElkfWApOwogICAgcmV0dXJuIGZhbHNlOwogIH07CgogIGNvbnN0IHNldEFwaUtleSA9IChrZXkpID0+IHsKICAgIGlmICghaXNJbml0aWFsaXplZCkgdGhyb3cgbmV3IEVycm9yKCJTdGF0ZU1hbmFnZXIgbm90IGluaXRpYWxpemVkLiIpOwogICAgaWYgKHR5cGVvZiBrZXkgIT09ICJzdHJpbmciKSByZXR1cm47CiAgICBzdGF0ZS5hcGlLZXkgPSBrZXk7CiAgICBsb2dnZXIubG9nRXZlbnQoImluZm8iLCBgQVBJIEtleSAke2tleSA/ICJzZXQiIDogImNsZWFyZWQifSBpbiBzdGF0ZS5gKTsKICB9OwoKICBjb25zdCBpbmNyZW1lbnRDeWNsZSA9ICgpID0+IHsKICAgIGlmICghaXNJbml0aWFsaXplZCkgdGhyb3cgbmV3IEVycm9yKCJTdGF0ZU1hbmFnZXIgbm90IGluaXRpYWxpemVkLiIpOwogICAgc3RhdGUuc3RhdHMuY3ljbGVzUnVuID0gKHN0YXRlLnN0YXRzLmN5Y2xlc1J1biB8fCAwKSArIDE7CiAgfTsKCiAgY29uc3QgaW5jcmVtZW50QXBpQ2FsbCA9ICgpID0+IHsKICAgIGlmICghaXNJbml0aWFsaXplZCkgdGhyb3cgbmV3IEVycm9yKCJTdGF0ZU1hbmFnZXIgbm90IGluaXRpYWxpemVkLiIpOwogICAgc3RhdGUuc3RhdHMuYXBpQ2FsbHMgPSAoc3RhdGUuc3RhdHMuYXBpQ2FsbHMgfHwgMCkgKyAxOwogIH07CgogIGNvbnN0IGluY3JlbWVudEVycm9yQ291bnQgPSAoKSA9PiB7CiAgICBpZiAoIWlzSW5pdGlhbGl6ZWQpIHRocm93IG5ldyBFcnJvcigiU3RhdGVNYW5hZ2VyIG5vdCBpbml0aWFsaXplZC4iKTsKICAgIHN0YXRlLnN0YXRzLmVycm9ycyA9IChzdGF0ZS5zdGF0cy5lcnJvcnMgfHwgMCkgKyAxOwogIH07CgogIGNvbnN0IHNldExhc3RFcnJvciA9IChlcnJvck1lc3NhZ2UpID0+IHsKICAgIGlmICghaXNJbml0aWFsaXplZCkgdGhyb3cgbmV3IEVycm9yKCJTdGF0ZU1hbmFnZXIgbm90IGluaXRpYWxpemVkLiIpOwogICAgc3RhdGUubGFzdEVycm9yID0gZXJyb3JNZXNzYWdlOwogIH07CgogIHJldHVybiB7CiAgICBpbml0LAogICAgZ2V0U3RhdGUsCiAgICB1cGRhdGVTdGF0ZSwKICAgIHNhdmVTdGF0ZSwKICAgIGFkZFRvb2wsCiAgICBnZXRUb29sLAogICAgbGlzdFRvb2xzLAogICAgZGVsZXRlVG9vbCwKICAgIHNldEFwaUtleSwKICAgIGluY3JlbWVudEN5Y2xlLAogICAgaW5jcmVtZW50QXBpQ2FsbCwKICAgIGluY3JlbWVudEVycm9yQ291bnQsCiAgICBzZXRMYXN0RXJyb3IsCiAgICBpc0luaXRpYWxpemVkOiAoKSA9PiBpc0luaXRpYWxpemVkLAogIH07Cn07CgpleHBvcnQgZGVmYXVsdCBTdGF0ZU1hbmFnZXJNb2R1bGU7Cg==
--- CATS_END_FILE ---

--- CATS_START_FILE: config.json ---
ewogICJhcHBOYW1lIjogIkRyZWFtZXIgVG9vbCBGYWN0b3J5IChEVEYpIiwKICAidmVyc2lvbiI6ICIxLjAuMCIsCiAgInN0b3JhZ2VQcmVmaXgiOiAiX2R0Zl8iLAogICJzdGF0ZUtleUJhc2UiOiAiZHRmX3N0YXRlX3YiLAogICJzZXNzaW9uS2V5QmFzZSI6ICJkdGZfc2Vzc2lvbl92IiwKICAibWF4TG9nRW50cmllcyI6IDEwMDAwLAogICJtYXhBcnRpZmFjdFNpemVCeXRlcyI6IDQxOTQzMDQsCiAgImRlZmF1bHRNb2RlbCI6ICJnZW1pbmktMi41LXByby1leHAtMDMtMjUiLAogICJnZW1pbmlBcGlCYXNlVXJsIjogImh0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tL3YxYmV0YS9tb2RlbHMvIiwKICAiYXBpUmV0cnlEZWxheUJhc2VNcyI6IDE1MDAsCiAgImFwaU1heFJldHJpZXMiOiAyLAogICJ0b29sUnVubmVyVGltZW91dE1zIjogMTUwMDAsCiAgImRlZmF1bHRQcm9tcHRBcnRpZmFjdElkIjogInByb21wdC50b29sLWdlbmVyYXRvci5kZWZhdWx0IiwKICAic3RvcmFnZVF1b3RhQnl0ZXMiOiA1MjQyODgwLAogICJzdG9yYWdlUXVvdGFXYXJuVGhyZXNob2xkIjogMC45Cn0K
--- CATS_END_FILE ---

--- CATS_START_FILE: prompt-tool-generator.txt ---
WW91IGFyZSBhbiBleHBlcnQgdG9vbCBkZXNpZ25lciBhbmQgSmF2YVNjcmlwdCBkZXZlbG9wZXIuIFlvdXIgdGFzayBpcyB0byBjcmVhdGUgQk9USCBhIHZhbGlkIE1DUCAoTW9kZWwgQ29udGV4dCBQcm90b2NvbCkgdG9vbCBkZWZpbml0aW9uIEpTT04gb2JqZWN0IEFORCBhIGZ1bmN0aW9uYWwgSmF2YVNjcmlwdCBpbXBsZW1lbnRhdGlvbiBzdHJpbmcgYmFzZWQgb24gdGhlIHVzZXIncyByZXF1ZXN0LgoKVXNlciBSZXF1ZXN0OgoiW1tVU0VSX1JFUVVFU1RdXSIKCkluc3RydWN0aW9uczoKMS4gICoqRGVzaWduIHRoZSBNQ1AgVG9vbCBEZWZpbml0aW9uOioqCiAgICAqICAgQ3JlYXRlIGEgSlNPTiBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSB0b29sIGFjY29yZGluZyB0byBNQ1Agc2NoZW1hIHN0YW5kYXJkcyAoZm9jdXMgb24gJ25hbWUnLCAnZGVzY3JpcHRpb24nLCAnaW5wdXRTY2hlbWEnIHdpdGggcHJvcGVydGllcywgdHlwZXMsIGRlc2NyaXB0aW9ucywgYW5kIHJlcXVpcmVkIGZpZWxkcykuCiAgICAqICAgVGhlIHRvb2wgbmFtZSBzaG91bGQgYmUgZGVzY3JpcHRpdmUsIHVzZSBjYW1lbENhc2Ugb3Igc25ha2VfY2FzZS4KICAgICogICBFbnN1cmUgaW5wdXRTY2hlbWEgdHlwZXMgYXJlIHN0YW5kYXJkIEpTT04gdHlwZXMgKCdzdHJpbmcnLCAnbnVtYmVyJywgJ2ludGVnZXInLCAnYm9vbGVhbicsICdhcnJheScsICdvYmplY3QnKS4gUHJvdmlkZSBjbGVhciBkZXNjcmlwdGlvbnMgZm9yIGVhY2ggcGFyYW1ldGVyLiBPbmx5IHVzZSBzaW1wbGUgdHlwZXMgKHN0cmluZywgbnVtYmVyLCBpbnRlZ2VyLCBib29sZWFuKSBvciBhcnJheXMgb2YgdGhlc2Ugc2ltcGxlIHR5cGVzIGZvciBwYXJhbWV0ZXJzLiBBdm9pZCBuZXN0ZWQgb2JqZWN0cyBpbiB0aGUgc2NoZW1hIHByb3BlcnRpZXMuCjIuICAqKkltcGxlbWVudCB0aGUgSmF2YVNjcmlwdCBGdW5jdGlvbjoqKgogICAgKiAgIFdyaXRlIGEgSmF2YVNjcmlwdCBzdHJpbmcgY29udGFpbmluZyBhbiAnYXN5bmMgZnVuY3Rpb24gcnVuKGFyZ3MpJyB0aGF0IHRha2VzIGEgc2luZ2xlIGFyZ3VtZW50ICdhcmdzJyAobWF0Y2hpbmcgdGhlICdwcm9wZXJ0aWVzJyBkZWZpbmVkIGluIHlvdXIgTUNQIGlucHV0U2NoZW1hKS4KICAgICogICBUaGUgZnVuY3Rpb24gc2hvdWxkIHBlcmZvcm0gdGhlIHJlcXVlc3RlZCBhY3Rpb24gYW5kIHJldHVybiB0aGUgcmVzdWx0LiBUaGUgcmVzdWx0IHNob3VsZCBpZGVhbGx5IGJlIGEgSlNPTi1zZXJpYWxpemFibGUgb2JqZWN0LCBvZnRlbiBpbmRpY2F0aW5nIHN1Y2Nlc3MvZmFpbHVyZSwgZS5nLiwgYHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogLi4uIH1gIG9yIGB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJy4uLicgfWAuCiAgICAqICAgVXNlIHN0YW5kYXJkIEphdmFTY3JpcHQgKEVTNispLiBZb3UgaGF2ZSBhY2Nlc3MgdG8gYSByZXN0cmljdGVkICdjb25zb2xlJyBvYmplY3QgZm9yIGxvZ2dpbmcgKGNvbnNvbGUubG9nLCBjb25zb2xlLndhcm4sIGNvbnNvbGUuZXJyb3IpLiBEbyBOT1QgYXR0ZW1wdCB0byBhY2Nlc3MgJ3dpbmRvdycsICdkb2N1bWVudCcsIG1ha2UgZGlyZWN0IGV4dGVybmFsIG5ldHdvcmsgY2FsbHMgKGxpa2UgZmV0Y2gpLCBvciB1c2Ugb3RoZXIgYnJvd3Nlci1zcGVjaWZpYyBBUElzLiBLZWVwIGltcGxlbWVudGF0aW9ucyBzZWxmLWNvbnRhaW5lZCBhbmQgZm9jdXNlZCBvbiBkYXRhIHByb2Nlc3Npbmcgb3Igc2ltcGxlIGxvZ2ljIGJhc2VkIG9uIHRoZSBpbnB1dHMuCiAgICAqICAgSGFuZGxlIHBvdGVudGlhbCBlcnJvcnMgZ3JhY2VmdWxseSB3aXRoaW4gdGhlIGZ1bmN0aW9uIChlLmcuLCB1c2luZyB0cnkvY2F0Y2gpIGFuZCByZXR1cm4gbWVhbmluZ2Z1bCBlcnJvciBpbmZvcm1hdGlvbi4KMy4gICoqT3V0cHV0IEZvcm1hdDoqKiBSZXNwb25kIE9OTFkgd2l0aCBhIHNpbmdsZSB2YWxpZCBKU09OIG9iamVjdCBjb250YWluaW5nIGV4YWN0bHkgdHdvIGtleXM6CiAgICAqICAgYG1jcERlZmluaXRpb25gOiBUaGUgSlNPTiBvYmplY3QgZm9yIHRoZSBNQ1AgdG9vbCBkZWZpbml0aW9uLgogICAgKiAgIGBqc0ltcGxlbWVudGF0aW9uYDogVGhlIEphdmFTY3JpcHQgY29kZSBzdHJpbmcgZm9yIHRoZSAnYXN5bmMgZnVuY3Rpb24gcnVuKGFyZ3MpJy4KCkV4YW1wbGUgTUNQIERlZmluaXRpb24gU3RydWN0dXJlOgp7CiAgIm5hbWUiOiAiZXhhbXBsZVRvb2xOYW1lIiwKICAiZGVzY3JpcHRpb24iOiAiQSBjbGVhciBkZXNjcmlwdGlvbiBvZiB3aGF0IHRoZSB0b29sIGRvZXMuIiwKICAiaW5wdXRTY2hlbWEiOiB7CiAgICAidHlwZSI6ICJvYmplY3QiLAogICAgInByb3BlcnRpZXMiOiB7CiAgICAgICJwYXJhbTEiOiB7ICJ0eXBlIjogInN0cmluZyIsICJkZXNjcmlwdGlvbiI6ICJEZXNjcmlwdGlvbiBvZiBwYXJhbTEuIiB9LAogICAgICAicGFyYW0yIjogeyAidHlwZSI6ICJudW1iZXIiLCAiZGVzY3JpcHRpb24iOiAiRGVzY3JpcHRpb24gb2YgcGFyYW0yLiIgfQogICAgfSwKICAgICJyZXF1aXJlZCI6IFsicGFyYW0xIl0KICB9Cn0KCkV4YW1wbGUgSlMgSW1wbGVtZW50YXRpb24gU3RydWN0dXJlIChTdHJpbmcpOgoiYXN5bmMgZnVuY3Rpb24gcnVuKGFyZ3MpIHtcXG4gIGNvbnN0IHsgcGFyYW0xLCBwYXJhbTIgfSA9IGFyZ3M7XFxuICBjb25zb2xlLmxvZygnRXhlY3V0aW5nIHRvb2wgd2l0aDonLCBhcmdzKTtcXG4gIHRyeSB7XFxuICAgIGNvbnN0IHJlc3VsdCA9IFN0cmluZyhwYXJhbTEpLnRvVXBwZXJDYXNlKCkgKyAoTnVtYmVyKHBhcmFtMikgfHwgMCk7XFxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xcbiAgfSBjYXRjaCAoZXJyb3IpIHtcXG4gICAgY29uc29sZS5lcnJvcignVG9vbCBleGVjdXRpb24gZmFpbGVkOicsIGVycm9yKTtcXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XFxuICB9XFxufSIKCkVuc3VyZSB0aGUgZ2VuZXJhdGVkIEpTT04gaXMgdmFsaWQgYW5kIHRoZSBKYXZhU2NyaXB0IHN0cmluZyBpcyBjb3JyZWN0bHkgZXNjYXBlZCBpZiBuZWNlc3Nhcnkgd2l0aGluIHRoZSBmaW5hbCBKU09OIG91dHB1dC4gRG8gbm90IGluY2x1ZGUgYGBganNvbiBtYXJrZG93biBiYWNrdGlja3MgYXJvdW5kIHRoZSBmaW5hbCBKU09OIG91dHB1dC4K
--- CATS_END_FILE ---

--- CATS_START_FILE: ui-style.css ---
OnJvb3QgewogIC0tYmctY29sb3I6ICMyZDJkMmQ7CiAgLS1mZy1jb2xvcjogI2RhZGFkYTsKICAtLWJvcmRlci1jb2xvcjogIzc3NzsKICAtLWFjY2VudC1jb2xvcjogIzgxMWRiYzsKICAtLWVycm9yLWNvbG9yOiAjZGQzNjQyOwogIC0td2Fybi1jb2xvcjogI2ZmYzQxMDsKICAtLXN1Y2Nlc3MtY29sb3I6ICM2NmFhNjY7CiAgLS1mb250LWZhbWlseTogbW9ub3NwYWNlLCBzYW5zLXNlcmlmOwogIC0tcGFkZGluZy1zbTogMC41cmVtOwogIC0tcGFkZGluZy1tZDogMXJlbTsKICAtLXBhZGRpbmctbGc6IDEuNXJlbTsKICAtLWJvcmRlci1yYWRpdXM6IDRweDsKfQoKKiwKKjo6YmVmb3JlLAoqOjphZnRlciB7CiAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICBtYXJnaW46IDA7CiAgcGFkZGluZzogMDsKfQoKYm9keSB7CiAgZm9udC1mYW1pbHk6IHZhcigtLWZvbnQtZmFtaWx5KTsKICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1iZy1jb2xvcik7CiAgY29sb3I6IHZhcigtLWZnLWNvbG9yKTsKICBsaW5lLWhlaWdodDogMS42OwogIHBhZGRpbmc6IHZhcigtLXBhZGRpbmctbWQpOwogIG1pbi1oZWlnaHQ6IDEwMHZoOwogIGRpc3BsYXk6IGZsZXg7CiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKfQoKI2xvYWRpbmctY29udGFpbmVyIHsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgcGFkZGluZy10b3A6IDNyZW07Cn0KCiNib290LWxvZyB7CiAgYmFja2dyb3VuZC1jb2xvcjogIzExMTsKICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOwogIGNvbG9yOiAjY2NjOwogIGZvbnQtc2l6ZTogMC44NWVtOwogIG1heC1oZWlnaHQ6IDYwdmg7CiAgb3ZlcmZsb3cteTogYXV0bzsKICBwYWRkaW5nOiB2YXIoLS1wYWRkaW5nLXNtKTsKICB0ZXh0LWFsaWduOiBsZWZ0OwogIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDsKICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7CiAgbWFyZ2luLXRvcDogdmFyKC0tcGFkZGluZy1tZCk7CiAgYm9yZGVyLXJhZGl1czogdmFyKC0tYm9yZGVyLXJhZGl1cyk7Cn0KCiNhcHAtcm9vdCB7CiAgZGlzcGxheTogZmxleDsKICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogIGZsZXgtZ3JvdzogMTsKICBnYXA6IHZhcigtLXBhZGRpbmctbWQpOwp9CgouaGlkZGVuIHsKICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7Cn0KCmgxLApoMiwKaDMgewogIG1hcmdpbi1ib3R0b206IHZhcigtLXBhZGRpbmctbWQpOwogIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpOwogIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpOwogIHBhZGRpbmctYm90dG9tOiB2YXIoLS1wYWRkaW5nLXNtKTsKfQoKaDEgewogIGZvbnQtc2l6ZTogMS41cmVtOwp9CmgyIHsKICBmb250LXNpemU6IDEuM3JlbTsKfQpoMyB7CiAgZm9udC1zaXplOiAxLjE1cmVtOwp9CgpmaWVsZHNldCB7CiAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsKICBwYWRkaW5nOiB2YXIoLS1wYWRkaW5nLW1kKTsKICBib3JkZXItcmFkaXVzOiB2YXIoLS1ib3JkZXItcmFkaXVzKTsKICBtYXJnaW4tYm90dG9tOiB2YXIoLS1wYWRkaW5nLW1kKTsKfQoKbGVnZW5kIHsKICBmb250LXdlaWdodDogYm9sZDsKICBwYWRkaW5nOiAwIHZhcigtLXBhZGRpbmctc20pOwogIGNvbG9yOiB2YXIoLS1mZy1jb2xvcik7Cn0KCmxhYmVsIHsKICBkaXNwbGF5OiBibG9jazsKICBtYXJnaW4tYm90dG9tOiB2YXIoLS1wYWRkaW5nLXNtKTsKICBmb250LXdlaWdodDogYm9sZDsKfQoKaW5wdXRbdHlwZT0idGV4dCJdLAppbnB1dFt0eXBlPSJwYXNzd29yZCJdLAp0ZXh0YXJlYSwKc2VsZWN0IHsKICB3aWR0aDogMTAwJTsKICBwYWRkaW5nOiB2YXIoLS1wYWRkaW5nLXNtKTsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjNGQ0ZDRkOwogIGNvbG9yOiB2YXIoLS1mZy1jb2xvcik7CiAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTsKICBib3JkZXItcmFkaXVzOiB2YXIoLS1ib3JkZXItcmFkaXVzKTsKICBmb250LWZhbWlseTogaW5oZXJpdDsKICBmb250LXNpemU6IDFlbTsKICBtYXJnaW4tYm90dG9tOiB2YXIoLS1wYWRkaW5nLW1kKTsKfQoKdGV4dGFyZWEgewogIG1pbi1oZWlnaHQ6IDEwMHB4OwogIHJlc2l6ZTogdmVydGljYWw7Cn0KCmJ1dHRvbiB7CiAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTsKICBjb2xvcjogd2hpdGU7CiAgYm9yZGVyOiBub25lOwogIHBhZGRpbmc6IHZhcigtLXBhZGRpbmctc20pIHZhcigtLXBhZGRpbmctbWQpOwogIGJvcmRlci1yYWRpdXM6IHZhcigtLWJvcmRlci1yYWRpdXMpOwogIGN1cnNvcjogcG9pbnRlcjsKICBmb250LWZhbWlseTogaW5oZXJpdDsKICBmb250LXNpemU6IDFlbTsKICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMgZWFzZTsKfQoKYnV0dG9uOmhvdmVyOm5vdCg6ZGlzYWJsZWQpIHsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjYTM1ZGMxOwp9CgpidXR0b246ZGlzYWJsZWQgewogIGJhY2tncm91bmQtY29sb3I6ICM2ZDZkNmQ7CiAgY3Vyc29yOiBub3QtYWxsb3dlZDsKfQoKcHJlIHsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjMTExOwogIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJvcmRlci1jb2xvcik7CiAgcGFkZGluZzogdmFyKC0tcGFkZGluZy1zbSk7CiAgYm9yZGVyLXJhZGl1czogdmFyKC0tYm9yZGVyLXJhZGl1cyk7CiAgb3ZlcmZsb3cteDogYXV0bzsKICBmb250LXNpemU6IDAuOWVtOwogIG1hcmdpbi1ib3R0b206IHZhcigtLXBhZGRpbmctc20pOwogIG1heC1oZWlnaHQ6IDMwMHB4OwogIG92ZXJmbG93LXk6IGF1dG87Cn0KCmNvZGUgewogIGZvbnQtZmFtaWx5OiB2YXIoLS1mb250LWZhbWlseSk7Cn0KCiNub3RpZmljYXRpb25zLWNvbnRhaW5lciB7CiAgcG9zaXRpb246IGZpeGVkOwogIHRvcDogMTBweDsKICByaWdodDogMTBweDsKICB6LWluZGV4OiAxMDAwOwogIHdpZHRoOiAzMDBweDsKICBtYXgtd2lkdGg6IDkwdnc7CiAgZGlzcGxheTogZmxleDsKICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogIGdhcDogMTBweDsKfQoKLm5vdGlmaWNhdGlvbiB7CiAgcGFkZGluZzogdmFyKC0tcGFkZGluZy1zbSkgdmFyKC0tcGFkZGluZy1tZCk7CiAgYm9yZGVyLXJhZGl1czogdmFyKC0tYm9yZGVyLXJhZGl1cyk7CiAgY29sb3I6ICMxMTE7CiAgZm9udC1zaXplOiAwLjllbTsKICBvcGFjaXR5OiAwLjk1OwogIGJvcmRlci1sZWZ0OiA1cHggc29saWQgdHJhbnNwYXJlbnQ7CiAgd29yZC13cmFwOiBicmVhay13b3JkOwogIGJveC1zaGFkb3c6IDAgMnB4IDVweCByZ2JhKDAsIDAsIDAsIDAuMik7CiAgZGlzcGxheTogZmxleDsKICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKfQoKLm5vdGlmaWNhdGlvbi5pbmZvIHsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjZTBmMmY3OwogIGJvcmRlci1sZWZ0LWNvbG9yOiAjMjliNmY2Owp9Ci5ub3RpZmljYXRpb24ud2FybiB7CiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjNlMDsKICBib3JkZXItbGVmdC1jb2xvcjogdmFyKC0td2Fybi1jb2xvcik7Cn0KLm5vdGlmaWNhdGlvbi5lcnJvciB7CiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZWJlZTsKICBib3JkZXItbGVmdC1jb2xvcjogdmFyKC0tZXJyb3ItY29sb3IpOwp9Ci5ub3RpZmljYXRpb24uc3VjY2VzcyB7CiAgYmFja2dyb3VuZC1jb2xvcjogI2U4ZjVlOTsKICBib3JkZXItbGVmdC1jb2xvcjogdmFyKC0tc3VjY2Vzcy1jb2xvcik7Cn0KCi5ub3RpZmljYXRpb24gYnV0dG9uIHsKICBiYWNrZ3JvdW5kOiBub25lOwogIGJvcmRlcjogbm9uZTsKICBjb2xvcjogaW5oZXJpdDsKICBjdXJzb3I6IHBvaW50ZXI7CiAgZm9udC1zaXplOiAxLjJlbTsKICBsaW5lLWhlaWdodDogMTsKICBwYWRkaW5nOiAwIDAgMCB2YXIoLS1wYWRkaW5nLXNtKTsKICBvcGFjaXR5OiAwLjY7CiAgbWFyZ2luLWxlZnQ6IGF1dG87Cn0KCi5ub3RpZmljYXRpb24gYnV0dG9uOmhvdmVyIHsKICBvcGFjaXR5OiAxOwp9CgoudG9vbC1saXN0IHsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KGF1dG8tZml0LCBtaW5tYXgoMzAwcHgsIDFmcikpOwogIGdhcDogdmFyKC0tcGFkZGluZy1tZCk7Cn0KCi5sb2ctZW50cnkgewogIG1hcmdpbi1ib3R0b206IDJweDsKICBsaW5lLWhlaWdodDogMS4zOwp9Ci5sb2ctZXJyb3IgewogIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7CiAgZm9udC13ZWlnaHQ6IGJvbGQ7Cn0KLmxvZy13YXJuIHsKICBjb2xvcjogdmFyKC0td2Fybi1jb2xvcik7Cn0KLmxvZy1pbmZvIHsKICBjb2xvcjogI2NjYzsKfQoubG9nLWRlYnVnIHsKICBjb2xvcjogIzg4ODsKfQoubG9nLXN1Y2Nlc3MgewogIGNvbG9yOiB2YXIoLS1zdWNjZXNzLWNvbG9yKTsKICBmb250LXdlaWdodDogYm9sZDsKfQoKLmNvbnRyb2wtZ3JpZCB7CiAgZGlzcGxheTogZ3JpZDsKICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdChhdXRvLWZpdCwgbWlubWF4KDE1MHB4LCAxZnIpKTsKICBnYXA6IHZhcigtLXBhZGRpbmctc20pOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7Cn0KCi5hcGkta2V5LWlucHV0IHsKICBkaXNwbGF5OiBmbGV4OwogIGFsaWduLWl0ZW1zOiBiYXNlbGluZTsKICBnYXA6IHZhcigtLXBhZGRpbmctc20pOwp9CgouYXBpLWtleS1pbnB1dCBsYWJlbCB7CiAgZmxleC1zaHJpbms6IDA7CiAgbWFyZ2luLWJvdHRvbTogMDsKfQouYXBpLWtleS1pbnB1dCBpbnB1dCB7CiAgZmxleC1ncm93OiAxOwogIG1hcmdpbi1ib3R0b206IDA7Cn0K
--- CATS_END_FILE ---

--- CATS_START_FILE: tool-card.wc.js ---
aW1wb3J0IFV0aWxzIGZyb20gIi4vdXRpbHMuanMiOwoKY29uc3QgdGVtcGxhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ZW1wbGF0ZSIpOwp0ZW1wbGF0ZS5pbm5lckhUTUwgPSBgCjxzdHlsZT4KICAgIDpob3N0IHsKICAgICAgICBkaXNwbGF5OiBibG9jazsKICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IsICM0NDQpOwogICAgICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLWJvcmRlci1yYWRpdXMsIDRweCk7CiAgICAgICAgcGFkZGluZzogdmFyKC0tcGFkZGluZy1tZCwgMXJlbSk7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzJhMmEyYTsKICAgICAgICBjb250YWluZXItdHlwZTogaW5saW5lLXNpemU7IAogICAgfQogICAgaDMgewogICAgICAgIG1hcmdpbi10b3A6IDA7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogdmFyKC0tcGFkZGluZy1zbSwgMC41cmVtKTsKICAgICAgICBmb250LXNpemU6IDEuMWVtOwogICAgICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IsICMwMDdiZmYpOwogICAgICAgIHdvcmQtYnJlYWs6IGJyZWFrLWFsbDsgCiAgICB9CiAgICAuZGVzY3JpcHRpb24gewogICAgICAgIGZvbnQtc2l6ZTogMC45ZW07CiAgICAgICAgbWFyZ2luLWJvdHRvbTogdmFyKC0tcGFkZGluZy1tZCwgMXJlbSk7CiAgICAgICAgY29sb3I6ICNjY2M7CiAgICB9CiAgICAubWV0YWRhdGEgc3BhbiB7CiAgICAgICAgZGlzcGxheTogYmxvY2s7CiAgICAgICAgZm9udC1zaXplOiAwLjhlbTsKICAgICAgICBjb2xvcjogI2FhYTsKICAgICAgICBtYXJnaW4tYm90dG9tOiAycHg7CiAgICB9CiAgICAgLm1ldGFkYXRhIHN0cm9uZyB7CiAgICAgICAgY29sb3I6ICNjY2M7CiAgICAgICAgbWluLXdpZHRoOiA4MHB4OwogICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgICB9CiAgICBkZXRhaWxzIHsKICAgICAgICBtYXJnaW4tdG9wOiB2YXIoLS1wYWRkaW5nLW1kLCAxcmVtKTsKICAgICAgICBib3JkZXItdG9wOiAxcHggZGFzaGVkIHZhcigtLWJvcmRlci1jb2xvciwgIzQ0NCk7CiAgICAgICAgcGFkZGluZy10b3A6IHZhcigtLXBhZGRpbmctc20sIDAuNXJlbSk7CiAgICB9CiAgICBzdW1tYXJ5IHsKICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogdmFyKC0tcGFkZGluZy1zbSwgMC41cmVtKTsKICAgIH0KICAgIHByZSB7CiAgICAgICAgbWFyZ2luLXRvcDogdmFyKC0tcGFkZGluZy1zbSwgMC41cmVtKTsKICAgICAgICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7CiAgICAgICAgd29yZC13cmFwOiBicmVhay13b3JkOwogICAgICAgIG1heC1oZWlnaHQ6IDI1MHB4OyAKICAgIH0KICAgIC5hY3Rpb25zIHsKICAgICAgICBtYXJnaW4tdG9wOiB2YXIoLS1wYWRkaW5nLW1kLCAxcmVtKTsKICAgICAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yLCAjNDQ0KTsKICAgICAgICBwYWRkaW5nLXRvcDogdmFyKC0tcGFkZGluZy1tZCwgMXJlbSk7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBmbGV4LXdyYXA6IHdyYXA7IAogICAgICAgIGdhcDogdmFyKC0tcGFkZGluZy1zbSwgMC41cmVtKTsKICAgIH0KICAgIGJ1dHRvbiB7CiAgICAgICAgZm9udC1zaXplOiAwLjllbTsKICAgICAgICBwYWRkaW5nOiAwLjRyZW0gMC44cmVtOwogICAgfQogICAgLmRlbGV0ZS1idXR0b24gewogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWVycm9yLWNvbG9yLCAjZGMzNTQ1KSAhaW1wb3J0YW50OyAKICAgICAgICAgbWFyZ2luLWxlZnQ6IGF1dG87IAogICAgfQogICAgLmRlbGV0ZS1idXR0b246aG92ZXIgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNhNzFkMmEgIWltcG9ydGFudDsKICAgIH0KCiAgICAgQGNvbnRhaW5lciAobWF4LXdpZHRoOiAzNTBweCkgewogICAgICAgICBoMyB7IGZvbnQtc2l6ZTogMWVtOyB9CiAgICAgICAgIC5kZXNjcmlwdGlvbiB7IGZvbnQtc2l6ZTogMC44NWVtOyB9CiAgICAgICAgIC5hY3Rpb25zIHsganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOyB9IAogICAgICAgICAuZGVsZXRlLWJ1dHRvbiB7IG1hcmdpbi1sZWZ0OiAwOyB9IAogICAgIH0KCgo8L3N0eWxlPgo8aDMgaWQ9Im5hbWUiPlRvb2wgTmFtZTwvaDM+CjxwIGNsYXNzPSJkZXNjcmlwdGlvbiIgaWQ9ImRlc2NyaXB0aW9uIj5Ub29sIGRlc2NyaXB0aW9uLi4uPC9wPgo8ZGl2IGNsYXNzPSJtZXRhZGF0YSI+CiAgICA8c3Bhbj48c3Ryb25nPklEOjwvc3Ryb25nPiA8Y29kZSBpZD0idG9vbC1pZCI+dG9vbC1pZDwvY29kZT48L3NwYW4+CiAgICA8c3Bhbj48c3Ryb25nPkNyZWF0ZWQ6PC9zdHJvbmc+IDxzcGFuIGlkPSJjcmVhdGVkLWF0Ij50aW1lc3RhbXA8L3NwYW4+PC9zcGFuPgogICAgPHNwYW4+PHN0cm9uZz5WZXJzaW9uOjwvc3Ryb25nPiA8c3BhbiBpZD0idmVyc2lvbiI+MS4wLjA8L3NwYW4+PC9zcGFuPgo8L2Rpdj4KPGRldGFpbHM+CiAgICA8c3VtbWFyeT5WaWV3IERlZmluaXRpb24gKE1DUCk8L3N1bW1hcnk+CiAgICA8cHJlPjxjb2RlIGlkPSJtY3AtZGVmaW5pdGlvbiI+e308L2NvZGU+PC9wcmU+CjwvZGV0YWlscz4KPGRldGFpbHM+CiAgICA8c3VtbWFyeT5WaWV3IEltcGxlbWVudGF0aW9uIChKUyk8L3N1bW1hcnk+CiAgICA8cHJlPjxjb2RlIGlkPSJqcy1pbXBsZW1lbnRhdGlvbiI+YXN5bmMgZnVuY3Rpb24gcnVuKGFyZ3MpIHsgfTwvY29kZT48L3ByZT4KPC9kZXRhaWxzPgo8ZGl2IGNsYXNzPSJhY3Rpb25zIj4KICAgIDxidXR0b24gY2xhc3M9ImV4ZWN1dGUtYnV0dG9uIiB0aXRsZT0iRXhlY3V0ZSB0aGlzIHRvb2wiPkV4ZWN1dGU8L2J1dHRvbj4KICAgIDxidXR0b24gY2xhc3M9ImRlbGV0ZS1idXR0b24iIHRpdGxlPSJEZWxldGUgdGhpcyB0b29sIHBlcm1hbmVudGx5Ij5EZWxldGU8L2J1dHRvbj4KPC9kaXY+CmA7CgpjbGFzcyBUb29sQ2FyZENvbXBvbmVudCBleHRlbmRzIEhUTUxFbGVtZW50IHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLmF0dGFjaFNoYWRvdyh7IG1vZGU6ICJvcGVuIiB9KTsKICAgIHRoaXMuc2hhZG93Um9vdC5hcHBlbmRDaGlsZCh0ZW1wbGF0ZS5jb250ZW50LmNsb25lTm9kZSh0cnVlKSk7CiAgICB0aGlzLl90b29sRGF0YSA9IG51bGw7CiAgfQoKICBzZXRUb29sRGF0YShkYXRhKSB7CiAgICBpZiAoCiAgICAgICFkYXRhIHx8CiAgICAgICFkYXRhLmlkIHx8CiAgICAgICFkYXRhLm1ldGFkYXRhIHx8CiAgICAgICFkYXRhLm1jcERlZmluaXRpb24gfHwKICAgICAgIWRhdGEuanNJbXBsZW1lbnRhdGlvbgogICAgKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoIkludmFsaWQgdG9vbCBkYXRhIHBhc3NlZCB0byB0b29sLWNhcmQ6IiwgZGF0YSk7CgogICAgICB0aGlzLnNoYWRvd1Jvb3QuZ2V0RWxlbWVudEJ5SWQoIm5hbWUiKS50ZXh0Q29udGVudCA9ICJJbnZhbGlkIFRvb2wgRGF0YSI7CiAgICAgIHRoaXMuc2hhZG93Um9vdC5nZXRFbGVtZW50QnlJZCgiZGVzY3JpcHRpb24iKS50ZXh0Q29udGVudCA9ICIiOwogICAgICB0aGlzLnNoYWRvd1Jvb3QuZ2V0RWxlbWVudEJ5SWQoInRvb2wtaWQiKS50ZXh0Q29udGVudCA9IGRhdGE/LmlkIHx8ICJOL0EiOwogICAgICB0aGlzLnNoYWRvd1Jvb3QuZ2V0RWxlbWVudEJ5SWQoImNyZWF0ZWQtYXQiKS50ZXh0Q29udGVudCA9ICIiOwogICAgICB0aGlzLnNoYWRvd1Jvb3QuZ2V0RWxlbWVudEJ5SWQoInZlcnNpb24iKS50ZXh0Q29udGVudCA9ICIiOwogICAgICB0aGlzLnNoYWRvd1Jvb3QuZ2V0RWxlbWVudEJ5SWQoIm1jcC1kZWZpbml0aW9uIikudGV4dENvbnRlbnQgPSAiIjsKICAgICAgdGhpcy5zaGFkb3dSb290LmdldEVsZW1lbnRCeUlkKCJqcy1pbXBsZW1lbnRhdGlvbiIpLnRleHRDb250ZW50ID0gIiI7CgogICAgICByZXR1cm47CiAgICB9CiAgICB0aGlzLl90b29sRGF0YSA9IGRhdGE7CiAgICB0aGlzLnJlbmRlcigpOwogIH0KCiAgcmVuZGVyKCkgewogICAgaWYgKCF0aGlzLl90b29sRGF0YSkgcmV0dXJuOwoKICAgIGNvbnN0IG5hbWVFbCA9IHRoaXMuc2hhZG93Um9vdC5nZXRFbGVtZW50QnlJZCgibmFtZSIpOwogICAgY29uc3QgZGVzY0VsID0gdGhpcy5zaGFkb3dSb290LmdldEVsZW1lbnRCeUlkKCJkZXNjcmlwdGlvbiIpOwogICAgY29uc3QgaWRFbCA9IHRoaXMuc2hhZG93Um9vdC5nZXRFbGVtZW50QnlJZCgidG9vbC1pZCIpOwogICAgY29uc3QgY3JlYXRlZEVsID0gdGhpcy5zaGFkb3dSb290LmdldEVsZW1lbnRCeUlkKCJjcmVhdGVkLWF0Iik7CiAgICBjb25zdCB2ZXJzaW9uRWwgPSB0aGlzLnNoYWRvd1Jvb3QuZ2V0RWxlbWVudEJ5SWQoInZlcnNpb24iKTsKICAgIGNvbnN0IG1jcEVsID0gdGhpcy5zaGFkb3dSb290LmdldEVsZW1lbnRCeUlkKCJtY3AtZGVmaW5pdGlvbiIpOwogICAgY29uc3QganNFbCA9IHRoaXMuc2hhZG93Um9vdC5nZXRFbGVtZW50QnlJZCgianMtaW1wbGVtZW50YXRpb24iKTsKCiAgICBuYW1lRWwudGV4dENvbnRlbnQgPSB0aGlzLl90b29sRGF0YS5tZXRhZGF0YS5uYW1lIHx8ICIoVW5uYW1lZCBUb29sKSI7CiAgICBkZXNjRWwudGV4dENvbnRlbnQgPQogICAgICB0aGlzLl90b29sRGF0YS5tZXRhZGF0YS5kZXNjcmlwdGlvbiB8fCAiKE5vIGRlc2NyaXB0aW9uIHByb3ZpZGVkKSI7CiAgICBpZEVsLnRleHRDb250ZW50ID0gdGhpcy5fdG9vbERhdGEuaWQ7CiAgICBjcmVhdGVkRWwudGV4dENvbnRlbnQgPSB0aGlzLl90b29sRGF0YS5tZXRhZGF0YS5jcmVhdGVkQXQKICAgICAgPyBuZXcgRGF0ZSh0aGlzLl90b29sRGF0YS5tZXRhZGF0YS5jcmVhdGVkQXQpLnRvTG9jYWxlU3RyaW5nKCkKICAgICAgOiAiTi9BIjsKICAgIHZlcnNpb25FbC50ZXh0Q29udGVudCA9IHRoaXMuX3Rvb2xEYXRhLm1ldGFkYXRhLnZlcnNpb24gfHwgIk4vQSI7CgogICAgdHJ5IHsKICAgICAgbWNwRWwudGV4dENvbnRlbnQgPSBKU09OLnN0cmluZ2lmeSh0aGlzLl90b29sRGF0YS5tY3BEZWZpbml0aW9uLCBudWxsLCAyKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgbWNwRWwudGV4dENvbnRlbnQgPSBgRXJyb3IgZGlzcGxheWluZyBNQ1AgSlNPTjogJHtlLm1lc3NhZ2V9XG5cbiR7dGhpcy5fdG9vbERhdGEubWNwRGVmaW5pdGlvbn1gOwogICAgICBtY3BFbC5zdHlsZS5jb2xvciA9ICJ2YXIoLS1lcnJvci1jb2xvciwgcmVkKSI7CiAgICB9CgogICAgY29uc3QgZXNjYXBlID0gVXRpbHM/LmVzY2FwZUh0bWwgfHwgKChzdHIpID0+IHN0cik7CiAgICBqc0VsLmlubmVySFRNTCA9IGVzY2FwZSh0aGlzLl90b29sRGF0YS5qc0ltcGxlbWVudGF0aW9uKTsKICB9CgogIGNvbm5lY3RlZENhbGxiYWNrKCkgewogICAgdGhpcy5zaGFkb3dSb290CiAgICAgIC5xdWVyeVNlbGVjdG9yKCIuZGVsZXRlLWJ1dHRvbiIpCiAgICAgIC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsKICAgICAgICBpZiAodGhpcy5fdG9vbERhdGEpIHsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgKICAgICAgICAgICAgbmV3IEN1c3RvbUV2ZW50KCJkZWxldGUtdG9vbCIsIHsKICAgICAgICAgICAgICBkZXRhaWw6IHsKICAgICAgICAgICAgICAgIHRvb2xJZDogdGhpcy5fdG9vbERhdGEuaWQsCiAgICAgICAgICAgICAgICB0b29sTmFtZTogdGhpcy5fdG9vbERhdGEubWV0YWRhdGEubmFtZSwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGJ1YmJsZXM6IHRydWUsCiAgICAgICAgICAgICAgY29tcG9zZWQ6IHRydWUsCiAgICAgICAgICAgIH0pCiAgICAgICAgICApOwogICAgICAgIH0KICAgICAgfSk7CgogICAgdGhpcy5zaGFkb3dSb290CiAgICAgIC5xdWVyeVNlbGVjdG9yKCIuZXhlY3V0ZS1idXR0b24iKQogICAgICAuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7CiAgICAgICAgaWYgKHRoaXMuX3Rvb2xEYXRhKSB7CiAgICAgICAgICBsZXQgYXJncyA9IHt9OwogICAgICAgICAgY29uc3QgcHJvcHMgPSB0aGlzLl90b29sRGF0YS5tY3BEZWZpbml0aW9uPy5pbnB1dFNjaGVtYT8ucHJvcGVydGllczsKICAgICAgICAgIGlmIChwcm9wcyAmJiBPYmplY3Qua2V5cyhwcm9wcykubGVuZ3RoID4gMCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGNvbnN0IGFyZ3NTdHJpbmcgPSBwcm9tcHQoCiAgICAgICAgICAgICAgICBgRW50ZXIgYXJndW1lbnRzIGFzIEpTT04gZm9yICR7CiAgICAgICAgICAgICAgICAgIHRoaXMuX3Rvb2xEYXRhLm1ldGFkYXRhLm5hbWUKICAgICAgICAgICAgICAgIH06XG4ke0pTT04uc3RyaW5naWZ5KAogICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhwcm9wcykKICAgICAgICAgICAgICAgICl9XG5FeGFtcGxlOiB7InBhcmFtMSI6ICJ2YWx1ZTEiLCAuLi59YAogICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgaWYgKGFyZ3NTdHJpbmcgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgYXJncyA9IGFyZ3NTdHJpbmcudHJpbSgpID8gSlNPTi5wYXJzZShhcmdzU3RyaW5nKSA6IHt9OyAvLyBIYW5kbGUgZW1wdHkgaW5wdXQgYXMgZW1wdHkgb2JqZWN0CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICBhbGVydChgSW52YWxpZCBKU09OIGlucHV0OiAke2UubWVzc2FnZX1gKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKAogICAgICAgICAgICAgIGBFeGVjdXRpbmcgJHt0aGlzLl90b29sRGF0YS5tZXRhZGF0YS5uYW1lfSB3aXRoIG5vIGFyZ3VtZW50cy5gCiAgICAgICAgICAgICk7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KAogICAgICAgICAgICBuZXcgQ3VzdG9tRXZlbnQoImV4ZWN1dGUtdG9vbCIsIHsKICAgICAgICAgICAgICBkZXRhaWw6IHsKICAgICAgICAgICAgICAgIHRvb2xJZDogdGhpcy5fdG9vbERhdGEuaWQsCiAgICAgICAgICAgICAgICB0b29sTmFtZTogdGhpcy5fdG9vbERhdGEubWV0YWRhdGEubmFtZSwKICAgICAgICAgICAgICAgIGFyZ3M6IGFyZ3MsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBidWJibGVzOiB0cnVlLAogICAgICAgICAgICAgIGNvbXBvc2VkOiB0cnVlLAogICAgICAgICAgICB9KQogICAgICAgICAgKTsKICAgICAgICB9CiAgICAgIH0pOwogIH0KfQoKZXhwb3J0IGRlZmF1bHQgVG9vbENhcmRDb21wb25lbnQ7Cg==
--- CATS_END_FILE ---

--- CATS_START_FILE: ui-manager.js ---
aW1wb3J0IFV0aWxzIGZyb20gIi4vdXRpbHMuanMiOwppbXBvcnQgVG9vbENhcmRDb21wb25lbnQgZnJvbSAiLi90b29sLWNhcmQud2MuanMiOwoKY29uc3QgVUlNYW5hZ2VyTW9kdWxlID0gKAogIGNvbmZpZywKICBsb2dnZXIsCiAgVXRpbHMsCiAgc3RvcmFnZSwKICBTdGF0ZU1hbmFnZXIsCiAgQ3ljbGVMb2dpYwopID0+IHsKICBpZiAoCiAgICAhY29uZmlnIHx8CiAgICAhbG9nZ2VyIHx8CiAgICAhVXRpbHMgfHwKICAgICFzdG9yYWdlIHx8CiAgICAhU3RhdGVNYW5hZ2VyIHx8CiAgICAhQ3ljbGVMb2dpYwogICkgewogICAgbG9nZ2VyPy5sb2dFdmVudCgiZXJyb3IiLCAiVUlNYW5hZ2VyIHJlcXVpcmVzIGFsbCBjb3JlIG1vZHVsZXMuIik7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGxldCB1aVJlZnMgPSB7fTsKICBsZXQgaXNJbml0aWFsaXplZCA9IGZhbHNlOwoKICBjb25zdCBnZXRSZWZzID0gKCkgPT4gewogICAgY29uc3QgaWRzID0gWwogICAgICAiYXBwLXZlcnNpb24iLAogICAgICAic3RvcmFnZS11c2FnZSIsCiAgICAgICJhcGkta2V5LWlucHV0IiwKICAgICAgInNhdmUtYXBpLWtleS1idXR0b24iLAogICAgICAiZXhwb3J0LXN0YXRlLWJ1dHRvbiIsCiAgICAgICJpbXBvcnQtc3RhdGUtYnV0dG9uIiwKICAgICAgImltcG9ydC1maWxlLWlucHV0IiwKICAgICAgImRvd25sb2FkLWxvZy1idXR0b24iLAogICAgICAiY2xlYXItc3RvcmFnZS1idXR0b24iLAogICAgICAic3RhdHVzLWluZGljYXRvciIsCiAgICAgICJ0b29sLXJlcXVlc3QtaW5wdXQiLAogICAgICAiY3JlYXRlLXRvb2wtYnV0dG9uIiwKICAgICAgInRvb2wtbGlzdC1jb250YWluZXIiLAogICAgICAibm90aWZpY2F0aW9ucy1jb250YWluZXIiLAogICAgICAibWFpbi1jb250ZW50IiwKICAgICAgImFwcC1yb290IiwKICAgIF07CiAgICBjb25zdCByZWZzID0ge307CiAgICBpZHMuZm9yRWFjaCgoaWQpID0+IHsKICAgICAgcmVmc1tpZC5yZXBsYWNlKC8tKFx3KS9nLCAobWF0Y2gsIHAxKSA9PiBwMS50b1VwcGVyQ2FzZSgpKV0gPQogICAgICAgIFV0aWxzLiRpZChpZCk7CiAgICB9KTsKCiAgICByZXR1cm4gcmVmczsKICB9OwoKICBjb25zdCB1cGRhdGVTdGF0dXMgPSAobWVzc2FnZSwgaXNBY3RpdmUgPSBmYWxzZSwgaXNFcnJvciA9IGZhbHNlKSA9PiB7CiAgICBpZiAodWlSZWZzLnN0YXR1c0luZGljYXRvcikgewogICAgICB1aVJlZnMuc3RhdHVzSW5kaWNhdG9yLnRleHRDb250ZW50ID0gYFN0YXR1czogJHttZXNzYWdlfWA7CiAgICAgIHVpUmVmcy5zdGF0dXNJbmRpY2F0b3Iuc3R5bGUuY29sb3IgPSBpc0Vycm9yCiAgICAgICAgPyAidmFyKC0tZXJyb3ItY29sb3IpIgogICAgICAgIDogaXNBY3RpdmUKICAgICAgICA/ICJ2YXIoLS13YXJuLWNvbG9yKSIKICAgICAgICA6ICIjYWFhIjsKICAgICAgdWlSZWZzLnN0YXR1c0luZGljYXRvci5zdHlsZS5mb250V2VpZ2h0ID0KICAgICAgICBpc0FjdGl2ZSB8fCBpc0Vycm9yID8gImJvbGQiIDogIm5vcm1hbCI7CiAgICB9CiAgfTsKCiAgY29uc3Qgc2hvd05vdGlmaWNhdGlvbiA9IChtZXNzYWdlLCB0eXBlID0gImluZm8iLCBkdXJhdGlvbiA9IDUwMDApID0+IHsKICAgIGlmICghdWlSZWZzLm5vdGlmaWNhdGlvbnNDb250YWluZXIpIHJldHVybjsKICAgIGNvbnN0IG5vdGlmaWNhdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgbm90aWZpY2F0aW9uLmNsYXNzTmFtZSA9IGBub3RpZmljYXRpb24gJHt0eXBlfWA7CiAgICBub3RpZmljYXRpb24udGV4dENvbnRlbnQgPSBtZXNzYWdlOwoKICAgIGNvbnN0IGNsb3NlQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7CiAgICBjbG9zZUJ1dHRvbi5pbm5lckhUTUwgPSAiJnRpbWVzOyI7CiAgICBjbG9zZUJ1dHRvbi5vbmNsaWNrID0gKCkgPT4gbm90aWZpY2F0aW9uLnJlbW92ZSgpOwogICAgbm90aWZpY2F0aW9uLmFwcGVuZENoaWxkKGNsb3NlQnV0dG9uKTsKCiAgICB1aVJlZnMubm90aWZpY2F0aW9uc0NvbnRhaW5lci5hcHBlbmRDaGlsZChub3RpZmljYXRpb24pOwoKICAgIGlmIChkdXJhdGlvbiA+IDApIHsKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5wYXJlbnRFbGVtZW50KSB7CiAgICAgICAgICAvLyBDaGVjayBpZiBzdGlsbCBhdHRhY2hlZAogICAgICAgICAgbm90aWZpY2F0aW9uLnJlbW92ZSgpOwogICAgICAgIH0KICAgICAgfSwgZHVyYXRpb24pOwogICAgfQogIH07CgogIGNvbnN0IHVwZGF0ZVN0b3JhZ2VVc2FnZURpc3BsYXkgPSAoKSA9PiB7CiAgICBpZiAodWlSZWZzLnN0b3JhZ2VVc2FnZSkgewogICAgICBjb25zdCB1c2FnZSA9IHN0b3JhZ2UuZ2V0U3RvcmFnZVVzYWdlKCk7CiAgICAgIGlmICh1c2FnZS51c2VkID49IDApIHsKICAgICAgICB1aVJlZnMuc3RvcmFnZVVzYWdlLnRleHRDb250ZW50ID0gYCR7KHVzYWdlLnVzZWQgLyAxMDI0KS50b0ZpeGVkKAogICAgICAgICAgMQogICAgICAgICl9S0IgKCR7dXNhZ2UucGVyY2VudC50b0ZpeGVkKDEpfSUpYDsKICAgICAgICBpZiAodXNhZ2UucGVyY2VudCA+IGNvbmZpZy5zdG9yYWdlUXVvdGFXYXJuVGhyZXNob2xkICogMTAwKSB7CiAgICAgICAgICB1aVJlZnMuc3RvcmFnZVVzYWdlLnN0eWxlLmNvbG9yID0gInZhcigtLXdhcm4tY29sb3IpIjsKICAgICAgICAgIHVpUmVmcy5zdG9yYWdlVXNhZ2Uuc3R5bGUuZm9udFdlaWdodCA9ICJib2xkIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdWlSZWZzLnN0b3JhZ2VVc2FnZS5zdHlsZS5jb2xvciA9ICJpbmhlcml0IjsKICAgICAgICAgIHVpUmVmcy5zdG9yYWdlVXNhZ2Uuc3R5bGUuZm9udFdlaWdodCA9ICJub3JtYWwiOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB1aVJlZnMuc3RvcmFnZVVzYWdlLnRleHRDb250ZW50ID0gYEVycm9yYDsKICAgICAgICB1aVJlZnMuc3RvcmFnZVVzYWdlLnN0eWxlLmNvbG9yID0gInZhcigtLWVycm9yLWNvbG9yKSI7CiAgICAgIH0KICAgIH0KICB9OwoKICBjb25zdCByZW5kZXJUb29sTGlzdCA9ICgpID0+IHsKICAgIGlmICghdWlSZWZzLnRvb2xMaXN0Q29udGFpbmVyKSByZXR1cm47CiAgICBjb25zdCB0b29scyA9IFN0YXRlTWFuYWdlci5saXN0VG9vbHMoKTsKICAgIHVpUmVmcy50b29sTGlzdENvbnRhaW5lci5pbm5lckhUTUwgPSAiIjsKCiAgICBpZiAodG9vbHMubGVuZ3RoID09PSAwKSB7CiAgICAgIHVpUmVmcy50b29sTGlzdENvbnRhaW5lci5pbm5lckhUTUwgPSAiPHA+Tm8gdG9vbHMgZ2VuZXJhdGVkIHlldC48L3A+IjsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRvb2xzLnNvcnQoKGEsIGIpID0+CiAgICAgIChhLm1ldGFkYXRhPy5uYW1lID8/ICIiKS5sb2NhbGVDb21wYXJlKGIubWV0YWRhdGE/Lm5hbWUgPz8gIiIpCiAgICApOwoKICAgIHRvb2xzLmZvckVhY2goKHRvb2xEYXRhKSA9PiB7CiAgICAgIGNvbnN0IHRvb2xDYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidG9vbC1jYXJkIik7CiAgICAgIHRvb2xDYXJkLnNldFRvb2xEYXRhKHRvb2xEYXRhKTsKCiAgICAgIHRvb2xDYXJkLmFkZEV2ZW50TGlzdGVuZXIoImRlbGV0ZS10b29sIiwgKGV2ZW50KSA9PiB7CiAgICAgICAgY29uc3QgdG9vbElkVG9EZWxldGUgPSBldmVudC5kZXRhaWwudG9vbElkOwogICAgICAgIGlmICgKICAgICAgICAgIGNvbmZpcm0oCiAgICAgICAgICAgIGBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoZSB0b29sICIke2V2ZW50LmRldGFpbC50b29sTmFtZX0iICgke3Rvb2xJZFRvRGVsZXRlfSk/IFRoaXMgY2Fubm90IGJlIHVuZG9uZS5gCiAgICAgICAgICApCiAgICAgICAgKSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBzdG9yYWdlLmRlbGV0ZUFydGlmYWN0KHRvb2xJZFRvRGVsZXRlLCAibWNwLmpzb24iKTsKICAgICAgICAgICAgc3RvcmFnZS5kZWxldGVBcnRpZmFjdCh0b29sSWRUb0RlbGV0ZSwgImltcGwuanMiKTsKCiAgICAgICAgICAgIGlmIChTdGF0ZU1hbmFnZXIuZGVsZXRlVG9vbCh0b29sSWRUb0RlbGV0ZSkpIHsKICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKAogICAgICAgICAgICAgICAgYFRvb2wgIiR7ZXZlbnQuZGV0YWlsLnRvb2xOYW1lfSIgZGVsZXRlZC5gLAogICAgICAgICAgICAgICAgInN1Y2Nlc3MiCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICByZW5kZXJUb29sTGlzdCgpOwogICAgICAgICAgICAgIHVwZGF0ZVN0b3JhZ2VVc2FnZURpc3BsYXkoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKAogICAgICAgICAgICAgICAgYEZhaWxlZCB0byBkZWxldGUgdG9vbCAiJHtldmVudC5kZXRhaWwudG9vbE5hbWV9IiBmcm9tIHN0YXRlLmAsCiAgICAgICAgICAgICAgICAiZXJyb3IiCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICBsb2dnZXIubG9nRXZlbnQoCiAgICAgICAgICAgICAgImVycm9yIiwKICAgICAgICAgICAgICBgRXJyb3IgZGVsZXRpbmcgdG9vbCAke3Rvb2xJZFRvRGVsZXRlfSBhcnRpZmFjdHMgb3Igc3RhdGUuYCwKICAgICAgICAgICAgICBlCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oYEVycm9yIGRlbGV0aW5nIHRvb2w6ICR7ZS5tZXNzYWdlfWAsICJlcnJvciIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CgogICAgICB0b29sQ2FyZC5hZGRFdmVudExpc3RlbmVyKCJleGVjdXRlLXRvb2wiLCBhc3luYyAoZXZlbnQpID0+IHsKICAgICAgICBjb25zdCB7IHRvb2xJZCwgdG9vbE5hbWUsIGFyZ3MgfSA9IGV2ZW50LmRldGFpbDsKICAgICAgICBjb25zdCB0b29sID0gU3RhdGVNYW5hZ2VyLmdldFRvb2wodG9vbElkKTsKICAgICAgICBpZiAodG9vbCAmJiBUb29sUnVubmVyKSB7CiAgICAgICAgICB1cGRhdGVTdGF0dXMoYEV4ZWN1dGluZyAke3Rvb2xOYW1lfS4uLmAsIHRydWUpOwogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgVG9vbFJ1bm5lci5ydW5Kc0ltcGxlbWVudGF0aW9uKAogICAgICAgICAgICAgIHRvb2wuanNJbXBsZW1lbnRhdGlvbiwKICAgICAgICAgICAgICBhcmdzCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oCiAgICAgICAgICAgICAgYFRvb2wgJHt0b29sTmFtZX0gZXhlY3V0ZWQuIFJlc3VsdDogJHtKU09OLnN0cmluZ2lmeShyZXN1bHQpfWAsCiAgICAgICAgICAgICAgImluZm8iLAogICAgICAgICAgICAgIDgwMDAKICAgICAgICAgICAgKTsKICAgICAgICAgICAgdXBkYXRlU3RhdHVzKCJJZGxlIik7CiAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oCiAgICAgICAgICAgICAgYFRvb2wgJHt0b29sTmFtZX0gZXhlY3V0aW9uIGZhaWxlZDogJHtlLm1lc3NhZ2V9YCwKICAgICAgICAgICAgICAiZXJyb3IiCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHVwZGF0ZVN0YXR1cyhgRXhlY3V0aW9uIGZhaWxlZGAsIGZhbHNlLCB0cnVlKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgc2hvd05vdGlmaWNhdGlvbigKICAgICAgICAgICAgYENvdWxkIG5vdCBmaW5kIHRvb2wgb3IgcnVubmVyIGZvciAke3Rvb2xOYW1lfS5gLAogICAgICAgICAgICAiZXJyb3IiCiAgICAgICAgICApOwogICAgICAgICAgbG9nZ2VyLmxvZ0V2ZW50KAogICAgICAgICAgICAiZXJyb3IiLAogICAgICAgICAgICBgRXhlY3V0ZSBmYWlsZWQ6IFRvb2wgZGF0YSBvciBydW5uZXIgbWlzc2luZyBmb3IgJHt0b29sSWR9YAogICAgICAgICAgKTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgdWlSZWZzLnRvb2xMaXN0Q29udGFpbmVyLmFwcGVuZENoaWxkKHRvb2xDYXJkKTsKICAgIH0pOwogIH07CgogIGNvbnN0IHNldHVwRXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7CiAgICB1aVJlZnMuc2F2ZUFwaUtleUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7CiAgICAgIGNvbnN0IGtleSA9IHVpUmVmcy5hcGlLZXlJbnB1dD8udmFsdWUudHJpbSgpID8/ICIiOwogICAgICBTdGF0ZU1hbmFnZXIuc2V0QXBpS2V5KGtleSk7CiAgICAgIFN0YXRlTWFuYWdlci5zYXZlU3RhdGUoKTsKICAgICAgc2hvd05vdGlmaWNhdGlvbihrZXkgPyAiQVBJIEtleSBzYXZlZC4iIDogIkFQSSBLZXkgY2xlYXJlZC4iLCAiaW5mbyIpOwogICAgfSk7CgogICAgdWlSZWZzLmNyZWF0ZVRvb2xCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgYXN5bmMgKCkgPT4gewogICAgICBjb25zdCByZXF1ZXN0ID0gdWlSZWZzLnRvb2xSZXF1ZXN0SW5wdXQ/LnZhbHVlLnRyaW0oKSA/PyAiIjsKICAgICAgaWYgKCFyZXF1ZXN0KSB7CiAgICAgICAgc2hvd05vdGlmaWNhdGlvbigiUGxlYXNlIGVudGVyIGEgZGVzY3JpcHRpb24gZm9yIHRoZSB0b29sLiIsICJ3YXJuIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICghU3RhdGVNYW5hZ2VyLmdldFN0YXRlKCk/LmFwaUtleSkgewogICAgICAgIHNob3dOb3RpZmljYXRpb24oIlBsZWFzZSBzZXQgeW91ciBHZW1pbmkgQVBJIEtleSBmaXJzdC4iLCAid2FybiIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdWlSZWZzLmNyZWF0ZVRvb2xCdXR0b24uZGlzYWJsZWQgPSB0cnVlOwogICAgICB1aVJlZnMuY3JlYXRlVG9vbEJ1dHRvbi50ZXh0Q29udGVudCA9ICJHZW5lcmF0aW5nLi4uIjsKICAgICAgdXBkYXRlU3RhdHVzKCJHZW5lcmF0aW5nIHRvb2wuLi4iLCB0cnVlKTsKCiAgICAgIGNvbnN0IHByb2dyZXNzQ2FsbGJhY2sgPSAodHlwZSwgZGF0YSkgPT4gewogICAgICAgIGxvZ2dlci5sb2dFdmVudCgiZGVidWciLCBgR2VuZXJhdGlvbiBQcm9ncmVzcyAtIFR5cGU6ICR7dHlwZX1gLCBkYXRhKTsKICAgICAgICBpZiAodHlwZSA9PT0gInN0YXR1cyIpIHsKICAgICAgICAgIHVwZGF0ZVN0YXR1cyhkYXRhLm1lc3NhZ2UsIGRhdGEuYWN0aXZlLCBkYXRhLmlzRXJyb3IpOwogICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gImVycm9yIikgewogICAgICAgICAgc2hvd05vdGlmaWNhdGlvbihgR2VuZXJhdGlvbiBFcnJvcjogJHtkYXRhLm1lc3NhZ2V9YCwgImVycm9yIik7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAic3VjY2VzcyIpIHsKICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oCiAgICAgICAgICAgIGBUb29sICIke2RhdGEudG9vbD8ubWV0YWRhdGE/Lm5hbWV9IiBnZW5lcmF0ZWQgc3VjY2Vzc2Z1bGx5IWAsCiAgICAgICAgICAgICJzdWNjZXNzIgogICAgICAgICAgKTsKICAgICAgICAgIHJlbmRlclRvb2xMaXN0KCk7CiAgICAgICAgICBpZiAodWlSZWZzLnRvb2xSZXF1ZXN0SW5wdXQpIHVpUmVmcy50b29sUmVxdWVzdElucHV0LnZhbHVlID0gIiI7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAiZmluYWwiKSB7CiAgICAgICAgICB1aVJlZnMuY3JlYXRlVG9vbEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgdWlSZWZzLmNyZWF0ZVRvb2xCdXR0b24udGV4dENvbnRlbnQgPSAiR2VuZXJhdGUgVG9vbCI7CiAgICAgICAgICB1cGRhdGVTdG9yYWdlVXNhZ2VEaXNwbGF5KCk7CiAgICAgICAgfQogICAgICB9OwoKICAgICAgYXdhaXQgQ3ljbGVMb2dpYy5nZW5lcmF0ZVRvb2wocmVxdWVzdCwgcHJvZ3Jlc3NDYWxsYmFjayk7CiAgICB9KTsKCiAgICB1aVJlZnMuZXhwb3J0U3RhdGVCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHN0YXRlVG9FeHBvcnQgPSBTdGF0ZU1hbmFnZXIuZ2V0U3RhdGUoKTsKICAgICAgICBpZiAoIXN0YXRlVG9FeHBvcnQpIHsKICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oIkNhbm5vdCBleHBvcnQ6IFN0YXRlIG5vdCBhdmFpbGFibGUuIiwgIndhcm4iKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgY29uc3QgZGF0YVN0ciA9IEpTT04uc3RyaW5naWZ5KHN0YXRlVG9FeHBvcnQsIG51bGwsIDIpOwogICAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbZGF0YVN0cl0sIHsgdHlwZTogImFwcGxpY2F0aW9uL2pzb24iIH0pOwogICAgICAgIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7CiAgICAgICAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTsKICAgICAgICBhLmhyZWYgPSB1cmw7CiAgICAgICAgYS5kb3dubG9hZCA9IGByZXBsb2lkLXYyLXN0YXRlXyR7CiAgICAgICAgICBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoIlQiKVswXQogICAgICAgIH0uanNvbmA7CiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTsKICAgICAgICBhLmNsaWNrKCk7CiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChhKTsKICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7CiAgICAgICAgc2hvd05vdGlmaWNhdGlvbigiU3RhdGUgZXhwb3J0ZWQuIiwgImluZm8iKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGxvZ2dlci5sb2dFdmVudCgiZXJyb3IiLCAiU3RhdGUgZXhwb3J0IGZhaWxlZCIsIGUpOwogICAgICAgIHNob3dOb3RpZmljYXRpb24oYFN0YXRlIGV4cG9ydCBmYWlsZWQ6ICR7ZS5tZXNzYWdlfWAsICJlcnJvciIpOwogICAgICB9CiAgICB9KTsKCiAgICB1aVJlZnMuaW1wb3J0U3RhdGVCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gewogICAgICB1aVJlZnMuaW1wb3J0RmlsZUlucHV0Py5jbGljaygpOwogICAgfSk7CgogICAgdWlSZWZzLmltcG9ydEZpbGVJbnB1dD8uYWRkRXZlbnRMaXN0ZW5lcigiY2hhbmdlIiwgKGV2ZW50KSA9PiB7CiAgICAgIGNvbnN0IGZpbGUgPSBldmVudC50YXJnZXQuZmlsZXM/LlswXTsKICAgICAgaWYgKCFmaWxlKSByZXR1cm47CiAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgIHJlYWRlci5vbmxvYWQgPSAoZSkgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICBpZiAoIWUudGFyZ2V0Py5yZXN1bHQpCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiRmlsZSBjb250ZW50IGlzIGVtcHR5IG9yIHVucmVhZGFibGUuIik7CiAgICAgICAgICBjb25zdCBpbXBvcnRlZFN0YXRlID0gSlNPTi5wYXJzZShlLnRhcmdldC5yZXN1bHQpOwoKICAgICAgICAgIGlmICgKICAgICAgICAgICAgaW1wb3J0ZWRTdGF0ZSAmJgogICAgICAgICAgICB0eXBlb2YgaW1wb3J0ZWRTdGF0ZSA9PT0gIm9iamVjdCIgJiYKICAgICAgICAgICAgaW1wb3J0ZWRTdGF0ZS52ZXJzaW9uCiAgICAgICAgICApIHsKICAgICAgICAgICAgaWYgKGltcG9ydGVkU3RhdGUudmVyc2lvbiAhPT0gY29uZmlnLnZlcnNpb24pIHsKICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKAogICAgICAgICAgICAgICAgYEltcG9ydCBmYWlsZWQ6IFZlcnNpb24gbWlzbWF0Y2ggKEZpbGU6ICR7aW1wb3J0ZWRTdGF0ZS52ZXJzaW9ufSwgQXBwOiAke2NvbmZpZy52ZXJzaW9ufSlgLAogICAgICAgICAgICAgICAgImVycm9yIgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgU3RhdGVNYW5hZ2VyLnVwZGF0ZVN0YXRlKGltcG9ydGVkU3RhdGUpOwogICAgICAgICAgICAgIFN0YXRlTWFuYWdlci5zYXZlU3RhdGUoKTsKCiAgICAgICAgICAgICAgaWYgKHVpUmVmcy5hcGlLZXlJbnB1dCkKICAgICAgICAgICAgICAgIHVpUmVmcy5hcGlLZXlJbnB1dC52YWx1ZSA9IGltcG9ydGVkU3RhdGUuYXBpS2V5IHx8ICIiOwogICAgICAgICAgICAgIHJlbmRlclRvb2xMaXN0KCk7CiAgICAgICAgICAgICAgdXBkYXRlU3RvcmFnZVVzYWdlRGlzcGxheSgpOwogICAgICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oIlN0YXRlIGltcG9ydGVkIHN1Y2Nlc3NmdWxseS4iLCAic3VjY2VzcyIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgc3RhdGUgZmlsZSBmb3JtYXQuIik7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBsb2dnZXIubG9nRXZlbnQoImVycm9yIiwgIlN0YXRlIGltcG9ydCBmYWlsZWQiLCBlcnIpOwogICAgICAgICAgc2hvd05vdGlmaWNhdGlvbihgSW1wb3J0IGZhaWxlZDogJHtlcnIubWVzc2FnZX1gLCAiZXJyb3IiKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgaWYgKHVpUmVmcy5pbXBvcnRGaWxlSW5wdXQpIHVpUmVmcy5pbXBvcnRGaWxlSW5wdXQudmFsdWUgPSAiIjsKICAgICAgICB9CiAgICAgIH07CiAgICAgIHJlYWRlci5vbmVycm9yID0gKGUpID0+IHsKICAgICAgICBsb2dnZXIubG9nRXZlbnQoImVycm9yIiwgIkZpbGUgcmVhZGluZyBlcnJvciBkdXJpbmcgaW1wb3J0IiwgZSk7CiAgICAgICAgc2hvd05vdGlmaWNhdGlvbigiRmFpbGVkIHRvIHJlYWQgdGhlIHNlbGVjdGVkIGZpbGUuIiwgImVycm9yIik7CiAgICAgICAgaWYgKHVpUmVmcy5pbXBvcnRGaWxlSW5wdXQpIHVpUmVmcy5pbXBvcnRGaWxlSW5wdXQudmFsdWUgPSAiIjsKICAgICAgfTsKICAgICAgcmVhZGVyLnJlYWRBc1RleHQoZmlsZSk7CiAgICB9KTsKCiAgICB1aVJlZnMuZG93bmxvYWRMb2dCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gewogICAgICB0cnkgewogICAgICAgIGNvbnN0IGxvZ0RhdGEgPSBsb2dnZXIuZ2V0TG9nQnVmZmVyKCk7CiAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtsb2dEYXRhXSwgeyB0eXBlOiAidGV4dC9wbGFpbiIgfSk7CiAgICAgICAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgICAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwogICAgICAgIGEuaHJlZiA9IHVybDsKICAgICAgICBhLmRvd25sb2FkID0gYHJlcGxvaWQtdjItbG9nXyR7bmV3IERhdGUoKQogICAgICAgICAgLnRvSVNPU3RyaW5nKCkKICAgICAgICAgIC5yZXBsYWNlKC9bOi5dL2csICItIil9LnR4dGA7CiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTsKICAgICAgICBhLmNsaWNrKCk7CiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChhKTsKICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBsb2dnZXIubG9nRXZlbnQoImVycm9yIiwgIkxvZyBkb3dubG9hZCBmYWlsZWQiLCBlKTsKICAgICAgICBzaG93Tm90aWZpY2F0aW9uKGBMb2cgZG93bmxvYWQgZmFpbGVkOiAke2UubWVzc2FnZX1gLCAiZXJyb3IiKTsKICAgICAgfQogICAgfSk7CgogICAgdWlSZWZzLmNsZWFyU3RvcmFnZUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7CiAgICAgIGlmICgKICAgICAgICBjb25maXJtKAogICAgICAgICAgIldBUk5JTkc6IFRoaXMgd2lsbCBkZWxldGUgQUxMIFJlcGxvaWQgdjIgZGF0YSAoc3RhdGUgYW5kIGdlbmVyYXRlZCB0b29scykgZnJvbSB5b3VyIGJyb3dzZXIuIEFyZSB5b3Ugc3VyZT8iCiAgICAgICAgKQogICAgICApIHsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgY291bnQgPSBzdG9yYWdlLmNsZWFyQWxsUmVwbG9pZERhdGEoKTsKICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oCiAgICAgICAgICAgIGBDbGVhcmVkICR7Y291bnR9IGl0ZW1zIGZyb20gc3RvcmFnZS4gUmVsb2FkaW5nLi4uYCwKICAgICAgICAgICAgIndhcm4iLAogICAgICAgICAgICAzMDAwCiAgICAgICAgICApOwogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCksIDE1MDApOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIGxvZ2dlci5sb2dFdmVudCgiZXJyb3IiLCAiRmFpbGVkIHRvIGNsZWFyIHN0b3JhZ2UiLCBlKTsKICAgICAgICAgIHNob3dOb3RpZmljYXRpb24oYEZhaWxlZCB0byBjbGVhciBzdG9yYWdlOiAke2UubWVzc2FnZX1gLCAiZXJyb3IiKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogIH07CgogIGNvbnN0IGluaXQgPSBhc3luYyAoKSA9PiB7CiAgICBpZiAoaXNJbml0aWFsaXplZCkgcmV0dXJuOwogICAgbG9nZ2VyLmxvZ0V2ZW50KCJpbmZvIiwgIkluaXRpYWxpemluZyBVSU1hbmFnZXIuLi4iKTsKCiAgICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCgidG9vbC1jYXJkIikpIHsKICAgICAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKCJ0b29sLWNhcmQiLCBUb29sQ2FyZENvbXBvbmVudCk7CiAgICAgIGxvZ2dlci5sb2dFdmVudCgiZGVidWciLCAiUmVnaXN0ZXJlZCB0b29sLWNhcmQgV2ViIENvbXBvbmVudC4iKTsKICAgIH0gZWxzZSB7CiAgICAgIGxvZ2dlci5sb2dFdmVudCgiZGVidWciLCAidG9vbC1jYXJkIFdlYiBDb21wb25lbnQgYWxyZWFkeSByZWdpc3RlcmVkLiIpOwogICAgfQoKICAgIHVpUmVmcyA9IGdldFJlZnMoKTsKCiAgICB0cnkgewogICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCJ1aS1ib2R5Lmh0bWwiKTsKICAgICAgaWYgKCFyZXNwb25zZS5vaykKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBmZXRjaCB1aS1ib2R5Lmh0bWw6ICR7cmVzcG9uc2Uuc3RhdHVzfWApOwogICAgICBjb25zdCB1aUh0bWwgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7CgogICAgICBjb25zdCBhcHBSb290ID0gdWlSZWZzLmFwcFJvb3QgfHwgVXRpbHMuJGlkKCJhcHAtcm9vdCIpOwogICAgICBpZiAoYXBwUm9vdCkgewogICAgICAgIGFwcFJvb3QuaW5uZXJIVE1MID0gdWlIdG1sOwogICAgICAgIHVpUmVmcyA9IGdldFJlZnMoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoCiAgICAgICAgICAiQXBwIHJvb3QgY29udGFpbmVyICgjYXBwLXJvb3QpIG5vdCBmb3VuZCBpbiBpbmRleC5odG1sIgogICAgICAgICk7CiAgICAgIH0KICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgbG9nZ2VyLmxvZ0V2ZW50KCJlcnJvciIsICJGYWlsZWQgdG8gbG9hZCBtYWluIFVJIGJvZHkiLCBlKTsKICAgICAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSBgPGRpdiBzdHlsZT0nY29sb3I6cmVkJz48aDE+VUkgTG9hZCBFcnJvcjwvaDE+PHA+JHtlLm1lc3NhZ2V9PC9wPjwvZGl2PmA7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBpbml0aWFsU3RhdGUgPSBTdGF0ZU1hbmFnZXIuZ2V0U3RhdGUoKTsKICAgIGlmIChpbml0aWFsU3RhdGUgJiYgdWlSZWZzLmFwaUtleUlucHV0KSB7CiAgICAgIHVpUmVmcy5hcGlLZXlJbnB1dC52YWx1ZSA9IGluaXRpYWxTdGF0ZS5hcGlLZXkgfHwgIiI7CiAgICB9CiAgICBpZiAodWlSZWZzLmFwcFZlcnNpb24pIHsKICAgICAgdWlSZWZzLmFwcFZlcnNpb24udGV4dENvbnRlbnQgPSBjb25maWcudmVyc2lvbjsKICAgIH0KCiAgICB1cGRhdGVTdG9yYWdlVXNhZ2VEaXNwbGF5KCk7CiAgICByZW5kZXJUb29sTGlzdCgpOwogICAgc2V0dXBFdmVudExpc3RlbmVycygpOwogICAgdXBkYXRlU3RhdHVzKCJJbml0aWFsaXplZCIpOwoKICAgIGlzSW5pdGlhbGl6ZWQgPSB0cnVlOwogICAgbG9nZ2VyLmxvZ0V2ZW50KCJpbmZvIiwgIlVJTWFuYWdlciBpbml0aWFsaXplZC4iKTsKICB9OwoKICByZXR1cm4gewogICAgaW5pdCwKICAgIHNob3dOb3RpZmljYXRpb24sCiAgICB1cGRhdGVTdGF0dXMsCiAgICByZW5kZXJUb29sTGlzdCwKICAgIHVwZGF0ZVN0b3JhZ2VVc2FnZURpc3BsYXksCiAgfTsKfTsKCmV4cG9ydCBkZWZhdWx0IFVJTWFuYWdlck1vZHVsZTsK
--- CATS_END_FILE ---

--- CATS_START_FILE: mcp-converter.js ---
Y29uc3QgTUNQQ29udmVydGVyTW9kdWxlID0gKGNvbmZpZywgbG9nZ2VyKSA9PiB7CiAgaWYgKCFjb25maWcgfHwgIWxvZ2dlcikgewogICAgY29uc29sZS5lcnJvcigiTUNQQ29udmVydGVyTW9kdWxlIHJlcXVpcmVzIGNvbmZpZyBhbmQgbG9nZ2VyLiIpOwogICAgcmV0dXJuIG51bGw7CiAgfQoKICBjb25zdCBtYXBNY3BUeXBlVG9HZW1pbmkgPSAobWNwVHlwZSkgPT4gewogICAgc3dpdGNoIChtY3BUeXBlPy50b0xvd2VyQ2FzZSgpKSB7CiAgICAgIGNhc2UgInN0cmluZyI6CiAgICAgICAgcmV0dXJuICJTVFJJTkciOwogICAgICBjYXNlICJpbnRlZ2VyIjoKICAgICAgICByZXR1cm4gIklOVEVHRVIiOwogICAgICBjYXNlICJudW1iZXIiOgogICAgICAgIHJldHVybiAiTlVNQkVSIjsKICAgICAgY2FzZSAiYm9vbGVhbiI6CiAgICAgICAgcmV0dXJuICJCT09MRUFOIjsKICAgICAgY2FzZSAiYXJyYXkiOgogICAgICAgIHJldHVybiAiQVJSQVkiOwogICAgICBjYXNlICJvYmplY3QiOgogICAgICAgIHJldHVybiAiT0JKRUNUIjsKICAgICAgZGVmYXVsdDoKICAgICAgICBsb2dnZXIubG9nRXZlbnQoCiAgICAgICAgICAid2FybiIsCiAgICAgICAgICBgVW5zdXBwb3J0ZWQgTUNQIHR5cGUgZW5jb3VudGVyZWQgZHVyaW5nIGNvbnZlcnNpb246ICR7bWNwVHlwZX0uIE1hcHBpbmcgdG8gU1RSSU5HLmAKICAgICAgICApOwogICAgICAgIHJldHVybiAiU1RSSU5HIjsKICAgIH0KICB9OwoKICBjb25zdCBjb252ZXJ0TWNwUHJvcGVydGllcyA9IChtY3BQcm9wcykgPT4gewogICAgaWYgKCFtY3BQcm9wcyB8fCB0eXBlb2YgbWNwUHJvcHMgIT09ICJvYmplY3QiKSByZXR1cm4ge307CiAgICBjb25zdCBnZW1pbmlQcm9wcyA9IHt9OwogICAgZm9yIChjb25zdCBrZXkgaW4gbWNwUHJvcHMpIHsKICAgICAgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1jcFByb3BzLCBrZXkpKSB7CiAgICAgICAgaWYgKGtleSA9PT0gIiRzY2hlbWEiIHx8IGtleSA9PT0gImFkZGl0aW9uYWxQcm9wZXJ0aWVzIikgY29udGludWU7CgogICAgICAgIGNvbnN0IG1jcFByb3AgPSBtY3BQcm9wc1trZXldOwogICAgICAgIGlmICghbWNwUHJvcCB8fCB0eXBlb2YgbWNwUHJvcCAhPT0gIm9iamVjdCIpIHsKICAgICAgICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgICAgICAgIndhcm4iLAogICAgICAgICAgICBgU2tpcHBpbmcgaW52YWxpZCBNQ1AgcHJvcGVydHkgZGVmaW5pdGlvbiBmb3Iga2V5OiAke2tleX1gCiAgICAgICAgICApOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBnZW1pbmlQcm9wc1trZXldID0gewogICAgICAgICAgdHlwZTogbWFwTWNwVHlwZVRvR2VtaW5pKG1jcFByb3AudHlwZSksCiAgICAgICAgICBkZXNjcmlwdGlvbjogbWNwUHJvcC5kZXNjcmlwdGlvbiB8fCBgUGFyYW1ldGVyICR7a2V5fWAsCiAgICAgICAgfTsKICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShtY3BQcm9wLmVudW0pICYmIG1jcFByb3AuZW51bS5sZW5ndGggPiAwKSB7CiAgICAgICAgICBnZW1pbmlQcm9wc1trZXldLmVudW0gPSBtY3BQcm9wLmVudW07CiAgICAgICAgfQogICAgICAgIGlmICgKICAgICAgICAgIG1jcFByb3AudHlwZSA9PT0gImFycmF5IiAmJgogICAgICAgICAgbWNwUHJvcC5pdGVtcyAmJgogICAgICAgICAgdHlwZW9mIG1jcFByb3AuaXRlbXMgPT09ICJvYmplY3QiCiAgICAgICAgKSB7CiAgICAgICAgICBpZiAobWNwUHJvcC5pdGVtcy50eXBlKSB7CiAgICAgICAgICAgIGdlbWluaVByb3BzW2tleV0uaXRlbXMgPSB7CiAgICAgICAgICAgICAgdHlwZTogbWFwTWNwVHlwZVRvR2VtaW5pKG1jcFByb3AuaXRlbXMudHlwZSksCiAgICAgICAgICAgIH07CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsb2dnZXIubG9nRXZlbnQoCiAgICAgICAgICAgICAgIndhcm4iLAogICAgICAgICAgICAgIGBNQ1AgYXJyYXkgcHJvcGVydHkgJyR7a2V5fScgaGFzIGl0ZW1zIGRlZmluaXRpb24gd2l0aG91dCBhICd0eXBlJy4gU2tpcHBpbmcgaXRlbXMgY29udmVyc2lvbi5gCiAgICAgICAgICAgICk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAobWNwUHJvcC50eXBlID09PSAib2JqZWN0IiAmJiBtY3BQcm9wLnByb3BlcnRpZXMpIHsKICAgICAgICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgICAgICAgIndhcm4iLAogICAgICAgICAgICBgTUNQIHByb3BlcnR5ICcke2tleX0nIGlzIGEgbmVzdGVkIG9iamVjdC4gR2VtaW5pIEZ1bmN0aW9uRGVjbGFyYXRpb24gcGFyYW1ldGVycyBnZW5lcmFsbHkgZXhwZWN0IGEgZmxhdCBzdHJ1Y3R1cmUuIENvbnZlcnNpb24gbWlnaHQgYmUgcGFydGlhbCBvciBpbmFjY3VyYXRlLmAKICAgICAgICAgICk7CgogICAgICAgICAgZ2VtaW5pUHJvcHNba2V5XS5wcm9wZXJ0aWVzID0gY29udmVydE1jcFByb3BlcnRpZXMoCiAgICAgICAgICAgIG1jcFByb3AucHJvcGVydGllcwogICAgICAgICAgKTsKICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KG1jcFByb3AucmVxdWlyZWQpKSB7CiAgICAgICAgICAgIGdlbWluaVByb3BzW2tleV0ucmVxdWlyZWQgPSBtY3BQcm9wLnJlcXVpcmVkOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIGdlbWluaVByb3BzOwogIH07CgogIGNvbnN0IG1jcFRvR2VtaW5pRnVuY3Rpb25EZWNsYXJhdGlvbiA9IChtY3BEZWZpbml0aW9uKSA9PiB7CiAgICBpZiAoIW1jcERlZmluaXRpb24gfHwgdHlwZW9mIG1jcERlZmluaXRpb24gIT09ICJvYmplY3QiKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiSW52YWxpZCBNQ1AgZGVmaW5pdGlvbiBvYmplY3QgcHJvdmlkZWQgZm9yIGNvbnZlcnNpb24uIik7CiAgICB9CiAgICBpZiAoIW1jcERlZmluaXRpb24ubmFtZSB8fCB0eXBlb2YgbWNwRGVmaW5pdGlvbi5uYW1lICE9PSAic3RyaW5nIikgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIk1DUCBkZWZpbml0aW9uIG11c3QgaGF2ZSBhIHZhbGlkICduYW1lJyBzdHJpbmcuIik7CiAgICB9CiAgICBpZiAoCiAgICAgICFtY3BEZWZpbml0aW9uLmlucHV0U2NoZW1hIHx8CiAgICAgIHR5cGVvZiBtY3BEZWZpbml0aW9uLmlucHV0U2NoZW1hICE9PSAib2JqZWN0IgogICAgKSB7CiAgICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgICAid2FybiIsCiAgICAgICAgYE1DUCBkZWZpbml0aW9uIGZvciAnJHttY3BEZWZpbml0aW9uLm5hbWV9JyBtaXNzaW5nIG9yIGhhcyBpbnZhbGlkICdpbnB1dFNjaGVtYScuIENyZWF0aW5nIGRlY2xhcmF0aW9uIHdpdGggbm8gcGFyYW1ldGVycy5gCiAgICAgICk7CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogbWNwRGVmaW5pdGlvbi5uYW1lLAogICAgICAgIGRlc2NyaXB0aW9uOgogICAgICAgICAgbWNwRGVmaW5pdGlvbi5kZXNjcmlwdGlvbiB8fCBgRnVuY3Rpb24gJHttY3BEZWZpbml0aW9uLm5hbWV9YCwKICAgICAgICBwYXJhbWV0ZXJzOiB7IHR5cGU6ICJPQkpFQ1QiLCBwcm9wZXJ0aWVzOiB7fSB9LAogICAgICB9OwogICAgfQoKICAgIGlmIChtY3BEZWZpbml0aW9uLmlucHV0U2NoZW1hLnR5cGU/LnRvTG93ZXJDYXNlKCkgIT09ICJvYmplY3QiKSB7CiAgICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgICAid2FybiIsCiAgICAgICAgYE1DUCBpbnB1dFNjaGVtYSB0eXBlIGZvciAnJHttY3BEZWZpbml0aW9uLm5hbWV9JyBpcyBub3QgJ29iamVjdCcgKCR7bWNwRGVmaW5pdGlvbi5pbnB1dFNjaGVtYS50eXBlfSkuIEZvcmNpbmcgdG8gT0JKRUNUIGZvciBHZW1pbmkgY29tcGF0aWJpbGl0eS5gCiAgICAgICk7CiAgICB9CgogICAgY29uc3QgZ2VtaW5pUGFyYW1ldGVycyA9IHsKICAgICAgdHlwZTogIk9CSkVDVCIsCiAgICAgIHByb3BlcnRpZXM6IGNvbnZlcnRNY3BQcm9wZXJ0aWVzKG1jcERlZmluaXRpb24uaW5wdXRTY2hlbWEucHJvcGVydGllcyksCiAgICAgIHJlcXVpcmVkOiBBcnJheS5pc0FycmF5KG1jcERlZmluaXRpb24uaW5wdXRTY2hlbWEucmVxdWlyZWQpCiAgICAgICAgPyBtY3BEZWZpbml0aW9uLmlucHV0U2NoZW1hLnJlcXVpcmVkCiAgICAgICAgOiBbXSwKICAgIH07CgogICAgaWYgKAogICAgICBPYmplY3Qua2V5cyhnZW1pbmlQYXJhbWV0ZXJzLnByb3BlcnRpZXMpLmxlbmd0aCA9PT0gMCAmJgogICAgICBnZW1pbmlQYXJhbWV0ZXJzLnJlcXVpcmVkLmxlbmd0aCA9PT0gMAogICAgKSB7CiAgICB9IGVsc2UgewogICAgICBnZW1pbmlQYXJhbWV0ZXJzLnJlcXVpcmVkID0gZ2VtaW5pUGFyYW1ldGVycy5yZXF1aXJlZC5maWx0ZXIoKHJlcUtleSkgPT4KICAgICAgICBnZW1pbmlQYXJhbWV0ZXJzLnByb3BlcnRpZXMuaGFzT3duUHJvcGVydHkocmVxS2V5KQogICAgICApOwogICAgfQoKICAgIGNvbnN0IGdlbWluaURlY2xhcmF0aW9uID0gewogICAgICBuYW1lOiBtY3BEZWZpbml0aW9uLm5hbWUsCiAgICAgIGRlc2NyaXB0aW9uOgogICAgICAgIG1jcERlZmluaXRpb24uZGVzY3JpcHRpb24gfHwgYEZ1bmN0aW9uICR7bWNwRGVmaW5pdGlvbi5uYW1lfWAsCiAgICAgIHBhcmFtZXRlcnM6IGdlbWluaVBhcmFtZXRlcnMsCiAgICB9OwoKICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgImRlYnVnIiwKICAgICAgYENvbnZlcnRlZCBNQ1AgdG9vbCAnJHttY3BEZWZpbml0aW9uLm5hbWV9JyB0byBHZW1pbmkgRnVuY3Rpb25EZWNsYXJhdGlvbi5gCiAgICApOwogICAgcmV0dXJuIGdlbWluaURlY2xhcmF0aW9uOwogIH07CgogIGNvbnN0IGdlbWluaVRvTWNwRnVuY3Rpb25EZWZpbml0aW9uID0gKGdlbWluaURlY2xhcmF0aW9uKSA9PiB7CiAgICBsb2dnZXIubG9nRXZlbnQoCiAgICAgICJ3YXJuIiwKICAgICAgIkNvbnZlcnNpb24gZnJvbSBHZW1pbmkgRnVuY3Rpb25EZWNsYXJhdGlvbiBiYWNrIHRvIE1DUCBpcyBub3QgZnVsbHkgaW1wbGVtZW50ZWQuIgogICAgKTsKCiAgICBpZiAoIWdlbWluaURlY2xhcmF0aW9uIHx8ICFnZW1pbmlEZWNsYXJhdGlvbi5uYW1lKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigKICAgICAgICAiSW52YWxpZCBHZW1pbmkgZGVjbGFyYXRpb24gcHJvdmlkZWQgZm9yIGNvbnZlcnNpb24gYmFjayB0byBNQ1AuIgogICAgICApOwogICAgfQogICAgY29uc3QgbWFwR2VtaW5pVHlwZVRvTWNwID0gKGdlbWluaVR5cGUpID0+IHsKICAgICAgc3dpdGNoIChnZW1pbmlUeXBlKSB7CiAgICAgICAgY2FzZSAiU1RSSU5HIjoKICAgICAgICAgIHJldHVybiAic3RyaW5nIjsKICAgICAgICBjYXNlICJJTlRFR0VSIjoKICAgICAgICAgIHJldHVybiAiaW50ZWdlciI7CiAgICAgICAgY2FzZSAiTlVNQkVSIjoKICAgICAgICAgIHJldHVybiAibnVtYmVyIjsKICAgICAgICBjYXNlICJCT09MRUFOIjoKICAgICAgICAgIHJldHVybiAiYm9vbGVhbiI7CiAgICAgICAgY2FzZSAiQVJSQVkiOgogICAgICAgICAgcmV0dXJuICJhcnJheSI7CiAgICAgICAgY2FzZSAiT0JKRUNUIjoKICAgICAgICAgIHJldHVybiAib2JqZWN0IjsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgcmV0dXJuICJzdHJpbmciOwogICAgICB9CiAgICB9OwoKICAgIGNvbnN0IGNvbnZlcnRHZW1pbmlQcm9wZXJ0aWVzID0gKGdlbWluaVByb3BzKSA9PiB7CiAgICAgIGlmICghZ2VtaW5pUHJvcHMpIHJldHVybiB7fTsKICAgICAgY29uc3QgbWNwUHJvcHMgPSB7fTsKICAgICAgZm9yIChjb25zdCBrZXkgaW4gZ2VtaW5pUHJvcHMpIHsKICAgICAgICBjb25zdCBnZW1pbmlQcm9wID0gZ2VtaW5pUHJvcHNba2V5XTsKICAgICAgICBtY3BQcm9wc1trZXldID0gewogICAgICAgICAgdHlwZTogbWFwR2VtaW5pVHlwZVRvTWNwKGdlbWluaVByb3AudHlwZSksCiAgICAgICAgICBkZXNjcmlwdGlvbjogZ2VtaW5pUHJvcC5kZXNjcmlwdGlvbiB8fCAiIiwKICAgICAgICB9OwogICAgICAgIGlmIChnZW1pbmlQcm9wLmVudW0pIG1jcFByb3BzW2tleV0uZW51bSA9IGdlbWluaVByb3AuZW51bTsKICAgICAgfQogICAgICByZXR1cm4gbWNwUHJvcHM7CiAgICB9OwoKICAgIGNvbnN0IG1jcERlZmluaXRpb24gPSB7CiAgICAgIG5hbWU6IGdlbWluaURlY2xhcmF0aW9uLm5hbWUsCiAgICAgIGRlc2NyaXB0aW9uOiBnZW1pbmlEZWNsYXJhdGlvbi5kZXNjcmlwdGlvbiB8fCAiIiwKICAgICAgaW5wdXRTY2hlbWE6IHsKICAgICAgICB0eXBlOiAib2JqZWN0IiwKICAgICAgICBwcm9wZXJ0aWVzOiBjb252ZXJ0R2VtaW5pUHJvcGVydGllcygKICAgICAgICAgIGdlbWluaURlY2xhcmF0aW9uLnBhcmFtZXRlcnM/LnByb3BlcnRpZXMKICAgICAgICApLAogICAgICAgIHJlcXVpcmVkOiBnZW1pbmlEZWNsYXJhdGlvbi5wYXJhbWV0ZXJzPy5yZXF1aXJlZCB8fCBbXSwKICAgICAgfSwKICAgIH07CiAgICByZXR1cm4gbWNwRGVmaW5pdGlvbjsKICB9OwoKICByZXR1cm4gewogICAgbWNwVG9HZW1pbmlGdW5jdGlvbkRlY2xhcmF0aW9uLAogICAgZ2VtaW5pVG9NY3BGdW5jdGlvbkRlZmluaXRpb24sCiAgfTsKfTsKCmV4cG9ydCBkZWZhdWx0IE1DUENvbnZlcnRlck1vZHVsZTsK
--- CATS_END_FILE ---

--- CATS_START_FILE: ui-body.html ---
PGhlYWRlcj4KICA8aDE+CiAgICBEUkVBTUVSIEQ8c3ViPmVzaWduPC9zdWI+IFI8c3ViPmFkaWF0ZXM8L3N1Yj4gRTxzdWI+bGVnYW50PC9zdWI+IEE8c3ViCiAgICAgID5uZDwvc3ViCiAgICA+CiAgICBNPHN1Yj5vZHVsYXI8L3N1Yj4gRTxzdWI+bGVtZW50czwvc3ViPiBSRUNPTUJJTkVEIFI8c3ViPmVjdXJzaXZlPC9zdWI+IEU8c3ViCiAgICA+bGVtZW50PC9zdWI+IEM8c3ViPnJlYXRvcjwvc3ViPiBPPHN1Yj5wdGltaXplZDwvc3ViPiBNPHN1YgogICAgICA+ZXRpY3Vsb3VzbHk8L3N1YgogICAgPgogICAgQjxzdWI+eTwvc3ViPiBJPHN1Yj5uZmluaXRlPC9zdWI+IE48c3ViPmV0d29yazwvc3ViPiBFPHN1Yj52b2x1dGlvbjwvc3ViPgogICAgRFJFQU1FUgogIDwvaDE+CjwvaGVhZGVyPgo8bWFpbiBpZD0ibWFpbi1jb250ZW50Ij4KICA8c2VjdGlvbiBpZD0iY29udHJvbHMtc2VjdGlvbiI+CiAgICA8ZmllbGRzZXQ+CiAgICAgIDxsZWdlbmQ+Q29udHJvbHM8L2xlZ2VuZD4KICAgICAgPGRpdiBjbGFzcz0iY29udHJvbC1ncmlkIj4KICAgICAgICA8ZGl2IGNsYXNzPSJhcGkta2V5LWlucHV0Ij4KICAgICAgICAgIDxsYWJlbCBmb3I9ImFwaS1rZXktaW5wdXQiPkdlbWluaSBBUEkgS2V5OjwvbGFiZWw+CiAgICAgICAgICA8aW5wdXQKICAgICAgICAgICAgdHlwZT0icGFzc3dvcmQiCiAgICAgICAgICAgIGlkPSJhcGkta2V5LWlucHV0IgogICAgICAgICAgICBwbGFjZWhvbGRlcj0iRW50ZXIgeW91ciBBUEkga2V5IgogICAgICAgICAgLz4KICAgICAgICA8L2Rpdj4KICAgICAgICA8YnV0dG9uIGlkPSJzYXZlLWFwaS1rZXktYnV0dG9uIj5TYXZlIEtleTwvYnV0dG9uPgogICAgICAgIDxidXR0b24gaWQ9ImV4cG9ydC1zdGF0ZS1idXR0b24iPkV4cG9ydCBTdGF0ZTwvYnV0dG9uPgogICAgICAgIDxidXR0b24gaWQ9ImltcG9ydC1zdGF0ZS1idXR0b24iPkltcG9ydCBTdGF0ZTwvYnV0dG9uPgogICAgICAgIDxpbnB1dAogICAgICAgICAgdHlwZT0iZmlsZSIKICAgICAgICAgIGlkPSJpbXBvcnQtZmlsZS1pbnB1dCIKICAgICAgICAgIGFjY2VwdD0iLmpzb24iCiAgICAgICAgICBjbGFzcz0iaGlkZGVuIgogICAgICAgIC8+CiAgICAgICAgPGJ1dHRvbiBpZD0iZG93bmxvYWQtbG9nLWJ1dHRvbiI+RG93bmxvYWQgTG9nczwvYnV0dG9uPgogICAgICAgIDxidXR0b24KICAgICAgICAgIGlkPSJjbGVhci1zdG9yYWdlLWJ1dHRvbiIKICAgICAgICAgIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcikiCiAgICAgICAgPgogICAgICAgICAgQ2xlYXIgU3RvcmFnZQogICAgICAgIDwvYnV0dG9uPgogICAgICA8L2Rpdj4KICAgICAgPGRpdgogICAgICAgIGlkPSJzdGF0dXMtaW5kaWNhdG9yIgogICAgICAgIHN0eWxlPSJtYXJnaW4tdG9wOiB2YXIoLS1wYWRkaW5nLXNtKTsgZm9udC1zdHlsZTogaXRhbGljOyBjb2xvcjogI2FhYSIKICAgICAgPgogICAgICAgIFN0YXR1czogSWRsZQogICAgICA8L2Rpdj4KICAgIDwvZmllbGRzZXQ+CiAgPC9zZWN0aW9uPgoKICA8c2VjdGlvbiBpZD0idG9vbC1jcmVhdGlvbi1zZWN0aW9uIj4KICAgIDxmaWVsZHNldD4KICAgICAgPGxlZ2VuZD5DcmVhdGUgTmV3IFRvb2w8L2xlZ2VuZD4KICAgICAgPGxhYmVsIGZvcj0idG9vbC1yZXF1ZXN0LWlucHV0IgogICAgICAgID5EZXNjcmliZSB0aGUgdG9vbCB5b3Ugd2FudCB0byBjcmVhdGU6PC9sYWJlbAogICAgICA+CiAgICAgIDx0ZXh0YXJlYQogICAgICAgIGlkPSJ0b29sLXJlcXVlc3QtaW5wdXQiCiAgICAgICAgcm93cz0iNCIKICAgICAgICBwbGFjZWhvbGRlcj0iZS5nLiwgJ0NyZWF0ZSBhIHRvb2wgbmFtZWQgY2FsY3VsYXRlQ2lyY2xlQXJlYSB0aGF0IHRha2VzIGEgcmFkaXVzIG51bWJlciBhbmQgcmV0dXJucyB0aGUgYXJlYS4nIgogICAgICA+PC90ZXh0YXJlYT4KICAgICAgPGJ1dHRvbiBpZD0iY3JlYXRlLXRvb2wtYnV0dG9uIj5HZW5lcmF0ZSBUb29sPC9idXR0b24+CiAgICA8L2ZpZWxkc2V0PgogIDwvc2VjdGlvbj4KCiAgPHNlY3Rpb24gaWQ9InRvb2wtbGlicmFyeS1zZWN0aW9uIj4KICAgIDxoMj5HZW5lcmF0ZWQgVG9vbCBMaWJyYXJ5PC9oMj4KICAgIDxkaXYgaWQ9InRvb2wtbGlzdC1jb250YWluZXIiIGNsYXNzPSJ0b29sLWxpc3QiPgogICAgICA8cD5ObyB0b29scyBnZW5lcmF0ZWQgeWV0LjwvcD4KICAgIDwvZGl2PgogIDwvc2VjdGlvbj4KPC9tYWluPgo8Zm9vdGVyPgogIDxwPgogICAgRHJlYW1lciB4PHN1cD4yPC9zdXA+IC0gdjxzcGFuIGlkPSJhcHAtdmVyc2lvbiI+PHN1cD4/LjxzdXA+Py48c3VwPj8uPC9zdXA+PC9zdWI+PC9zdXA+PC9zcGFuPgogICAgPGRpdj58IFN0b3JhZ2U6IDxzcGFuIGlkPSJzdG9yYWdlLXVzYWdlIj4/S0IgKD8lKTwvc3Bhbj48L2Rpdj4KICA8L3A+CjwvZm9vdGVyPgo=
--- CATS_END_FILE ---

--- CATS_START_FILE: api-client.js ---
Y29uc3QgQXBpQ2xpZW50TW9kdWxlID0gKGNvbmZpZywgbG9nZ2VyKSA9PiB7CiAgaWYgKCFjb25maWcgfHwgIWxvZ2dlcikgewogICAgY29uc29sZS5lcnJvcigiQXBpQ2xpZW50TW9kdWxlIHJlcXVpcmVzIGNvbmZpZyBhbmQgbG9nZ2VyLiIpOwogICAgcmV0dXJuIG51bGw7CiAgfQoKICBsZXQgY3VycmVudEFib3J0Q29udHJvbGxlciA9IG51bGw7CiAgY29uc3QgQVBJX0VORFBPSU5UX0JBU0UgPSBjb25maWcuZ2VtaW5pQXBpQmFzZVVybDsKICBjb25zdCBSRVRSWV9ERUxBWV9CQVNFX01TID0gY29uZmlnLmFwaVJldHJ5RGVsYXlCYXNlTXM7CiAgY29uc3QgREVGQVVMVF9NQVhfT1VUUFVUX1RPS0VOUyA9IDgxOTI7CgogIGNvbnN0IHNhbml0aXplTGxtSnNvblJlc3BvbnNlID0gKHJhd1RleHQpID0+IHsKICAgIGlmICghcmF3VGV4dCB8fCB0eXBlb2YgcmF3VGV4dCAhPT0gInN0cmluZyIpIHJldHVybiBudWxsOwogICAgbGV0IHRleHQgPSByYXdUZXh0LnRyaW0oKTsKCiAgICBjb25zdCBjb2RlQmxvY2tNYXRjaCA9IHRleHQubWF0Y2goL2BgYCg/Ompzb24pP1xzKihbXHNcU10qPylccypgYGAvKTsKICAgIGlmIChjb2RlQmxvY2tNYXRjaCAmJiBjb2RlQmxvY2tNYXRjaFsxXSkgewogICAgICB0ZXh0ID0gY29kZUJsb2NrTWF0Y2hbMV0udHJpbSgpOwogICAgICB0cnkgewogICAgICAgIEpTT04ucGFyc2UodGV4dCk7CiAgICAgICAgcmV0dXJuIHRleHQ7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBsb2dnZXIubG9nRXZlbnQoCiAgICAgICAgICAid2FybiIsCiAgICAgICAgICBgSlNPTiBjb250ZW50IHdpdGhpbiBjb2RlIGJsb2NrIGZhaWxlZCB2YWxpZGF0aW9uOiAke2UubWVzc2FnZX1gCiAgICAgICAgKTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IGZpcnN0QnJhY2UgPSB0ZXh0LmluZGV4T2YoInsiKTsKICAgIGNvbnN0IGZpcnN0QnJhY2tldCA9IHRleHQuaW5kZXhPZigiWyIpOwogICAgbGV0IHN0YXJ0SW5kZXggPSAtMTsKCiAgICBpZiAoZmlyc3RCcmFjZSAhPT0gLTEgJiYgZmlyc3RCcmFja2V0ICE9PSAtMSkgewogICAgICBzdGFydEluZGV4ID0gTWF0aC5taW4oZmlyc3RCcmFjZSwgZmlyc3RCcmFja2V0KTsKICAgIH0gZWxzZSB7CiAgICAgIHN0YXJ0SW5kZXggPSBNYXRoLm1heChmaXJzdEJyYWNlLCBmaXJzdEJyYWNrZXQpOwogICAgfQoKICAgIGlmIChzdGFydEluZGV4ICE9PSAtMSkgewogICAgICB0ZXh0ID0gdGV4dC5zdWJzdHJpbmcoc3RhcnRJbmRleCk7CiAgICAgIGNvbnN0IHN0YXJ0Q2hhciA9IHRleHRbMF07CiAgICAgIGNvbnN0IGVuZENoYXIgPSBzdGFydENoYXIgPT09ICJ7IiA/ICJ9IiA6ICJdIjsKICAgICAgbGV0IGJhbGFuY2UgPSAwOwogICAgICBsZXQgbGFzdFZhbGlkSW5kZXggPSAtMTsKICAgICAgbGV0IGluU3RyaW5nID0gZmFsc2U7CiAgICAgIGxldCBlc2NhcGVOZXh0ID0gZmFsc2U7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRleHQubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBjaGFyID0gdGV4dFtpXTsKICAgICAgICBpZiAoaW5TdHJpbmcpIHsKICAgICAgICAgIGlmIChlc2NhcGVOZXh0KSB7CiAgICAgICAgICAgIGVzY2FwZU5leHQgPSBmYWxzZTsKICAgICAgICAgIH0gZWxzZSBpZiAoY2hhciA9PT0gIlxcIikgewogICAgICAgICAgICBlc2NhcGVOZXh0ID0gdHJ1ZTsKICAgICAgICAgIH0gZWxzZSBpZiAoY2hhciA9PT0gJyInKSB7CiAgICAgICAgICAgIGluU3RyaW5nID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChjaGFyID09PSAnIicpIHsKICAgICAgICAgICAgaW5TdHJpbmcgPSB0cnVlOwogICAgICAgICAgfSBlbHNlIGlmIChjaGFyID09PSBzdGFydENoYXIpIHsKICAgICAgICAgICAgYmFsYW5jZSsrOwogICAgICAgICAgfSBlbHNlIGlmIChjaGFyID09PSBlbmRDaGFyKSB7CiAgICAgICAgICAgIGJhbGFuY2UtLTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKCFpblN0cmluZyAmJiBiYWxhbmNlID09PSAwICYmIHN0YXJ0SW5kZXggPT09IDApIHsKICAgICAgICAgIGxhc3RWYWxpZEluZGV4ID0gaTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0gZWxzZSBpZiAoIWluU3RyaW5nICYmIGJhbGFuY2UgPT09IDAgJiYgaSA+IDAgJiYgc3RhcnRJbmRleCA+IDApIHsKICAgICAgICAgIGxhc3RWYWxpZEluZGV4ID0gaTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGxhc3RWYWxpZEluZGV4ICE9PSAtMSkgewogICAgICAgIGNvbnN0IHBvdGVudGlhbEpzb24gPSB0ZXh0LnN1YnN0cmluZygwLCBsYXN0VmFsaWRJbmRleCArIDEpOwogICAgICAgIHRyeSB7CiAgICAgICAgICBKU09OLnBhcnNlKHBvdGVudGlhbEpzb24pOwogICAgICAgICAgcmV0dXJuIHBvdGVudGlhbEpzb247CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgbG9nZ2VyLmxvZ0V2ZW50KAogICAgICAgICAgICAid2FybiIsCiAgICAgICAgICAgIGBIZXVyaXN0aWMgSlNPTiBzYW5pdGl6YXRpb24gZmFpbGVkIHZhbGlkYXRpb246ICR7ZS5tZXNzYWdlfWAKICAgICAgICAgICk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgICAgICJ3YXJuIiwKICAgICAgICAgICJKU09OIHNhbml0aXphdGlvbiBmYWlsZWQ6IFVuYmFsYW5jZWQgc3RydWN0dXJlIGZvdW5kIHZpYSBoZXVyaXN0aWMuIgogICAgICAgICk7CiAgICAgIH0KICAgIH0KCiAgICBsb2dnZXIubG9nRXZlbnQoCiAgICAgICJ3YXJuIiwKICAgICAgIkpTT04gc2FuaXRpemF0aW9uIGZhaWxlZDogQ291bGQgbm90IGV4dHJhY3QgdmFsaWQgSlNPTiBzdHJ1Y3R1cmUuIgogICAgKTsKICAgIHJldHVybiBudWxsOwogIH07CgogIGNvbnN0IGNhbGxBcGlXaXRoUmV0cnkgPSBhc3luYyAoCiAgICBwcm9tcHQsCiAgICBtb2RlbE5hbWUsCiAgICBhcGlLZXksCiAgICBmdW5jdGlvbkRlY2xhcmF0aW9ucyA9IFtdLAogICAgZ2VuZXJhdGlvbkNvbmZpZ092ZXJyaWRlcyA9IHt9LAogICAgcHJvZ3Jlc3NDYWxsYmFjayA9ICh0eXBlLCBkYXRhKSA9PiB7fQogICkgPT4gewogICAgaWYgKGN1cnJlbnRBYm9ydENvbnRyb2xsZXIpIHsKICAgICAgbG9nZ2VyLmxvZ0V2ZW50KAogICAgICAgICJ3YXJuIiwKICAgICAgICAiQWJvcnRpbmcgcHJldmlvdXMgQVBJIGNhbGwgYmVmb3JlIHN0YXJ0aW5nIG5ldyBvbmUuIgogICAgICApOwogICAgICBjdXJyZW50QWJvcnRDb250cm9sbGVyLmFib3J0KCJOZXcgY2FsbCBpbml0aWF0ZWQiKTsKICAgIH0KICAgIGN1cnJlbnRBYm9ydENvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7CiAgICBsZXQgYXR0ZW1wdCA9IDA7CiAgICBjb25zdCBtYXhSZXRyaWVzID0gY29uZmlnLmFwaU1heFJldHJpZXM7CiAgICBsZXQgY3VycmVudERlbGF5ID0gUkVUUllfREVMQVlfQkFTRV9NUzsKCiAgICB3aGlsZSAoYXR0ZW1wdCA8PSBtYXhSZXRyaWVzKSB7CiAgICAgIGNvbnN0IGF0dGVtcHRNc2cgPSBhdHRlbXB0ID4gMCA/IGBbUkVUUlkgJHthdHRlbXB0fS8ke21heFJldHJpZXN9XWAgOiAiIjsKICAgICAgcHJvZ3Jlc3NDYWxsYmFjaygic3RhdHVzIiwgewogICAgICAgIG1lc3NhZ2U6IGAke2F0dGVtcHRNc2d9IENhbGxpbmcgR2VtaW5pICgke21vZGVsTmFtZX0pLi4uYCwKICAgICAgICBhY3RpdmU6IHRydWUsCiAgICAgIH0pOwoKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBhcGlFbmRwb2ludCA9IGAke0FQSV9FTkRQT0lOVF9CQVNFfSR7bW9kZWxOYW1lfTpzdHJlYW1HZW5lcmF0ZUNvbnRlbnRgOwogICAgICAgIGNvbnN0IHNhZmV0eVNldHRpbmdzID0gWwogICAgICAgICAgIkhBVEVfU1BFRUNIIiwKICAgICAgICAgICJIQVJBU1NNRU5UIiwKICAgICAgICAgICJTRVhVQUxMWV9FWFBMSUNJVCIsCiAgICAgICAgICAiREFOR0VST1VTX0NPTlRFTlQiLAogICAgICAgIF0ubWFwKChjYXQpID0+ICh7CiAgICAgICAgICBjYXRlZ29yeTogYEhBUk1fQ0FURUdPUllfJHtjYXR9YCwKICAgICAgICAgIHRocmVzaG9sZDogIkJMT0NLX01FRElVTV9BTkRfQUJPVkUiLAogICAgICAgIH0pKTsKCiAgICAgICAgY29uc3QgZ2VuZXJhdGlvbkNvbmZpZyA9IHsKICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjUsCiAgICAgICAgICBtYXhPdXRwdXRUb2tlbnM6IERFRkFVTFRfTUFYX09VVFBVVF9UT0tFTlMsCiAgICAgICAgICAuLi5nZW5lcmF0aW9uQ29uZmlnT3ZlcnJpZGVzLAogICAgICAgIH07CgogICAgICAgIGNvbnN0IHJlcXVlc3RCb2R5ID0gewogICAgICAgICAgY29udGVudHM6IFt7IHJvbGU6ICJ1c2VyIiwgcGFydHM6IFt7IHRleHQ6IHByb21wdCB9XSB9XSwKICAgICAgICAgIHNhZmV0eVNldHRpbmdzOiBzYWZldHlTZXR0aW5ncywKICAgICAgICAgIGdlbmVyYXRpb25Db25maWc6IGdlbmVyYXRpb25Db25maWcsCiAgICAgICAgICAuLi4oZnVuY3Rpb25EZWNsYXJhdGlvbnM/Lmxlbmd0aCA+IDAgJiYgewogICAgICAgICAgICB0b29sczogW3sgZnVuY3Rpb25EZWNsYXJhdGlvbnM6IGZ1bmN0aW9uRGVjbGFyYXRpb25zIH1dLAogICAgICAgICAgICB0b29sX2NvbmZpZzogeyBmdW5jdGlvbl9jYWxsaW5nX2NvbmZpZzogeyBtb2RlOiAiQU5ZIiB9IH0sCiAgICAgICAgICB9KSwKICAgICAgICB9OwoKICAgICAgICBpZiAoZnVuY3Rpb25EZWNsYXJhdGlvbnM/Lmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgcmVxdWVzdEJvZHkuZ2VuZXJhdGlvbkNvbmZpZy5yZXNwb25zZU1pbWVUeXBlID0gImFwcGxpY2F0aW9uL2pzb24iOwogICAgICAgIH0KCiAgICAgICAgbG9nZ2VyLmxvZ0V2ZW50KCJkZWJ1ZyIsIGBBUEkgUmVxdWVzdCBCb2R5IChBdHRlbXB0ICR7YXR0ZW1wdH0pYCwgewogICAgICAgICAgZW5kcG9pbnQ6IGFwaUVuZHBvaW50LAogICAgICAgICAgaGFzVG9vbHM6IGZ1bmN0aW9uRGVjbGFyYXRpb25zLmxlbmd0aCA+IDAsCiAgICAgICAgfSk7CgogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7YXBpRW5kcG9pbnR9P2tleT0ke2FwaUtleX0mYWx0PXNzZWAsIHsKICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgaGVhZGVyczogeyAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iIH0sCiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShyZXF1ZXN0Qm9keSksCiAgICAgICAgICBzaWduYWw6IGN1cnJlbnRBYm9ydENvbnRyb2xsZXIuc2lnbmFsLAogICAgICAgIH0pOwoKICAgICAgICBpZiAoIXJlc3BvbnNlLm9rIHx8ICFyZXNwb25zZS5ib2R5KSB7CiAgICAgICAgICBsZXQgZXJyQm9keVRleHQgPSAiKEZhaWxlZCB0byByZWFkIGVycm9yIGJvZHkpIjsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGVyckJvZHlUZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpOwogICAgICAgICAgfSBjYXRjaCAoZSkge30KICAgICAgICAgIGxldCBlcnJKc29uID0ge307CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBlcnJKc29uID0gSlNPTi5wYXJzZShlcnJCb2R5VGV4dCk7CiAgICAgICAgICB9IGNhdGNoIChlKSB7fQogICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0KICAgICAgICAgICAgZXJySnNvbj8uZXJyb3I/Lm1lc3NhZ2UgfHwgcmVzcG9uc2Uuc3RhdHVzVGV4dCB8fCBlcnJCb2R5VGV4dDsKICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKAogICAgICAgICAgICBgQVBJIEVycm9yICgke3Jlc3BvbnNlLnN0YXR1c30pOiAke2Vycm9yTWVzc2FnZX1gCiAgICAgICAgICApOwogICAgICAgICAgZXJyb3Iuc3RhdHVzID0gcmVzcG9uc2Uuc3RhdHVzOwogICAgICAgICAgdGhyb3cgZXJyb3I7CiAgICAgICAgfQoKICAgICAgICBwcm9ncmVzc0NhbGxiYWNrKCJzdGF0dXMiLCB7CiAgICAgICAgICBtZXNzYWdlOiAiUmVjZWl2aW5nIHN0cmVhbS4uLiIsCiAgICAgICAgICBhY3RpdmU6IHRydWUsCiAgICAgICAgfSk7CgogICAgICAgIGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHkuZ2V0UmVhZGVyKCk7CiAgICAgICAgY29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpOwogICAgICAgIGxldCBidWZmZXIgPSAiIjsKICAgICAgICBsZXQgYWNjdW11bGF0ZWRUZXh0ID0gIiI7CiAgICAgICAgbGV0IGFjY3VtdWxhdGVkRnVuY3Rpb25DYWxscyA9IFtdOwogICAgICAgIGxldCB0b3RhbElucHV0VG9rZW5zID0gMDsKICAgICAgICBsZXQgdG90YWxPdXRwdXRUb2tlbnMgPSAwOwogICAgICAgIGxldCBmaW5hbEZpbmlzaFJlYXNvbiA9ICJVTktOT1dOIjsKICAgICAgICBsZXQgYmxvY2tSZWFzb24gPSBudWxsOwogICAgICAgIGxldCBzYWZldHlSYXRpbmdzID0gW107CgogICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICBpZiAoY3VycmVudEFib3J0Q29udHJvbGxlcj8uc2lnbmFsLmFib3J0ZWQpCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiQWJvcnRlZCIpOwogICAgICAgICAgY29uc3QgeyB2YWx1ZSwgZG9uZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTsKICAgICAgICAgIGlmIChkb25lKSBicmVhazsKCiAgICAgICAgICBidWZmZXIgKz0gZGVjb2Rlci5kZWNvZGUodmFsdWUsIHsgc3RyZWFtOiB0cnVlIH0pOwogICAgICAgICAgY29uc3QgbGluZXMgPSBidWZmZXIuc3BsaXQoIlxuIik7CiAgICAgICAgICBidWZmZXIgPSBsaW5lcy5wb3AoKSB8fCAiIjsKCiAgICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHsKICAgICAgICAgICAgaWYgKGxpbmUuc3RhcnRzV2l0aCgiZGF0YTogIikpIHsKICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc3QgY2h1bmsgPSBKU09OLnBhcnNlKGxpbmUuc3Vic3RyaW5nKDYpKTsKCiAgICAgICAgICAgICAgICBpZiAoY2h1bmsucHJvbXB0RmVlZGJhY2s/LmJsb2NrUmVhc29uKSB7CiAgICAgICAgICAgICAgICAgIGJsb2NrUmVhc29uID0gY2h1bmsucHJvbXB0RmVlZGJhY2suYmxvY2tSZWFzb247CiAgICAgICAgICAgICAgICAgIHNhZmV0eVJhdGluZ3MgPSBjaHVuay5wcm9tcHRGZWVkYmFjay5zYWZldHlSYXRpbmdzIHx8IFtdOwogICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEFQSSBCbG9ja2VkIChQcm9tcHQpOiAke2Jsb2NrUmVhc29ufWApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGNodW5rLmVycm9yKSB7CiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigKICAgICAgICAgICAgICAgICAgICBgQVBJIEVycm9yIGluIGNodW5rOiAke2NodW5rLmVycm9yLm1lc3NhZ2UgfHwgIlVua25vd24ifWAKICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0b3RhbElucHV0VG9rZW5zID0KICAgICAgICAgICAgICAgICAgY2h1bmsudXNhZ2VNZXRhZGF0YT8ucHJvbXB0VG9rZW5Db3VudCA/PyB0b3RhbElucHV0VG9rZW5zOwogICAgICAgICAgICAgICAgdG90YWxPdXRwdXRUb2tlbnMgPQogICAgICAgICAgICAgICAgICBjaHVuay51c2FnZU1ldGFkYXRhPy5jYW5kaWRhdGVzVG9rZW5Db3VudCA/PwogICAgICAgICAgICAgICAgICB0b3RhbE91dHB1dFRva2VuczsKCiAgICAgICAgICAgICAgICBjb25zdCBjYW5kaWRhdGUgPSBjaHVuay5jYW5kaWRhdGVzPy5bMF07CiAgICAgICAgICAgICAgICBpZiAoY2FuZGlkYXRlKSB7CiAgICAgICAgICAgICAgICAgIGZpbmFsRmluaXNoUmVhc29uID0KICAgICAgICAgICAgICAgICAgICBjYW5kaWRhdGUuZmluaXNoUmVhc29uIHx8IGZpbmFsRmluaXNoUmVhc29uOwogICAgICAgICAgICAgICAgICBzYWZldHlSYXRpbmdzID0gY2FuZGlkYXRlLnNhZmV0eVJhdGluZ3MgfHwgc2FmZXR5UmF0aW5nczsKICAgICAgICAgICAgICAgICAgaWYgKGZpbmFsRmluaXNoUmVhc29uID09PSAiU0FGRVRZIikgewogICAgICAgICAgICAgICAgICAgIGJsb2NrUmVhc29uID0gIlNBRkVUWSI7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBUEkgUmVzcG9uc2UgQmxvY2tlZDogU0FGRVRZYCk7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gY2FuZGlkYXRlLmNvbnRlbnQ/LnBhcnRzID8/IFtdOwogICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHBhcnQgb2YgcGFydHMpIHsKICAgICAgICAgICAgICAgICAgICBpZiAocGFydC50ZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICBhY2N1bXVsYXRlZFRleHQgKz0gcGFydC50ZXh0OwogICAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3NDYWxsYmFjaygicHJvZ3Jlc3MiLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ0ZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogcGFydC50ZXh0LAogICAgICAgICAgICAgICAgICAgICAgICBhY2N1bXVsYXRlZDogYWNjdW11bGF0ZWRUZXh0LAogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwYXJ0LmZ1bmN0aW9uQ2FsbCkgewogICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdDYWxsSW5kZXggPQogICAgICAgICAgICAgICAgICAgICAgICBhY2N1bXVsYXRlZEZ1bmN0aW9uQ2FsbHMuZmluZEluZGV4KAogICAgICAgICAgICAgICAgICAgICAgICAgIChmYykgPT4gZmMubmFtZSA9PT0gcGFydC5mdW5jdGlvbkNhbGwubmFtZQogICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nQ2FsbEluZGV4ID4gLTEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZWRGdW5jdGlvbkNhbGxzW2V4aXN0aW5nQ2FsbEluZGV4XSA9CiAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydC5mdW5jdGlvbkNhbGw7CiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBhY2N1bXVsYXRlZEZ1bmN0aW9uQ2FsbHMucHVzaChwYXJ0LmZ1bmN0aW9uQ2FsbCk7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICBwcm9ncmVzc0NhbGxiYWNrKCJwcm9ncmVzcyIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogImZ1bmN0aW9uQ2FsbCIsCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHBhcnQuZnVuY3Rpb25DYWxsLAogICAgICAgICAgICAgICAgICAgICAgICBhY2N1bXVsYXRlZDogWy4uLmFjY3VtdWxhdGVkRnVuY3Rpb25DYWxsc10sCiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICh0b3RhbElucHV0VG9rZW5zID4gMCB8fCB0b3RhbE91dHB1dFRva2VucyA+IDApIHsKICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3NDYWxsYmFjaygic3RhdHVzIiwgewogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBUb2tlbnM6IEluICR7dG90YWxJbnB1dFRva2Vuc30sIE91dCAke3RvdGFsT3V0cHV0VG9rZW5zfWAsCiAgICAgICAgICAgICAgICAgICAgYWN0aXZlOiB0cnVlLAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgIGUubWVzc2FnZS5pbmNsdWRlcygiQVBJIEJsb2NrZWQiKSB8fAogICAgICAgICAgICAgICAgICBlLm1lc3NhZ2UuaW5jbHVkZXMoIkFQSSBFcnJvciBpbiBjaHVuayIpIHx8CiAgICAgICAgICAgICAgICAgIGUubWVzc2FnZS5pbmNsdWRlcygiQWJvcnRlZCIpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgICAgICAgICBsb2dnZXIubG9nRXZlbnQoCiAgICAgICAgICAgICAgICAgICJ3YXJuIiwKICAgICAgICAgICAgICAgICAgYEZhaWxlZCB0byBwYXJzZS9wcm9jZXNzIFNTRSBjaHVuazogJHtlLm1lc3NhZ2V9YCwKICAgICAgICAgICAgICAgICAgbGluZQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHByb2dyZXNzQ2FsbGJhY2soInN0YXR1cyIsIHsKICAgICAgICAgIG1lc3NhZ2U6IGBTdHJlYW0gZmluaXNoZWQgKCR7ZmluYWxGaW5pc2hSZWFzb259KS4gUHJvY2Vzc2luZy4uLmAsCiAgICAgICAgICBhY3RpdmU6IHRydWUsCiAgICAgICAgfSk7CiAgICAgICAgbG9nZ2VyLmxvZ0V2ZW50KAogICAgICAgICAgImluZm8iLAogICAgICAgICAgYEFQSSBTdHJlYW0gT0suIEZpbmlzaDoke2ZpbmFsRmluaXNoUmVhc29ufS4gVG9rZW5zIEluOiR7dG90YWxJbnB1dFRva2Vuc30sIE91dDoke3RvdGFsT3V0cHV0VG9rZW5zfWAKICAgICAgICApOwoKICAgICAgICBsZXQgcmVzdWx0VHlwZSA9ICJlbXB0eSI7CiAgICAgICAgbGV0IHJlc3VsdERhdGEgPSBudWxsOwogICAgICAgIGlmIChhY2N1bXVsYXRlZEZ1bmN0aW9uQ2FsbHMubGVuZ3RoID4gMCkgewogICAgICAgICAgcmVzdWx0VHlwZSA9ICJmdW5jdGlvbkNhbGwiOwogICAgICAgICAgcmVzdWx0RGF0YSA9IGFjY3VtdWxhdGVkRnVuY3Rpb25DYWxsczsKICAgICAgICB9IGVsc2UgaWYgKGFjY3VtdWxhdGVkVGV4dCkgewogICAgICAgICAgcmVzdWx0VHlwZSA9ICJ0ZXh0IjsKICAgICAgICAgIHJlc3VsdERhdGEgPSBhY2N1bXVsYXRlZFRleHQ7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBmaW5hbFJlc3VsdCA9IHsKICAgICAgICAgIHR5cGU6IHJlc3VsdFR5cGUsCiAgICAgICAgICBkYXRhOiByZXN1bHREYXRhLAogICAgICAgICAgaW5wdXRUb2tlbkNvdW50OiB0b3RhbElucHV0VG9rZW5zLAogICAgICAgICAgb3V0cHV0VG9rZW5Db3VudDogdG90YWxPdXRwdXRUb2tlbnMsCiAgICAgICAgICBmaW5pc2hSZWFzb246IGZpbmFsRmluaXNoUmVhc29uLAogICAgICAgICAgYmxvY2tSZWFzb246IGJsb2NrUmVhc29uLAogICAgICAgICAgc2FmZXR5UmF0aW5nczogc2FmZXR5UmF0aW5ncywKICAgICAgICB9OwogICAgICAgIHByb2dyZXNzQ2FsbGJhY2soInJlc3VsdCIsIGZpbmFsUmVzdWx0KTsKICAgICAgICBjdXJyZW50QWJvcnRDb250cm9sbGVyID0gbnVsbDsKICAgICAgICByZXR1cm4gZmluYWxSZXN1bHQ7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc3QgaXNBYm9ydCA9IGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoIkFib3J0ZWQiKTsKICAgICAgICBpZiAoaXNBYm9ydCkgewogICAgICAgICAgcHJvZ3Jlc3NDYWxsYmFjaygic3RhdHVzIiwgeyBtZXNzYWdlOiAiQWJvcnRlZC4iLCBhY3RpdmU6IGZhbHNlIH0pOwogICAgICAgICAgcHJvZ3Jlc3NDYWxsYmFjaygiZXJyb3IiLCB7IG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UgfSk7CiAgICAgICAgICBjdXJyZW50QWJvcnRDb250cm9sbGVyID0gbnVsbDsKICAgICAgICAgIHRocm93IGVycm9yOwogICAgICAgIH0KCiAgICAgICAgY29uc3Qgc3RhdHVzID0gZXJyb3Iuc3RhdHVzIHx8IDA7CiAgICAgICAgY29uc3QgcmVhc29uID0gZXJyb3IubWVzc2FnZSB8fCAiVW5rbm93biBBUEkgZXJyb3IiOwogICAgICAgIHByb2dyZXNzQ2FsbGJhY2soInN0YXR1cyIsIHsKICAgICAgICAgIG1lc3NhZ2U6IGBFcnJvciAoJHtzdGF0dXN9KTogJHtyZWFzb24uc3Vic3RyaW5nKDAsIDUwKX0uLi4gUmV0cnlpbmc/YCwKICAgICAgICAgIGFjdGl2ZTogdHJ1ZSwKICAgICAgICAgIGlzRXJyb3I6IHRydWUsCiAgICAgICAgfSk7CiAgICAgICAgcHJvZ3Jlc3NDYWxsYmFjaygiZXJyb3IiLCB7IG1lc3NhZ2U6IHJlYXNvbiwgc3RhdHVzOiBzdGF0dXMgfSk7CgogICAgICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgICAgICJ3YXJuIiwKICAgICAgICAgIGBBUEkgYXR0ZW1wdCAke2F0dGVtcHR9IGZhaWxlZDogJHtyZWFzb259LiBTdGF0dXM6ICR7c3RhdHVzfS4gUmV0cmllcyBsZWZ0OiAkewogICAgICAgICAgICBtYXhSZXRyaWVzIC0gYXR0ZW1wdAogICAgICAgICAgfWAKICAgICAgICApOwogICAgICAgIGF0dGVtcHQrKzsKCiAgICAgICAgaWYgKAogICAgICAgICAgYXR0ZW1wdCA+IG1heFJldHJpZXMgfHwKICAgICAgICAgIHN0YXR1cyA9PT0gNDAwIHx8CiAgICAgICAgICBzdGF0dXMgPT09IDQwMSB8fAogICAgICAgICAgc3RhdHVzID09PSA0MDMgfHwKICAgICAgICAgIHN0YXR1cyA9PT0gNDA0IHx8CiAgICAgICAgICBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCJBUEkgQmxvY2tlZCIpCiAgICAgICAgKSB7CiAgICAgICAgICBsb2dnZXIubG9nRXZlbnQoCiAgICAgICAgICAgICJlcnJvciIsCiAgICAgICAgICAgIGBBUEkgY2FsbCBmYWlsZWQgcGVybWFuZW50bHkgYWZ0ZXIgJHsKICAgICAgICAgICAgICBhdHRlbXB0IC0gMQogICAgICAgICAgICB9IGF0dGVtcHRzIG9yIGR1ZSB0byBub24tcmV0cnlhYmxlIGVycm9yICgke3N0YXR1c30pLmAKICAgICAgICAgICk7CiAgICAgICAgICBwcm9ncmVzc0NhbGxiYWNrKCJzdGF0dXMiLCB7CiAgICAgICAgICAgIG1lc3NhZ2U6IGBBUEkgRmFpbGVkICgke3N0YXR1c30pYCwKICAgICAgICAgICAgYWN0aXZlOiBmYWxzZSwKICAgICAgICAgICAgaXNFcnJvcjogdHJ1ZSwKICAgICAgICAgIH0pOwogICAgICAgICAgY3VycmVudEFib3J0Q29udHJvbGxlciA9IG51bGw7CiAgICAgICAgICB0aHJvdyBlcnJvcjsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGRlbGF5TXMgPSBNYXRoLm1pbihjdXJyZW50RGVsYXkgKiAyICoqIChhdHRlbXB0IC0gMSksIDMwMDAwKTsKICAgICAgICBwcm9ncmVzc0NhbGxiYWNrKCJzdGF0dXMiLCB7CiAgICAgICAgICBtZXNzYWdlOiBgUmV0cnlpbmcgaW4gJHtNYXRoLnJvdW5kKGRlbGF5TXMgLyAxMDAwKX1zLi4uYCwKICAgICAgICAgIGFjdGl2ZTogdHJ1ZSwKICAgICAgICB9KTsKICAgICAgICBpZiAoY3VycmVudEFib3J0Q29udHJvbGxlcj8uc2lnbmFsLmFib3J0ZWQpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkFib3J0ZWQgZHVyaW5nIHJldHJ5IGRlbGF5Iik7CiAgICAgICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXlNcykpOwogICAgICAgIGlmIChjdXJyZW50QWJvcnRDb250cm9sbGVyPy5zaWduYWwuYWJvcnRlZCkKICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiQWJvcnRlZCBhZnRlciByZXRyeSBkZWxheSIpOwogICAgICB9CiAgICB9CgogICAgY3VycmVudEFib3J0Q29udHJvbGxlciA9IG51bGw7CiAgICB0aHJvdyBuZXcgRXJyb3IoIkFQSSBjYWxsIGZhaWxlZCBhZnRlciBleGhhdXN0aW5nIGFsbCByZXRyaWVzLiIpOwogIH07CgogIGNvbnN0IGFib3J0Q3VycmVudENhbGwgPSAocmVhc29uID0gIlVzZXIgcmVxdWVzdGVkIGFib3J0IikgPT4gewogICAgaWYgKGN1cnJlbnRBYm9ydENvbnRyb2xsZXIpIHsKICAgICAgbG9nZ2VyLmxvZ0V2ZW50KAogICAgICAgICJpbmZvIiwKICAgICAgICBgVXNlciByZXF1ZXN0ZWQgQVBJIGNhbGwgYWJvcnQuIFJlYXNvbjogJHtyZWFzb259YAogICAgICApOwogICAgICBjdXJyZW50QWJvcnRDb250cm9sbGVyLmFib3J0KHJlYXNvbik7CiAgICAgIGN1cnJlbnRBYm9ydENvbnRyb2xsZXIgPSBudWxsOwogICAgfSBlbHNlIHsKICAgICAgbG9nZ2VyLmxvZ0V2ZW50KCJpbmZvIiwgIk5vIGFjdGl2ZSBBUEkgY2FsbCB0byBhYm9ydC4iKTsKICAgIH0KICB9OwoKICByZXR1cm4gewogICAgY2FsbEFwaVdpdGhSZXRyeSwKICAgIGFib3J0Q3VycmVudENhbGwsCiAgICBzYW5pdGl6ZUxsbUpzb25SZXNwb25zZSwKICB9Owp9OwoKZXhwb3J0IGRlZmF1bHQgQXBpQ2xpZW50TW9kdWxlOwo=
--- CATS_END_FILE ---

--- CATS_START_FILE: utils.js ---
Y29uc3QgVXRpbHNNb2R1bGUgPSAoKCkgPT4gewogIGxldCBjb25maWcgPSBudWxsOwogIGxldCBsb2dCdWZmZXJBcnJheSA9IFtdOwogIGxldCBsb2dCdWZmZXJJbmRleCA9IDA7CiAgbGV0IGxvZ0J1ZmZlckluaXRpYWxpemVkID0gZmFsc2U7CgogIGNvbnN0IE1BWF9MT0dfRU5UUklFUyA9ICgpID0+IGNvbmZpZz8ubWF4TG9nRW50cmllcyA/PyAxMDAwOwoKICBjb25zdCBpbml0TG9nQnVmZmVyID0gKGNmZykgPT4gewogICAgY29uZmlnID0gY2ZnOwogICAgbG9nQnVmZmVyQXJyYXkgPSBuZXcgQXJyYXkoTUFYX0xPR19FTlRSSUVTKCkpOwogICAgbG9nQnVmZmVyQXJyYXkuZmlsbChudWxsKTsKICAgIGxvZ0J1ZmZlckluZGV4ID0gMDsKICAgIGxvZ0J1ZmZlckFycmF5WwogICAgICBsb2dCdWZmZXJJbmRleCsrCiAgICBdID0gYFJlcGxvaWQgdjIgTG9nIFN0YXJ0IC0gJHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCl9XG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuYDsKICAgIGxvZ0J1ZmZlckluaXRpYWxpemVkID0gdHJ1ZTsKICB9OwoKICBjb25zdCBzdHJpbmdpZnlEZXRhaWwgPSAoZGV0YWlsKSA9PiB7CiAgICBpZiAoZGV0YWlsID09PSB1bmRlZmluZWQgfHwgZGV0YWlsID09PSBudWxsKSByZXR1cm4gIiI7CiAgICBpZiAodHlwZW9mIGRldGFpbCA9PT0gInN0cmluZyIpIHJldHVybiBkZXRhaWw7CiAgICBpZiAoZGV0YWlsIGluc3RhbmNlb2YgRXJyb3IpCiAgICAgIHJldHVybiBgRXJyb3I6ICR7ZGV0YWlsLm1lc3NhZ2V9JHsKICAgICAgICBkZXRhaWwuc3RhY2sgPyBgXG5TdGFjazogJHtkZXRhaWwuc3RhY2t9YCA6ICIiCiAgICAgIH1gOwogICAgdHJ5IHsKICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KAogICAgICAgIGRldGFpbCwKICAgICAgICAoa2V5LCB2YWx1ZSkgPT4KICAgICAgICAgIHR5cGVvZiB2YWx1ZSA9PT0gImJpZ2ludCIgPyB2YWx1ZS50b1N0cmluZygpICsgIm4iIDogdmFsdWUsCiAgICAgICAgbnVsbCwKICAgICAgICAyCiAgICAgICk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIHJldHVybiAiW1Vuc2VyaWFsaXphYmxlIE9iamVjdF0iOwogICAgfQogIH07CgogIGNvbnN0IGxvZ2dlciA9IHsKICAgIGluaXQ6IGluaXRMb2dCdWZmZXIsCiAgICBsb2dFdmVudDogKGxldmVsID0gImluZm8iLCBtZXNzYWdlID0gIltObyBNZXNzYWdlXSIsIC4uLmRldGFpbHMpID0+IHsKICAgICAgaWYgKCFsb2dCdWZmZXJJbml0aWFsaXplZCkgewogICAgICAgIGNvbnNvbGUud2FybigKICAgICAgICAgICJMb2dnZXIgbm90IGluaXRpYWxpemVkIGJlZm9yZSBmaXJzdCBsb2cgZXZlbnQuIEF0dGVtcHRpbmcgZGVmYXVsdCBpbml0LiIKICAgICAgICApOwogICAgICAgIGluaXRMb2dCdWZmZXIoe30pOwogICAgICB9CgogICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7CiAgICAgIGNvbnN0IGxldmVsVXBwZXIgPSBTdHJpbmcobGV2ZWwpLnRvVXBwZXJDYXNlKCk7CiAgICAgIGxldCBsb2dMaW5lID0gYFske3RpbWVzdGFtcH1dIFske2xldmVsVXBwZXJ9XSAke1N0cmluZyhtZXNzYWdlKX1gOwoKICAgICAgY29uc3QgZGV0YWlsc1N0cmluZyA9IGRldGFpbHMKICAgICAgICAubWFwKHN0cmluZ2lmeURldGFpbCkKICAgICAgICAuZmlsdGVyKChzKSA9PiBzICE9PSAiIikKICAgICAgICAuam9pbigiIHwgIik7CiAgICAgIGlmIChkZXRhaWxzU3RyaW5nKSB7CiAgICAgICAgbG9nTGluZSArPSBgIHwgJHtkZXRhaWxzU3RyaW5nfWA7CiAgICAgIH0KCiAgICAgIGNvbnN0IGN1cnJlbnRNYXhFbnRyaWVzID0gTUFYX0xPR19FTlRSSUVTKCk7CiAgICAgIGxvZ0J1ZmZlckFycmF5W2xvZ0J1ZmZlckluZGV4ICUgY3VycmVudE1heEVudHJpZXNdID0gbG9nTGluZTsKICAgICAgbG9nQnVmZmVySW5kZXgrKzsKCiAgICAgIGNvbnN0IGNvbnNvbGVNZXRob2QgPQogICAgICAgIGxldmVsPy50b0xvd2VyQ2FzZSgpID09PSAiZXJyb3IiCiAgICAgICAgICA/IGNvbnNvbGUuZXJyb3IKICAgICAgICAgIDogbGV2ZWw/LnRvTG93ZXJDYXNlKCkgPT09ICJ3YXJuIgogICAgICAgICAgPyBjb25zb2xlLndhcm4KICAgICAgICAgIDogbGV2ZWw/LnRvTG93ZXJDYXNlKCkgPT09ICJkZWJ1ZyIKICAgICAgICAgID8gY29uc29sZS5kZWJ1ZwogICAgICAgICAgOiBjb25zb2xlLmxvZzsKCiAgICAgIGNvbnNvbGVNZXRob2QobG9nTGluZSk7CiAgICB9LAoKICAgIGdldExvZ0J1ZmZlcjogKCkgPT4gewogICAgICBpZiAoIWxvZ0J1ZmZlckluaXRpYWxpemVkKSByZXR1cm4gIkxvZyBidWZmZXIgbm90IGluaXRpYWxpemVkLlxuIjsKICAgICAgY29uc3QgY3VycmVudE1heEVudHJpZXMgPSBNQVhfTE9HX0VOVFJJRVMoKTsKICAgICAgY29uc3QgYnVmZmVyU2l6ZSA9IE1hdGgubWluKGxvZ0J1ZmZlckluZGV4LCBjdXJyZW50TWF4RW50cmllcyk7CiAgICAgIGNvbnN0IHN0YXJ0SW5kZXggPQogICAgICAgIGxvZ0J1ZmZlckluZGV4IDw9IGN1cnJlbnRNYXhFbnRyaWVzCiAgICAgICAgICA/IDAKICAgICAgICAgIDogbG9nQnVmZmVySW5kZXggJSBjdXJyZW50TWF4RW50cmllczsKICAgICAgY29uc3QgbG9nTGluZXMgPSBbXTsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBidWZmZXJTaXplOyBpKyspIHsKICAgICAgICBjb25zdCBjdXJyZW50SW5kZXggPSAoc3RhcnRJbmRleCArIGkpICUgY3VycmVudE1heEVudHJpZXM7CiAgICAgICAgaWYgKGxvZ0J1ZmZlckFycmF5W2N1cnJlbnRJbmRleF0gIT09IG51bGwpIHsKICAgICAgICAgIGxvZ0xpbmVzLnB1c2gobG9nQnVmZmVyQXJyYXlbY3VycmVudEluZGV4XSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGxldCBsb2dDb250ZW50ID0gbG9nTGluZXMuam9pbigiXG4iKSArICJcbiI7CgogICAgICBpZiAobG9nQnVmZmVySW5kZXggPiBjdXJyZW50TWF4RW50cmllcykgewogICAgICAgIGxvZ0NvbnRlbnQgPQogICAgICAgICAgYC4uLiAoTG9nIHRydW5jYXRlZCAtIHNob3dpbmcgbGFzdCAke2N1cnJlbnRNYXhFbnRyaWVzfSBlbnRyaWVzKSAuLi5cbmAgKwogICAgICAgICAgbG9nQ29udGVudDsKICAgICAgfQogICAgICByZXR1cm4gbG9nQ29udGVudDsKICAgIH0sCiAgICBzZXRMb2dCdWZmZXI6IChuZXdCdWZmZXIpID0+IHsKICAgICAgaWYgKCFsb2dCdWZmZXJJbml0aWFsaXplZCkgewogICAgICAgIGluaXRMb2dCdWZmZXIoe30pOwogICAgICB9CiAgICAgIGlmICh0eXBlb2YgbmV3QnVmZmVyID09PSAic3RyaW5nIikgewogICAgICAgIGNvbnN0IGxpbmVzID0gbmV3QnVmZmVyLnNwbGl0KCJcbiIpLmZpbHRlcigobGluZSkgPT4gbGluZS50cmltKCkpOwogICAgICAgIGNvbnN0IGN1cnJlbnRNYXhFbnRyaWVzID0gTUFYX0xPR19FTlRSSUVTKCk7CiAgICAgICAgbG9nQnVmZmVyQXJyYXkgPSBuZXcgQXJyYXkoY3VycmVudE1heEVudHJpZXMpLmZpbGwobnVsbCk7CgogICAgICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBNYXRoLm1heCgwLCBsaW5lcy5sZW5ndGggLSBjdXJyZW50TWF4RW50cmllcyk7CiAgICAgICAgbG9nQnVmZmVySW5kZXggPSAwOwoKICAgICAgICBsZXQgbG9hZGVkQ291bnQgPSAwOwogICAgICAgIGZvciAobGV0IGkgPSBzdGFydEluZGV4OyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGlmIChsb2dCdWZmZXJJbmRleCA8IGN1cnJlbnRNYXhFbnRyaWVzKSB7CiAgICAgICAgICAgIGxvZ0J1ZmZlckFycmF5W2xvZ0J1ZmZlckluZGV4XSA9IGxpbmVzW2ldOwogICAgICAgICAgICBsb2dCdWZmZXJJbmRleCsrOwogICAgICAgICAgICBsb2FkZWRDb3VudCsrOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAobGluZXMubGVuZ3RoID4gY3VycmVudE1heEVudHJpZXMpIHsKICAgICAgICAgIGNvbnN0IGhlYWRlciA9IGAuLi4gKExvZyB0cnVuY2F0ZWQgZHVyaW5nIGltcG9ydCAtIGxvYWRlZCBsYXN0ICR7bG9hZGVkQ291bnR9IGxpbmVzKSAuLi5gOwoKICAgICAgICAgIGxvZ0J1ZmZlckFycmF5LnVuc2hpZnQoaGVhZGVyKTsKICAgICAgICAgIGlmIChsb2dCdWZmZXJJbmRleCA8IGN1cnJlbnRNYXhFbnRyaWVzKSB7CiAgICAgICAgICAgIGxvZ0J1ZmZlckluZGV4Kys7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsb2dCdWZmZXJBcnJheVtjdXJyZW50TWF4RW50cmllcyAtIDFdID0KICAgICAgICAgICAgICBsb2dCdWZmZXJBcnJheVtjdXJyZW50TWF4RW50cmllcyAtIDJdOwogICAgICAgICAgICBsb2dCdWZmZXJBcnJheVswXSA9IGhlYWRlcjsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgbG9nQnVmZmVySW5kZXggPSBsb2FkZWRDb3VudDsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbG9nZ2VyLmxvZ0V2ZW50KAogICAgICAgICAgIndhcm4iLAogICAgICAgICAgInNldExvZ0J1ZmZlciByZWNlaXZlZCBpbnZhbGlkIGJ1ZmZlciB0eXBlLCByZXNldHRpbmcuIgogICAgICAgICk7CiAgICAgICAgaW5pdExvZ0J1ZmZlcihjb25maWcpOwogICAgICB9CiAgICB9LAogICAgZ2V0Q29uZmlnOiAoKSA9PiBjb25maWcsCiAgfTsKCiAgY29uc3QgJGlkID0gKGlkKSA9PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7CiAgY29uc3QgJCA9IChzZWxlY3RvciwgcGFyZW50ID0gZG9jdW1lbnQpID0+IHBhcmVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTsKICBjb25zdCAkJCA9IChzZWxlY3RvciwgcGFyZW50ID0gZG9jdW1lbnQpID0+CiAgICBBcnJheS5mcm9tKHBhcmVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSk7CgogIGNvbnN0IGVzY2FwZUh0bWwgPSAodW5zYWZlKSA9PiB7CiAgICBpZiAodW5zYWZlID09PSBudWxsIHx8IHVuc2FmZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gIiI7CiAgICByZXR1cm4gU3RyaW5nKHVuc2FmZSkKICAgICAgLnJlcGxhY2UoLyYvZywgIiZhbXA7IikKICAgICAgLnJlcGxhY2UoLzwvZywgIiZsdDsiKQogICAgICAucmVwbGFjZSgvPi9nLCAiJmd0OyIpCiAgICAgIC5yZXBsYWNlKC8iL2csICImcXVvdDsiKQogICAgICAucmVwbGFjZSgvJy9nLCAiJiMwMzk7Iik7CiAgfTsKCiAgY29uc3QgZGVsYXkgPSAobXMpID0+IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7CgogIGNvbnN0IGdlbmVyYXRlVVVJRCA9ICgpID0+IHsKICAgIHJldHVybiAieHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Ii5yZXBsYWNlKAogICAgICAvW3h5XS9nLAogICAgICBmdW5jdGlvbiAoYykgewogICAgICAgIGNvbnN0IHIgPSAoTWF0aC5yYW5kb20oKSAqIDE2KSB8IDAsCiAgICAgICAgICB2ID0gYyA9PSAieCIgPyByIDogKHIgJiAweDMpIHwgMHg4OwogICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDE2KTsKICAgICAgfQogICAgKTsKICB9OwoKICByZXR1cm4gewogICAgbG9nZ2VyLAogICAgJGlkLAogICAgJCwKICAgICQkLAogICAgZXNjYXBlSHRtbCwKICAgIGRlbGF5LAogICAgZ2VuZXJhdGVVVUlELAogIH07Cn0pKCk7CgpleHBvcnQgZGVmYXVsdCBVdGlsc01vZHVsZTsK
--- CATS_END_FILE ---

--- CATS_START_FILE: tool-runner.js ---
Y29uc3QgVG9vbFJ1bm5lck1vZHVsZSA9IChjb25maWcsIGxvZ2dlcikgPT4gewogIGlmICghY29uZmlnIHx8ICFsb2dnZXIpIHsKICAgIGNvbnNvbGUuZXJyb3IoIlRvb2xSdW5uZXJNb2R1bGUgcmVxdWlyZXMgY29uZmlnIGFuZCBsb2dnZXIuIik7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGNvbnN0IEVYRUNVVElPTl9USU1FT1VUX01TID0gY29uZmlnLnRvb2xSdW5uZXJUaW1lb3V0TXMgfHwgMTAwMDA7CgogIGNvbnN0IHJ1bkpzSW1wbGVtZW50YXRpb24gPSBhc3luYyAoanNDb2RlU3RyaW5nLCBhcmdzKSA9PiB7CiAgICBsb2dnZXIubG9nRXZlbnQoCiAgICAgICJpbmZvIiwKICAgICAgYEF0dGVtcHRpbmcgdG8gZXhlY3V0ZSBnZW5lcmF0ZWQgSlMgaW1wbGVtZW50YXRpb24uYAogICAgKTsKICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgImRlYnVnIiwKICAgICAgYEV4ZWN1dGluZyBjb2RlOmAsCiAgICAgIGpzQ29kZVN0cmluZy5zdWJzdHJpbmcoMCwgMjAwKSArICIuLi4iCiAgICApOwogICAgbG9nZ2VyLmxvZ0V2ZW50KCJkZWJ1ZyIsIGBXaXRoIGFyZ3VtZW50czpgLCBhcmdzKTsKCiAgICBpZiAodHlwZW9mIGpzQ29kZVN0cmluZyAhPT0gInN0cmluZyIgfHwganNDb2RlU3RyaW5nLnRyaW0oKSA9PT0gIiIpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJQcm92aWRlZCBKUyBjb2RlIHN0cmluZyBpcyBlbXB0eSBvciBpbnZhbGlkLiIpOwogICAgfQoKICAgIGlmICgKICAgICAgIWpzQ29kZVN0cmluZy5pbmNsdWRlcygiYXN5bmMgZnVuY3Rpb24gcnVuIikgJiYKICAgICAgIWpzQ29kZVN0cmluZy5pbmNsdWRlcygicnVuID0gYXN5bmMiKQogICAgKSB7CiAgICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgICAid2FybiIsCiAgICAgICAgIkdlbmVyYXRlZCBKUyBjb2RlIG1pZ2h0IGJlIG1pc3NpbmcgZXhwZWN0ZWQgJ2FzeW5jIGZ1bmN0aW9uIHJ1bihhcmdzKScgc3RydWN0dXJlLiIKICAgICAgKTsKICAgIH0KCiAgICByZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICBsZXQgdGltZW91dElkID0gbnVsbDsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBBc3luY0Z1bmN0aW9uID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKAogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gKCkge30KICAgICAgICApLmNvbnN0cnVjdG9yOwoKICAgICAgICBjb25zdCByZXN0cmljdGVkQ29uc29sZSA9IHsKICAgICAgICAgIGxvZzogKC4uLmxvZ0FyZ3MpID0+IGxvZ2dlci5sb2dFdmVudCgiaW5mbyIsICJUb29sIExvZzoiLCAuLi5sb2dBcmdzKSwKICAgICAgICAgIHdhcm46ICguLi5sb2dBcmdzKSA9PgogICAgICAgICAgICBsb2dnZXIubG9nRXZlbnQoIndhcm4iLCAiVG9vbCBXYXJuOiIsIC4uLmxvZ0FyZ3MpLAogICAgICAgICAgZXJyb3I6ICguLi5sb2dBcmdzKSA9PgogICAgICAgICAgICBsb2dnZXIubG9nRXZlbnQoImVycm9yIiwgIlRvb2wgRXJyb3I6IiwgLi4ubG9nQXJncyksCiAgICAgICAgfTsKCiAgICAgICAgY29uc3QgZnVuYyA9IG5ldyBBc3luY0Z1bmN0aW9uKAogICAgICAgICAgImFyZ3MiLAogICAgICAgICAgImNvbnNvbGUiLAogICAgICAgICAganNDb2RlU3RyaW5nICsgIlxuXG5yZXR1cm4gcnVuKGFyZ3MpOyIKICAgICAgICApOwoKICAgICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHJlamVjdCgKICAgICAgICAgICAgbmV3IEVycm9yKAogICAgICAgICAgICAgIGBUb29sIGV4ZWN1dGlvbiB0aW1lZCBvdXQgYWZ0ZXIgJHtFWEVDVVRJT05fVElNRU9VVF9NU31tc2AKICAgICAgICAgICAgKQogICAgICAgICAgKTsKICAgICAgICB9LCBFWEVDVVRJT05fVElNRU9VVF9NUyk7CgogICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGZ1bmMoYXJncywgcmVzdHJpY3RlZENvbnNvbGUpOwogICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpOwogICAgICAgIGxvZ2dlci5sb2dFdmVudCgiaW5mbyIsICJUb29sIGV4ZWN1dGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LiIpOwogICAgICAgIGxvZ2dlci5sb2dFdmVudCgiZGVidWciLCAiVG9vbCByZXN1bHQ6IiwgcmVzdWx0KTsKICAgICAgICByZXNvbHZlKHJlc3VsdCk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7CiAgICAgICAgbG9nZ2VyLmxvZ0V2ZW50KCJlcnJvciIsICJFcnJvciBleGVjdXRpbmcgZ2VuZXJhdGVkIEpTIGNvZGU6IiwgZXJyb3IpOwogICAgICAgIHJlamVjdChuZXcgRXJyb3IoYFRvb2wgZXhlY3V0aW9uIGZhaWxlZDogJHtlcnJvci5tZXNzYWdlfWApKTsKICAgICAgfQogICAgfSk7CiAgfTsKCiAgcmV0dXJuIHsKICAgIHJ1bkpzSW1wbGVtZW50YXRpb24sCiAgfTsKfTsKCmV4cG9ydCBkZWZhdWx0IFRvb2xSdW5uZXJNb2R1bGU7Cg==
--- CATS_END_FILE ---

--- CATS_START_FILE: cycle-logic.js ---
Y29uc3QgQ3ljbGVMb2dpY01vZHVsZSA9ICgKICBjb25maWcsCiAgbG9nZ2VyLAogIFV0aWxzLAogIHN0b3JhZ2UsCiAgU3RhdGVNYW5hZ2VyLAogIEFwaUNsaWVudCwKICBNQ1BDb252ZXJ0ZXIsCiAgVG9vbFJ1bm5lcgopID0+IHsKICBpZiAoCiAgICAhY29uZmlnIHx8CiAgICAhbG9nZ2VyIHx8CiAgICAhVXRpbHMgfHwKICAgICFzdG9yYWdlIHx8CiAgICAhU3RhdGVNYW5hZ2VyIHx8CiAgICAhQXBpQ2xpZW50IHx8CiAgICAhTUNQQ29udmVydGVyIHx8CiAgICAhVG9vbFJ1bm5lcgogICkgewogICAgbG9nZ2VyPy5sb2dFdmVudCgiZXJyb3IiLCAiQ3ljbGVMb2dpYyByZXF1aXJlcyBhbGwgY29yZSBtb2R1bGVzLiIpOwogICAgcmV0dXJuIG51bGw7CiAgfQoKICBsZXQgX2lzUnVubmluZyA9IGZhbHNlOwogIGxldCBpc0xvZ2ljSW5pdGlhbGl6ZWQgPSBmYWxzZTsKICBsZXQgX2N1cnJlbnRQcm9tcHRBcnRpZmFjdElkID0gY29uZmlnLmRlZmF1bHRQcm9tcHRBcnRpZmFjdElkOwoKICBjb25zdCBpbml0ID0gKCkgPT4gewogICAgaWYgKGlzTG9naWNJbml0aWFsaXplZCkgewogICAgICBsb2dnZXIubG9nRXZlbnQoIndhcm4iLCAiQ3ljbGVMb2dpYyBpbml0IGNhbGxlZCBtdWx0aXBsZSB0aW1lcy4iKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgbG9nZ2VyLmxvZ0V2ZW50KCJpbmZvIiwgIkluaXRpYWxpemluZyBDeWNsZUxvZ2ljLi4uIik7CiAgICBpc0xvZ2ljSW5pdGlhbGl6ZWQgPSB0cnVlOwogICAgbG9nZ2VyLmxvZ0V2ZW50KCJpbmZvIiwgIkN5Y2xlTG9naWMgaW5pdGlhbGl6ZWQuIik7CiAgfTsKCiAgY29uc3QgaXNSdW5uaW5nID0gKCkgPT4gX2lzUnVubmluZzsKCiAgY29uc3QgX2Fzc2VtYmxlR2VuZXJhdG9yUHJvbXB0ID0gKHRvb2xSZXF1ZXN0KSA9PiB7CiAgICBjb25zdCBwcm9tcHRUZW1wbGF0ZSA9IGBgYApZb3UgYXJlIGFuIGV4cGVydCB0b29sIGRlc2lnbmVyIGFuZCBKYXZhU2NyaXB0IGRldmVsb3Blci4gWW91ciB0YXNrIGlzIHRvIGNyZWF0ZSBCT1RIIGEgdmFsaWQgTUNQIChNb2RlbCBDb250ZXh0IFByb3RvY29sKSB0b29sIGRlZmluaXRpb24gSlNPTiBvYmplY3QgQU5EIGEgZnVuY3Rpb25hbCBKYXZhU2NyaXB0IGltcGxlbWVudGF0aW9uIHN0cmluZyBiYXNlZCBvbiB0aGUgdXNlcidzIHJlcXVlc3QuCgpVc2VyIFJlcXVlc3Q6CiIke3Rvb2xSZXF1ZXN0fSIKCkluc3RydWN0aW9uczoKMS4gICoqRGVzaWduIHRoZSBNQ1AgVG9vbCBEZWZpbml0aW9uOioqCiAgICAqICAgQ3JlYXRlIGEgSlNPTiBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSB0b29sIGFjY29yZGluZyB0byBNQ1Agc2NoZW1hIHN0YW5kYXJkcyAoZm9jdXMgb24gJ25hbWUnLCAnZGVzY3JpcHRpb24nLCAnaW5wdXRTY2hlbWEnIHdpdGggcHJvcGVydGllcywgdHlwZXMsIGRlc2NyaXB0aW9ucywgYW5kIHJlcXVpcmVkIGZpZWxkcykuCiAgICAqICAgVGhlIHRvb2wgbmFtZSBzaG91bGQgYmUgZGVzY3JpcHRpdmUsIHVzZSBjYW1lbENhc2Ugb3Igc25ha2VfY2FzZS4KICAgICogICBFbnN1cmUgaW5wdXRTY2hlbWEgdHlwZXMgYXJlIHN0YW5kYXJkIEpTT04gdHlwZXMgKCdzdHJpbmcnLCAnbnVtYmVyJywgJ2ludGVnZXInLCAnYm9vbGVhbicsICdhcnJheScsICdvYmplY3QnKS4gUHJvdmlkZSBjbGVhciBkZXNjcmlwdGlvbnMgZm9yIGVhY2ggcGFyYW1ldGVyLgoyLiAgKipJbXBsZW1lbnQgdGhlIEphdmFTY3JpcHQgRnVuY3Rpb246KioKICAgICogICBXcml0ZSBhIEphdmFTY3JpcHQgc3RyaW5nIGNvbnRhaW5pbmcgYW4gJ2FzeW5jIGZ1bmN0aW9uIHJ1bihhcmdzKScgdGhhdCB0YWtlcyBhIHNpbmdsZSBhcmd1bWVudCAnYXJncycgKG1hdGNoaW5nIHRoZSAncHJvcGVydGllcycgZGVmaW5lZCBpbiB5b3VyIE1DUCBpbnB1dFNjaGVtYSkuCiAgICAqICAgVGhlIGZ1bmN0aW9uIHNob3VsZCBwZXJmb3JtIHRoZSByZXF1ZXN0ZWQgYWN0aW9uIGFuZCByZXR1cm4gdGhlIHJlc3VsdC4KICAgICogICBVc2Ugc3RhbmRhcmQgSmF2YVNjcmlwdCAoRVM2KykuIFlvdSBoYXZlIGFjY2VzcyB0byBhIHJlc3RyaWN0ZWQgJ2NvbnNvbGUnIG9iamVjdCBmb3IgbG9nZ2luZyAoY29uc29sZS5sb2csIGNvbnNvbGUud2FybiwgY29uc29sZS5lcnJvcikuIERvIE5PVCBhdHRlbXB0IHRvIGFjY2VzcyAnd2luZG93JywgJ2RvY3VtZW50Jywgb3IgbWFrZSBleHRlcm5hbCBuZXR3b3JrIGNhbGxzIGRpcmVjdGx5IHVubGVzcyB0aGUgdG9vbCdzIGV4cGxpY2l0IHB1cnBvc2UgaXMgdG8gd3JhcCBhbiBBUEkgY2FsbCAod2hpY2ggaXMgYWR2YW5jZWQpLiBLZWVwIGltcGxlbWVudGF0aW9ucyBzZWxmLWNvbnRhaW5lZCBpZiBwb3NzaWJsZS4KICAgICogICBIYW5kbGUgcG90ZW50aWFsIGVycm9ycyBncmFjZWZ1bGx5IHdpdGhpbiB0aGUgZnVuY3Rpb24gKGUuZy4sIHVzaW5nIHRyeS9jYXRjaCkgYW5kIHJldHVybiBtZWFuaW5nZnVsIGVycm9yIGluZm9ybWF0aW9uIGlmIG5lY2Vzc2FyeS4KMy4gICoqT3V0cHV0IEZvcm1hdDoqKiBSZXNwb25kIE9OTFkgd2l0aCBhIHNpbmdsZSBKU09OIG9iamVjdCBjb250YWluaW5nIHR3byBrZXlzOgogICAgKiAgIFxgbWNwRGVmaW5pdGlvblxgOiBUaGUgSlNPTiBvYmplY3QgZm9yIHRoZSBNQ1AgdG9vbCBkZWZpbml0aW9uLgogICAgKiAgIFxganNJbXBsZW1lbnRhdGlvblxgOiBUaGUgSmF2YVNjcmlwdCBjb2RlIHN0cmluZyBmb3IgdGhlICdhc3luYyBmdW5jdGlvbiBydW4oYXJncyknLgoKRXhhbXBsZSBNQ1AgRGVmaW5pdGlvbiBTdHJ1Y3R1cmU6CnsKICAibmFtZSI6ICJleGFtcGxlVG9vbE5hbWUiLAogICJkZXNjcmlwdGlvbiI6ICJBIGNsZWFyIGRlc2NyaXB0aW9uIG9mIHdoYXQgdGhlIHRvb2wgZG9lcy4iLAogICJpbnB1dFNjaGVtYSI6IHsKICAgICJ0eXBlIjogIm9iamVjdCIsCiAgICAicHJvcGVydGllcyI6IHsKICAgICAgInBhcmFtMSI6IHsgInR5cGUiOiAic3RyaW5nIiwgImRlc2NyaXB0aW9uIjogIkRlc2NyaXB0aW9uIG9mIHBhcmFtMS4iIH0sCiAgICAgICJwYXJhbTIiOiB7ICJ0eXBlIjogIm51bWJlciIsICJkZXNjcmlwdGlvbiI6ICJEZXNjcmlwdGlvbiBvZiBwYXJhbTIuIiB9CiAgICB9LAogICAgInJlcXVpcmVkIjogWyJwYXJhbTEiXQogIH0KfQoKRXhhbXBsZSBKUyBJbXBsZW1lbnRhdGlvbiBTdHJ1Y3R1cmUgKFN0cmluZyk6CiJhc3luYyBmdW5jdGlvbiBydW4oYXJncykge1xcbiAgY29uc3QgeyBwYXJhbTEsIHBhcmFtMiB9ID0gYXJncztcXG4gIGNvbnNvbGUubG9nKCdFeGVjdXRpbmcgdG9vbCB3aXRoOicsIGFyZ3MpO1xcbiAgdHJ5IHtcXG4gICAgY29uc3QgcmVzdWx0ID0gcGFyYW0xLnRvVXBwZXJDYXNlKCkgKyAocGFyYW0yIHx8IDApO1xcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcXG4gIH0gY2F0Y2ggKGVycm9yKSB7XFxuICAgIGNvbnNvbGUuZXJyb3IoJ1Rvb2wgZXhlY3V0aW9uIGZhaWxlZDonLCBlcnJvcik7XFxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xcbiAgfVxcbn0iCgpFbnN1cmUgdGhlIGdlbmVyYXRlZCBKU09OIGlzIHZhbGlkIGFuZCB0aGUgSmF2YVNjcmlwdCBzdHJpbmcgaXMgY29ycmVjdGx5IGVzY2FwZWQgaWYgbmVjZXNzYXJ5IHdpdGhpbiB0aGUgZmluYWwgSlNPTiBvdXRwdXQuCiAgICAgICAgYGBgOwogICAgbG9nZ2VyLmxvZ0V2ZW50KAogICAgICAiZGVidWciLAogICAgICAiQXNzZW1ibGVkIHRvb2wgZ2VuZXJhdG9yIHByb21wdCBmb3IgcmVxdWVzdDoiLAogICAgICB0b29sUmVxdWVzdAogICAgKTsKICAgIHJldHVybiBwcm9tcHRUZW1wbGF0ZTsKICB9OwoKICBjb25zdCBnZW5lcmF0ZVRvb2wgPSBhc3luYyAoCiAgICB0b29sUmVxdWVzdCwKICAgIHByb2dyZXNzQ2FsbGJhY2sgPSAodHlwZSwgZGF0YSkgPT4ge30KICApID0+IHsKICAgIGlmIChfaXNSdW5uaW5nKSB7CiAgICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgICAid2FybiIsCiAgICAgICAgIlRvb2wgZ2VuZXJhdGlvbiByZXF1ZXN0IGlnbm9yZWQ6IEFscmVhZHkgcnVubmluZy4iCiAgICAgICk7CiAgICAgIHByb2dyZXNzQ2FsbGJhY2soImVycm9yIiwgewogICAgICAgIG1lc3NhZ2U6ICJUb29sIGdlbmVyYXRpb24gYWxyZWFkeSBpbiBwcm9ncmVzcy4iLAogICAgICB9KTsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICBpZiAoCiAgICAgICF0b29sUmVxdWVzdCB8fAogICAgICB0eXBlb2YgdG9vbFJlcXVlc3QgIT09ICJzdHJpbmciIHx8CiAgICAgIHRvb2xSZXF1ZXN0LnRyaW0oKS5sZW5ndGggPT09IDAKICAgICkgewogICAgICBsb2dnZXIubG9nRXZlbnQoImVycm9yIiwgIkludmFsaWQgdG9vbCByZXF1ZXN0IHByb3ZpZGVkLiIpOwogICAgICBwcm9ncmVzc0NhbGxiYWNrKCJlcnJvciIsIHsgbWVzc2FnZTogIlRvb2wgcmVxdWVzdCBjYW5ub3QgYmUgZW1wdHkuIiB9KTsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgY29uc3Qgc3RhdGUgPSBTdGF0ZU1hbmFnZXIuZ2V0U3RhdGUoKTsKICAgIGlmICghc3RhdGUpIHsKICAgICAgbG9nZ2VyLmxvZ0V2ZW50KCJlcnJvciIsICJDYW5ub3QgZ2VuZXJhdGUgdG9vbDogU3RhdGVNYW5hZ2VyIG5vdCByZWFkeS4iKTsKICAgICAgcHJvZ3Jlc3NDYWxsYmFjaygiZXJyb3IiLCB7IG1lc3NhZ2U6ICJTeXN0ZW0gc3RhdGUgbm90IGF2YWlsYWJsZS4iIH0pOwogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIGlmICghc3RhdGUuYXBpS2V5KSB7CiAgICAgIGxvZ2dlci5sb2dFdmVudCgiZXJyb3IiLCAiQ2Fubm90IGdlbmVyYXRlIHRvb2w6IEFQSSBLZXkgbm90IHNldC4iKTsKICAgICAgcHJvZ3Jlc3NDYWxsYmFjaygiZXJyb3IiLCB7IG1lc3NhZ2U6ICJBUEkgS2V5IGlzIHJlcXVpcmVkLiIgfSk7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIF9pc1J1bm5pbmcgPSB0cnVlOwogICAgU3RhdGVNYW5hZ2VyLmluY3JlbWVudEN5Y2xlKCk7CiAgICBwcm9ncmVzc0NhbGxiYWNrKCJzdGF0dXMiLCB7CiAgICAgIG1lc3NhZ2U6ICJTdGFydGluZyB0b29sIGdlbmVyYXRpb24gY3ljbGUuLi4iLAogICAgICBhY3RpdmU6IHRydWUsCiAgICB9KTsKICAgIGxldCBnZW5lcmF0ZWRUb29sRGF0YSA9IG51bGw7CgogICAgdHJ5IHsKICAgICAgY29uc3QgcHJvbXB0ID0gX2Fzc2VtYmxlR2VuZXJhdG9yUHJvbXB0KHRvb2xSZXF1ZXN0KTsKICAgICAgY29uc3QgbW9kZWxOYW1lID0gY29uZmlnLmRlZmF1bHRNb2RlbDsKICAgICAgY29uc3QgYXBpS2V5ID0gc3RhdGUuYXBpS2V5OwoKICAgICAgU3RhdGVNYW5hZ2VyLmluY3JlbWVudEFwaUNhbGwoKTsKICAgICAgY29uc3QgYXBpUmVzdWx0ID0gYXdhaXQgQXBpQ2xpZW50LmNhbGxBcGlXaXRoUmV0cnkoCiAgICAgICAgcHJvbXB0LAogICAgICAgIG1vZGVsTmFtZSwKICAgICAgICBhcGlLZXksCiAgICAgICAgW10sCiAgICAgICAgeyB0ZW1wZXJhdHVyZTogMC4zIH0sCiAgICAgICAgcHJvZ3Jlc3NDYWxsYmFjawogICAgICApOwogICAgICBTdGF0ZU1hbmFnZXIuc2V0TGFzdEVycm9yKG51bGwpOwoKICAgICAgaWYgKGFwaVJlc3VsdC50eXBlICE9PSAidGV4dCIgfHwgIWFwaVJlc3VsdC5kYXRhKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKAogICAgICAgICAgYEFQSSBkaWQgbm90IHJldHVybiBleHBlY3RlZCB0ZXh0IGNvbnRlbnQuIFR5cGU6ICR7YXBpUmVzdWx0LnR5cGV9LCBGaW5pc2hSZWFzb246ICR7YXBpUmVzdWx0LmZpbmlzaFJlYXNvbn1gCiAgICAgICAgKTsKICAgICAgfQoKICAgICAgcHJvZ3Jlc3NDYWxsYmFjaygic3RhdHVzIiwgewogICAgICAgIG1lc3NhZ2U6ICJQYXJzaW5nIExMTSByZXNwb25zZS4uLiIsCiAgICAgICAgYWN0aXZlOiB0cnVlLAogICAgICB9KTsKICAgICAgY29uc3QgcmF3SnNvblJlc3BvbnNlID0gYXBpUmVzdWx0LmRhdGE7CiAgICAgIGNvbnN0IHNhbml0aXplZEpzb24gPSBBcGlDbGllbnQuc2FuaXRpemVMbG1Kc29uUmVzcG9uc2UocmF3SnNvblJlc3BvbnNlKTsKCiAgICAgIGlmICghc2FuaXRpemVkSnNvbikgewogICAgICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgICAgICJlcnJvciIsCiAgICAgICAgICAiRmFpbGVkIHRvIHNhbml0aXplIG9yIGV4dHJhY3QgdmFsaWQgSlNPTiBmcm9tIExMTSByZXNwb25zZS4iLAogICAgICAgICAgeyByYXdSZXNwb25zZTogcmF3SnNvblJlc3BvbnNlIH0KICAgICAgICApOwogICAgICAgIHRocm93IG5ldyBFcnJvcigKICAgICAgICAgICJMTE0gcmVzcG9uc2UgZGlkIG5vdCBjb250YWluIHZhbGlkIEpTT04gYWZ0ZXIgc2FuaXRpemF0aW9uLiIKICAgICAgICApOwogICAgICB9CgogICAgICBjb25zdCBwYXJzZWRSZXNwb25zZSA9IEpTT04ucGFyc2Uoc2FuaXRpemVkSnNvbik7CgogICAgICBpZiAoCiAgICAgICAgIXBhcnNlZFJlc3BvbnNlLm1jcERlZmluaXRpb24gfHwKICAgICAgICB0eXBlb2YgcGFyc2VkUmVzcG9uc2UubWNwRGVmaW5pdGlvbiAhPT0gIm9iamVjdCIgfHwKICAgICAgICAhcGFyc2VkUmVzcG9uc2UubWNwRGVmaW5pdGlvbi5uYW1lCiAgICAgICkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigKICAgICAgICAgICJMTE0gcmVzcG9uc2UgSlNPTiBpcyBtaXNzaW5nIGEgdmFsaWQgJ21jcERlZmluaXRpb24nIG9iamVjdCB3aXRoIGEgJ25hbWUnLiIKICAgICAgICApOwogICAgICB9CiAgICAgIGlmICgKICAgICAgICAhcGFyc2VkUmVzcG9uc2UuanNJbXBsZW1lbnRhdGlvbiB8fAogICAgICAgIHR5cGVvZiBwYXJzZWRSZXNwb25zZS5qc0ltcGxlbWVudGF0aW9uICE9PSAic3RyaW5nIgogICAgICApIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoCiAgICAgICAgICAiTExNIHJlc3BvbnNlIEpTT04gaXMgbWlzc2luZyBhIHZhbGlkICdqc0ltcGxlbWVudGF0aW9uJyBzdHJpbmcuIgogICAgICAgICk7CiAgICAgIH0KCiAgICAgIGNvbnN0IG1jcERlZiA9IHBhcnNlZFJlc3BvbnNlLm1jcERlZmluaXRpb247CiAgICAgIGNvbnN0IGpzSW1wbCA9IHBhcnNlZFJlc3BvbnNlLmpzSW1wbGVtZW50YXRpb247CiAgICAgIGNvbnN0IHRvb2xJZCA9IGAke21jcERlZi5uYW1lfS0ke1V0aWxzLmdlbmVyYXRlVVVJRCgpLnN1YnN0cmluZygwLCA4KX1gOwoKICAgICAgbG9nZ2VyLmxvZ0V2ZW50KAogICAgICAgICJpbmZvIiwKICAgICAgICBgU3VjY2Vzc2Z1bGx5IGdlbmVyYXRlZCB0b29sIGRlZmluaXRpb24gYW5kIGltcGxlbWVudGF0aW9uIGZvcjogJHttY3BEZWYubmFtZX0gKElEOiAke3Rvb2xJZH0pYAogICAgICApOwogICAgICBwcm9ncmVzc0NhbGxiYWNrKCJzdGF0dXMiLCB7CiAgICAgICAgbWVzc2FnZTogYEdlbmVyYXRlZCAke21jcERlZi5uYW1lfS4gU2F2aW5nLi4uYCwKICAgICAgICBhY3RpdmU6IHRydWUsCiAgICAgIH0pOwoKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBtY3BKc29uU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkobWNwRGVmLCBudWxsLCAyKTsKICAgICAgICBzdG9yYWdlLnNldEFydGlmYWN0Q29udGVudCh0b29sSWQsICJtY3AuanNvbiIsIG1jcEpzb25TdHJpbmcpOwogICAgICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgICAgICJkZWJ1ZyIsCiAgICAgICAgICBgU2F2ZWQgTUNQIGRlZmluaXRpb24gYXJ0aWZhY3Q6ICR7c3RvcmFnZS5nZXRBcnRpZmFjdEtleSgKICAgICAgICAgICAgdG9vbElkLAogICAgICAgICAgICAibWNwLmpzb24iCiAgICAgICAgICApfWAKICAgICAgICApOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgbG9nZ2VyLmxvZ0V2ZW50KAogICAgICAgICAgImVycm9yIiwKICAgICAgICAgIGBGYWlsZWQgdG8gc2F2ZSBNQ1AgZGVmaW5pdGlvbiBhcnRpZmFjdCBmb3IgJHt0b29sSWR9YCwKICAgICAgICAgIGUKICAgICAgICApOwoKICAgICAgICBTdGF0ZU1hbmFnZXIuaW5jcmVtZW50RXJyb3JDb3VudCgpOwogICAgICAgIFN0YXRlTWFuYWdlci5zZXRMYXN0RXJyb3IoYEZhaWxlZCB0byBzYXZlIE1DUCBhcnRpZmFjdDogJHtlLm1lc3NhZ2V9YCk7CiAgICAgIH0KCiAgICAgIHRyeSB7CiAgICAgICAgc3RvcmFnZS5zZXRBcnRpZmFjdENvbnRlbnQodG9vbElkLCAiaW1wbC5qcyIsIGpzSW1wbCk7CiAgICAgICAgbG9nZ2VyLmxvZ0V2ZW50KAogICAgICAgICAgImRlYnVnIiwKICAgICAgICAgIGBTYXZlZCBKUyBpbXBsZW1lbnRhdGlvbiBhcnRpZmFjdDogJHtzdG9yYWdlLmdldEFydGlmYWN0S2V5KAogICAgICAgICAgICB0b29sSWQsCiAgICAgICAgICAgICJpbXBsLmpzIgogICAgICAgICAgKX1gCiAgICAgICAgKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgICAgICJlcnJvciIsCiAgICAgICAgICBgRmFpbGVkIHRvIHNhdmUgSlMgaW1wbGVtZW50YXRpb24gYXJ0aWZhY3QgZm9yICR7dG9vbElkfWAsCiAgICAgICAgICBlCiAgICAgICAgKTsKCiAgICAgICAgU3RhdGVNYW5hZ2VyLmluY3JlbWVudEVycm9yQ291bnQoKTsKICAgICAgICBTdGF0ZU1hbmFnZXIuc2V0TGFzdEVycm9yKGBGYWlsZWQgdG8gc2F2ZSBKUyBhcnRpZmFjdDogJHtlLm1lc3NhZ2V9YCk7CiAgICAgIH0KCiAgICAgIFN0YXRlTWFuYWdlci5hZGRUb29sKHRvb2xJZCwgbWNwRGVmLCBqc0ltcGwsIHsKICAgICAgICBzb3VyY2VSZXF1ZXN0OiB0b29sUmVxdWVzdCwKICAgICAgfSk7CgogICAgICBnZW5lcmF0ZWRUb29sRGF0YSA9IFN0YXRlTWFuYWdlci5nZXRUb29sKHRvb2xJZCk7CgogICAgICBwcm9ncmVzc0NhbGxiYWNrKCJzdGF0dXMiLCB7CiAgICAgICAgbWVzc2FnZTogIlRvb2wgZ2VuZXJhdGlvbiBjb21wbGV0ZS4iLAogICAgICAgIGFjdGl2ZTogZmFsc2UsCiAgICAgIH0pOwogICAgICBwcm9ncmVzc0NhbGxiYWNrKCJzdWNjZXNzIiwgeyB0b29sOiBnZW5lcmF0ZWRUb29sRGF0YSB9KTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIGxvZ2dlci5sb2dFdmVudCgiZXJyb3IiLCAiVG9vbCBnZW5lcmF0aW9uIGN5Y2xlIGZhaWxlZC4iLCBlcnJvcik7CiAgICAgIFN0YXRlTWFuYWdlci5pbmNyZW1lbnRFcnJvckNvdW50KCk7CiAgICAgIFN0YXRlTWFuYWdlci5zZXRMYXN0RXJyb3IoZXJyb3IubWVzc2FnZSk7CiAgICAgIHByb2dyZXNzQ2FsbGJhY2soInN0YXR1cyIsIHsKICAgICAgICBtZXNzYWdlOiBgRXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gLAogICAgICAgIGFjdGl2ZTogZmFsc2UsCiAgICAgICAgaXNFcnJvcjogdHJ1ZSwKICAgICAgfSk7CiAgICAgIHByb2dyZXNzQ2FsbGJhY2soImVycm9yIiwgeyBtZXNzYWdlOiBlcnJvci5tZXNzYWdlIH0pOwogICAgICBnZW5lcmF0ZWRUb29sRGF0YSA9IG51bGw7CiAgICB9IGZpbmFsbHkgewogICAgICBfaXNSdW5uaW5nID0gZmFsc2U7CgogICAgICBwcm9ncmVzc0NhbGxiYWNrKCJmaW5hbCIsIHt9KTsKICAgIH0KICAgIHJldHVybiBnZW5lcmF0ZWRUb29sRGF0YTsKICB9OwoKICBjb25zdCBhYm9ydEdlbmVyYXRpb24gPSAoKSA9PiB7CiAgICBpZiAoX2lzUnVubmluZykgewogICAgICBsb2dnZXIubG9nRXZlbnQoImluZm8iLCAiQXR0ZW1wdGluZyB0byBhYm9ydCB0b29sIGdlbmVyYXRpb24uIik7CiAgICAgIEFwaUNsaWVudC5hYm9ydEN1cnJlbnRDYWxsKCJVc2VyIGFib3J0IHJlcXVlc3QiKTsKICAgICAgX2lzUnVubmluZyA9IGZhbHNlOwogICAgfSBlbHNlIHsKICAgICAgbG9nZ2VyLmxvZ0V2ZW50KCJpbmZvIiwgIkFib3J0IHJlcXVlc3QgaWdub3JlZDogTm8gZ2VuZXJhdGlvbiBydW5uaW5nLiIpOwogICAgfQogIH07CgogIHJldHVybiB7CiAgICBpbml0LAogICAgaXNSdW5uaW5nLAogICAgZ2VuZXJhdGVUb29sLAogICAgYWJvcnRHZW5lcmF0aW9uLAogIH07Cn07CgpleHBvcnQgZGVmYXVsdCBDeWNsZUxvZ2ljTW9kdWxlOwo=
--- CATS_END_FILE ---

--- CATS_START_FILE: storage.js ---
Y29uc3QgU3RvcmFnZU1vZHVsZSA9IChjb25maWcsIGxvZ2dlcikgPT4gewogIGlmICghY29uZmlnIHx8ICFsb2dnZXIpIHsKICAgIGNvbnNvbGUuZXJyb3IoIlN0b3JhZ2VNb2R1bGUgcmVxdWlyZXMgY29uZmlnIGFuZCBsb2dnZXIuIik7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGNvbnN0IExTX1BSRUZJWCA9IGNvbmZpZy5zdG9yYWdlUHJlZml4OwogIGNvbnN0IFNUQVRFX0tFWV9CQVNFID0gY29uZmlnLnN0YXRlS2V5QmFzZTsKICBjb25zdCBTRVNTSU9OX0tFWV9CQVNFID0gY29uZmlnLnNlc3Npb25LZXlCYXNlOwogIGNvbnN0IE1BWF9BUlRJRkFDVF9TSVpFX0JZVEVTID0gY29uZmlnLm1heEFydGlmYWN0U2l6ZUJ5dGVzOwogIGNvbnN0IFZFUlNJT05fTUFKT1IgPSBTdHJpbmcoY29uZmlnLnZlcnNpb24pLnNwbGl0KCIuIilbMF07CiAgY29uc3Qgc3RhdGVLZXkgPSBTVEFURV9LRVlfQkFTRSArIFZFUlNJT05fTUFKT1I7CiAgY29uc3Qgc2Vzc2lvblN0YXRlS2V5ID0gU0VTU0lPTl9LRVlfQkFTRSArIFZFUlNJT05fTUFKT1I7CiAgY29uc3QgUVVPVEFfQllURVMgPSBjb25maWcuc3RvcmFnZVF1b3RhQnl0ZXM7CiAgY29uc3QgUVVPVEFfV0FSTl9USFJFU0hPTEQgPSBjb25maWcuc3RvcmFnZVF1b3RhV2FyblRocmVzaG9sZDsKCiAgY29uc3QgZ2V0U3RvcmFnZVVzYWdlID0gKCkgPT4gewogICAgbGV0IHRvdGFsQnl0ZXMgPSAwOwogICAgdHJ5IHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsb2NhbFN0b3JhZ2UubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBrZXkgPSBsb2NhbFN0b3JhZ2Uua2V5KGkpOwogICAgICAgIGlmIChrZXkgJiYgKGtleS5zdGFydHNXaXRoKExTX1BSRUZJWCkgfHwga2V5ID09PSBzdGF0ZUtleSkpIHsKICAgICAgICAgIGNvbnN0IHZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KTsKICAgICAgICAgIHRvdGFsQnl0ZXMgKz0gKHZhbHVlPy5sZW5ndGggPz8gMCkgKiAyOwogICAgICAgIH0KICAgICAgfQogICAgICBjb25zdCBwZXJjZW50ID0gUVVPVEFfQllURVMgPiAwID8gKHRvdGFsQnl0ZXMgLyBRVU9UQV9CWVRFUykgKiAxMDAgOiAwOwogICAgICByZXR1cm4geyB1c2VkOiB0b3RhbEJ5dGVzLCBxdW90YTogUVVPVEFfQllURVMsIHBlcmNlbnQ6IHBlcmNlbnQgfTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgbG9nZ2VyLmxvZ0V2ZW50KCJlcnJvciIsICJGYWlsZWQgdG8gY2FsY3VsYXRlIHN0b3JhZ2UgdXNhZ2UiLCBlKTsKICAgICAgcmV0dXJuIHsgdXNlZDogLTEsIHF1b3RhOiBRVU9UQV9CWVRFUywgcGVyY2VudDogLTEgfTsKICAgIH0KICB9OwoKICBjb25zdCBjaGVja1F1b3RhQW5kTG9nID0gKGtleSwgdmFsdWUpID0+IHsKICAgIGNvbnN0IHVzYWdlID0gZ2V0U3RvcmFnZVVzYWdlKCk7CiAgICBjb25zdCBlc3RpbWF0ZWROZXdTaXplID0gKHZhbHVlPy5sZW5ndGggPz8gMCkgKiAyOwogICAgY29uc3QgY3VycmVudEl0ZW1TaXplID0gKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSk/Lmxlbmd0aCA/PyAwKSAqIDI7CiAgICBjb25zdCBlc3RpbWF0ZWRVc2FnZUFmdGVyID0gdXNhZ2UudXNlZCAtIGN1cnJlbnRJdGVtU2l6ZSArIGVzdGltYXRlZE5ld1NpemU7CgogICAgaWYgKAogICAgICB1c2FnZS51c2VkID49IDAgJiYKICAgICAgZXN0aW1hdGVkVXNhZ2VBZnRlciAvIFFVT1RBX0JZVEVTID4gUVVPVEFfV0FSTl9USFJFU0hPTEQKICAgICkgewogICAgICBsb2dnZXIubG9nRXZlbnQoCiAgICAgICAgIndhcm4iLAogICAgICAgIGBMb2NhbFN0b3JhZ2UgdXNhZ2UgaGlnaCAoJHsoCiAgICAgICAgICAoZXN0aW1hdGVkVXNhZ2VBZnRlciAvIFFVT1RBX0JZVEVTKSAqCiAgICAgICAgICAxMDAKICAgICAgICApLnRvRml4ZWQoMSl9JSkgYWZ0ZXIgc2V0dGluZyBrZXk6ICR7a2V5fWAKICAgICAgKTsKICAgIH0KICAgIGlmICh1c2FnZS51c2VkID49IDAgJiYgZXN0aW1hdGVkVXNhZ2VBZnRlciA+IFFVT1RBX0JZVEVTKSB7CiAgICAgIGNvbnN0IGVycm9yTXNnID0gYEVzdGltYXRlZCB1c2FnZSAkeygKICAgICAgICAoZXN0aW1hdGVkVXNhZ2VBZnRlciAvIFFVT1RBX0JZVEVTKSAqCiAgICAgICAgMTAwCiAgICAgICkudG9GaXhlZCgxKX0lIGV4Y2VlZHMgcXVvdGEuYDsKICAgICAgbG9nZ2VyLmxvZ0V2ZW50KAogICAgICAgICJlcnJvciIsCiAgICAgICAgYExvY2FsU3RvcmFnZSBRdW90YSBFeGNlZWRlZCBlc3RpbWF0aW9uIGZvciBrZXk6ICR7a2V5fWAsCiAgICAgICAgZXJyb3JNc2cKICAgICAgKTsKCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHJldHVybiB0cnVlOwogIH07CgogIGNvbnN0IF9nZXQgPSAoa2V5KSA9PiB7CiAgICB0cnkgewogICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgbG9nZ2VyLmxvZ0V2ZW50KCJlcnJvciIsIGBMb2NhbFN0b3JhZ2UgR0VUIEVycm9yOiAke2tleX1gLCBlKTsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfTsKCiAgY29uc3QgX3NldCA9IChrZXksIHZhbHVlKSA9PiB7CiAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAic3RyaW5nIikgewogICAgICBsb2dnZXIubG9nRXZlbnQoCiAgICAgICAgImVycm9yIiwKICAgICAgICBgQXR0ZW1wdGVkIHRvIHN0b3JlIG5vbi1zdHJpbmcgdmFsdWUgZm9yIGtleTogJHtrZXl9YCwKICAgICAgICB7IHR5cGU6IHR5cGVvZiB2YWx1ZSB9CiAgICAgICk7CiAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCB2YWx1ZSB0eXBlIGZvciBsb2NhbFN0b3JhZ2U6ICR7dHlwZW9mIHZhbHVlfWApOwogICAgfQogICAgaWYgKHZhbHVlLmxlbmd0aCAqIDIgPiBNQVhfQVJUSUZBQ1RfU0laRV9CWVRFUykgewogICAgICBjb25zdCBtc2cgPSBgVmFsdWUgZXhjZWVkcyBzaXplIGxpbWl0ICgkewogICAgICAgIHZhbHVlLmxlbmd0aCAqIDIKICAgICAgfSA+ICR7TUFYX0FSVElGQUNUX1NJWkVfQllURVN9IGJ5dGVzKSBmb3Iga2V5OiAke2tleX1gOwogICAgICBsb2dnZXIubG9nRXZlbnQoImVycm9yIiwgbXNnKTsKICAgICAgdGhyb3cgbmV3IEVycm9yKG1zZyk7CiAgICB9CgogICAgY2hlY2tRdW90YUFuZExvZyhrZXksIHZhbHVlKTsKCiAgICB0cnkgewogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIHZhbHVlKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSBgTG9jYWxTdG9yYWdlIFNFVCBFcnJvcjogJHtrZXl9YDsKICAgICAgaWYgKAogICAgICAgIGUubmFtZSA9PT0gIlF1b3RhRXhjZWVkZWRFcnJvciIgfHwKICAgICAgICAoZS5jb2RlICYmIChlLmNvZGUgPT09IDIyIHx8IGUuY29kZSA9PT0gMTAxNCkpCiAgICAgICkgewogICAgICAgIGNvbnN0IHVzYWdlID0gZ2V0U3RvcmFnZVVzYWdlKCk7CiAgICAgICAgZXJyb3JNZXNzYWdlID0gYExvY2FsU3RvcmFnZSBRdW90YSBFeGNlZWRlZCBmb3Iga2V5OiAke2tleX0uIFVzYWdlOiAkeygKICAgICAgICAgIHVzYWdlLnVzZWQgLwogICAgICAgICAgMTAyNCAvCiAgICAgICAgICAxMDI0CiAgICAgICAgKS50b0ZpeGVkKDIpfU1CIC8gJHsoUVVPVEFfQllURVMgLyAxMDI0IC8gMTAyNCkudG9GaXhlZCgyKX1NQi5gOwogICAgICAgIGxvZ2dlci5sb2dFdmVudCgiZXJyb3IiLCBlcnJvck1lc3NhZ2UsIGUpOwogICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpOwogICAgICB9IGVsc2UgewogICAgICAgIGxvZ2dlci5sb2dFdmVudCgiZXJyb3IiLCBlcnJvck1lc3NhZ2UsIGUpOwogICAgICAgIHRocm93IGU7CiAgICAgIH0KICAgIH0KICB9OwoKICBjb25zdCBfcmVtb3ZlID0gKGtleSkgPT4gewogICAgdHJ5IHsKICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIGxvZ2dlci5sb2dFdmVudCgiZXJyb3IiLCBgTG9jYWxTdG9yYWdlIFJFTU9WRSBFcnJvcjogJHtrZXl9YCwgZSk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9OwoKICBjb25zdCBnZXRBcnRpZmFjdEtleSA9IChhcnRpZmFjdElkLCB2ZXJzaW9uID0gImxhdGVzdCIpID0+IHsKICAgIGlmICgKICAgICAgIWFydGlmYWN0SWQgfHwKICAgICAgdHlwZW9mIGFydGlmYWN0SWQgIT09ICJzdHJpbmciIHx8CiAgICAgIHR5cGVvZiB2ZXJzaW9uICE9PSAic3RyaW5nIgogICAgKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigKICAgICAgICBgSW52YWxpZCBhcmd1bWVudHMgZm9yIGdldEFydGlmYWN0S2V5OiBJRD0ke2FydGlmYWN0SWR9LCBWZXJzaW9uPSR7dmVyc2lvbn1gCiAgICAgICk7CiAgICB9CiAgICByZXR1cm4gYCR7TFNfUFJFRklYfWFydGlmYWN0OiR7YXJ0aWZhY3RJZH06JHt2ZXJzaW9ufWA7CiAgfTsKCiAgY29uc3QgZ2V0QXJ0aWZhY3RDb250ZW50ID0gKGFydGlmYWN0SWQsIHZlcnNpb24gPSAibGF0ZXN0IikgPT4gewogICAgcmV0dXJuIF9nZXQoZ2V0QXJ0aWZhY3RLZXkoYXJ0aWZhY3RJZCwgdmVyc2lvbikpOwogIH07CgogIGNvbnN0IHNldEFydGlmYWN0Q29udGVudCA9IChhcnRpZmFjdElkLCB2ZXJzaW9uID0gImxhdGVzdCIsIGNvbnRlbnQpID0+IHsKICAgIHJldHVybiBfc2V0KGdldEFydGlmYWN0S2V5KGFydGlmYWN0SWQsIHZlcnNpb24pLCBjb250ZW50KTsKICB9OwoKICBjb25zdCBkZWxldGVBcnRpZmFjdCA9IChhcnRpZmFjdElkLCB2ZXJzaW9uID0gImxhdGVzdCIpID0+IHsKICAgIHJldHVybiBfcmVtb3ZlKGdldEFydGlmYWN0S2V5KGFydGlmYWN0SWQsIHZlcnNpb24pKTsKICB9OwoKICBjb25zdCBsaXN0QXJ0aWZhY3RzID0gKCkgPT4gewogICAgY29uc3QgYXJ0aWZhY3RzID0gW107CiAgICBjb25zdCBwcmVmaXggPSBgJHtMU19QUkVGSVh9YXJ0aWZhY3Q6YDsKICAgIHRyeSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbG9jYWxTdG9yYWdlLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3Qga2V5ID0gbG9jYWxTdG9yYWdlLmtleShpKTsKICAgICAgICBpZiAoa2V5Py5zdGFydHNXaXRoKHByZWZpeCkpIHsKICAgICAgICAgIGNvbnN0IHBhcnRzID0ga2V5LnN1YnN0cmluZyhwcmVmaXgubGVuZ3RoKS5zcGxpdCgiOiIpOwogICAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMikgewogICAgICAgICAgICBhcnRpZmFjdHMucHVzaCh7IGlkOiBwYXJ0c1swXSwgdmVyc2lvbjogcGFydHNbMV0sIGtleToga2V5IH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbG9nZ2VyLmxvZ0V2ZW50KCJ3YXJuIiwgYEZvdW5kIG1hbGZvcm1lZCBhcnRpZmFjdCBrZXk6ICR7a2V5fWApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSBjYXRjaCAoZSkgewogICAgICBsb2dnZXIubG9nRXZlbnQoImVycm9yIiwgIkZhaWxlZCB0byBsaXN0IGFydGlmYWN0cyBmcm9tIGxvY2FsU3RvcmFnZSIsIGUpOwogICAgfQogICAgcmV0dXJuIGFydGlmYWN0czsKICB9OwoKICBjb25zdCBnZXRTdGF0ZSA9ICgpID0+IHsKICAgIGNvbnN0IGpzb24gPSBfZ2V0KHN0YXRlS2V5KTsKICAgIGlmICghanNvbikgcmV0dXJuIG51bGw7CiAgICB0cnkgewogICAgICByZXR1cm4gSlNPTi5wYXJzZShqc29uKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgbG9nZ2VyLmxvZ0V2ZW50KAogICAgICAgICJlcnJvciIsCiAgICAgICAgYEZhaWxlZCB0byBwYXJzZSBzdGF0ZSBmcm9tIGxvY2FsU3RvcmFnZTogJHtlLm1lc3NhZ2V9LiBSZW1vdmluZyBpbnZhbGlkIHN0YXRlLmAKICAgICAgKTsKICAgICAgX3JlbW92ZShzdGF0ZUtleSk7CiAgICAgIHJldHVybiBudWxsOwogICAgfQogIH07CgogIGNvbnN0IHNhdmVTdGF0ZSA9IChzdGF0ZU9iaikgPT4gewogICAgaWYgKCFzdGF0ZU9iaiB8fCB0eXBlb2Ygc3RhdGVPYmogIT09ICJvYmplY3QiKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiSW52YWxpZCBzdGF0ZSBvYmplY3QgcHJvdmlkZWQgdG8gc2F2ZVN0YXRlLiIpOwogICAgfQogICAgdHJ5IHsKICAgICAgY29uc3Qgc3RhdGVTdHJpbmcgPSBKU09OLnN0cmluZ2lmeShzdGF0ZU9iaik7CiAgICAgIHJldHVybiBfc2V0KHN0YXRlS2V5LCBzdGF0ZVN0cmluZyk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIGxvZ2dlci5sb2dFdmVudCgiZXJyb3IiLCAiRmFpbGVkIHRvIHNhdmUgc3RhdGUiLCBlKTsKCiAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIHNhdmUgc3RhdGU6ICR7ZS5tZXNzYWdlfWApOwogICAgfQogIH07CgogIGNvbnN0IHJlbW92ZVN0YXRlID0gKCkgPT4gewogICAgcmV0dXJuIF9yZW1vdmUoc3RhdGVLZXkpOwogIH07CgogIGNvbnN0IGdldFNlc3Npb25TdGF0ZSA9ICgpID0+IHsKICAgIHRyeSB7CiAgICAgIGNvbnN0IGpzb24gPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKHNlc3Npb25TdGF0ZUtleSk7CiAgICAgIGlmICghanNvbikgcmV0dXJuIG51bGw7CiAgICAgIHJldHVybiBKU09OLnBhcnNlKGpzb24pOwogICAgfSBjYXRjaCAoZSkgewogICAgICBsb2dnZXIubG9nRXZlbnQoImVycm9yIiwgYEZhaWxlZCB0byBwYXJzZSBzZXNzaW9uIHN0YXRlOiAke2UubWVzc2FnZX1gKTsKICAgICAgdHJ5IHsKICAgICAgICBzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKHNlc3Npb25TdGF0ZUtleSk7CiAgICAgIH0gY2F0Y2ggKHJlbW92ZUVycm9yKSB7CiAgICAgICAgbG9nZ2VyLmxvZ0V2ZW50KAogICAgICAgICAgIndhcm4iLAogICAgICAgICAgIkZhaWxlZCB0byByZW1vdmUgaW52YWxpZCBzZXNzaW9uIHN0YXRlIGl0ZW0uIiwKICAgICAgICAgIHJlbW92ZUVycm9yCiAgICAgICAgKTsKICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9OwoKICBjb25zdCBzYXZlU2Vzc2lvblN0YXRlID0gKHN0YXRlT2JqKSA9PiB7CiAgICBpZiAoIXN0YXRlT2JqIHx8IHR5cGVvZiBzdGF0ZU9iaiAhPT0gIm9iamVjdCIpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHN0YXRlIG9iamVjdCBwcm92aWRlZCB0byBzYXZlU2Vzc2lvblN0YXRlLiIpOwogICAgfQogICAgdHJ5IHsKICAgICAgY29uc3Qgc3RhdGVTdHJpbmcgPSBKU09OLnN0cmluZ2lmeShzdGF0ZU9iaik7CiAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oc2Vzc2lvblN0YXRlS2V5LCBzdGF0ZVN0cmluZyk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSBjYXRjaCAoZSkgewogICAgICBsb2dnZXIubG9nRXZlbnQoImVycm9yIiwgYFNlc3Npb25TdG9yYWdlIFNFVCBFcnJvcmAsIGUpOwogICAgICBpZiAoZS5uYW1lID09PSAiUXVvdGFFeGNlZWRlZEVycm9yIikgewogICAgICAgIHRocm93IG5ldyBFcnJvcihgU2Vzc2lvblN0b3JhZ2UgUXVvdGEgRXhjZWVkZWQuYCk7CiAgICAgIH0KICAgICAgdGhyb3cgZTsKICAgIH0KICB9OwoKICBjb25zdCByZW1vdmVTZXNzaW9uU3RhdGUgPSAoKSA9PiB7CiAgICB0cnkgewogICAgICBzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKHNlc3Npb25TdGF0ZUtleSk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIGxvZ2dlci5sb2dFdmVudCgid2FybiIsIGBTZXNzaW9uU3RvcmFnZSBSRU1PVkUgRXJyb3JgLCBlKTsKICAgIH0KICB9OwoKICBjb25zdCBjbGVhckFsbFJlcGxvaWREYXRhID0gKCkgPT4gewogICAgbG9nZ2VyLmxvZ0V2ZW50KCJ3YXJuIiwgIkluaXRpYXRpbmcgc3RvcmFnZSBjbGVhciBmb3IgUmVwbG9pZCB2MiBkYXRhLiIpOwogICAgbGV0IGtleXNUb1JlbW92ZSA9IFtdOwogICAgbGV0IHJlbW92ZWRDb3VudCA9IDA7CiAgICB0cnkgewogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxvY2FsU3RvcmFnZS5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGtleSA9IGxvY2FsU3RvcmFnZS5rZXkoaSk7CiAgICAgICAgaWYgKGtleSAmJiAoa2V5LnN0YXJ0c1dpdGgoTFNfUFJFRklYKSB8fCBrZXkgPT09IHN0YXRlS2V5KSkgewogICAgICAgICAga2V5c1RvUmVtb3ZlLnB1c2goa2V5KTsKICAgICAgICB9CiAgICAgIH0KICAgICAga2V5c1RvUmVtb3ZlLmZvckVhY2goKGtleSkgPT4gewogICAgICAgIGlmIChfcmVtb3ZlKGtleSkpIHsKICAgICAgICAgIHJlbW92ZWRDb3VudCsrOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIGxvZ2dlci5sb2dFdmVudCgKICAgICAgICAiaW5mbyIsCiAgICAgICAgYFJlbW92ZWQgJHtyZW1vdmVkQ291bnR9IGtleXMgZnJvbSBsb2NhbFN0b3JhZ2UuYAogICAgICApOwoKICAgICAgdHJ5IHsKICAgICAgICBzZXNzaW9uU3RvcmFnZS5jbGVhcigpOwogICAgICAgIGxvZ2dlci5sb2dFdmVudCgiaW5mbyIsICJDbGVhcmVkIFNlc3Npb25TdG9yYWdlLiIpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgbG9nZ2VyLmxvZ0V2ZW50KCJ3YXJuIiwgIkZhaWxlZCB0byBjbGVhciBTZXNzaW9uU3RvcmFnZS4iLCBlKTsKICAgICAgfQogICAgfSBjYXRjaCAoZSkgewogICAgICBsb2dnZXIubG9nRXZlbnQoImVycm9yIiwgYEVycm9yIGR1cmluZyBjbGVhckFsbFJlcGxvaWREYXRhYCwgZSk7CiAgICB9CiAgICByZXR1cm4gcmVtb3ZlZENvdW50OwogIH07CgogIHJldHVybiB7CiAgICBMU19QUkVGSVgsCiAgICBnZXRBcnRpZmFjdEtleSwKICAgIGdldEFydGlmYWN0Q29udGVudCwKICAgIHNldEFydGlmYWN0Q29udGVudCwKICAgIGRlbGV0ZUFydGlmYWN0LAogICAgbGlzdEFydGlmYWN0cywKICAgIGdldFN0YXRlLAogICAgc2F2ZVN0YXRlLAogICAgcmVtb3ZlU3RhdGUsCiAgICBnZXRTZXNzaW9uU3RhdGUsCiAgICBzYXZlU2Vzc2lvblN0YXRlLAogICAgcmVtb3ZlU2Vzc2lvblN0YXRlLAogICAgY2xlYXJBbGxSZXBsb2lkRGF0YSwKICAgIGdldFN0b3JhZ2VVc2FnZSwKICB9Owp9OwoKZXhwb3J0IGRlZmF1bHQgU3RvcmFnZU1vZHVsZTsK
--- CATS_END_FILE ---
